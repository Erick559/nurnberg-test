/**
 * @license SmartBuilder HTML5 widget framework, Copyright (c) 2023
 *          SuddenlySmart;
 * 
 */

/*!
 * jQuery UI Effects 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/**
 * @license SmartBuilder4 HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 */

/*!
     * swiped-events.js - v1.1.9
     * Pure JavaScript swipe events
     * https://github.com/john-doherty/swiped-events
     * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
     * @author John Doherty <www.johndoherty.info>
     * @license MIT
     */

/**
 * @license SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 * SlideSet
 */

/**
 * @license SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 * Slide
 */

/**
 * @license SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 * 
 */

/**
 * jquery.timer.js
 *
 * Copyright (c) 2011 Jason Chavannes <jason.chavannes@gmail.com>
 *
 * http://jchavannes.com/jquery-timer
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/*
 SmartBuilder HTML5 widget framework, Copyright (c) 2023
          SuddenlySmart;

 SmartBuilder4 HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 SlideSet
 SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;
 Slide
 jQuery UI Effects 1.11.2
 http://jqueryui.com

 Copyright 2014 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 http://api.jqueryui.com/category/effects-core/
 jQuery Color Animations v2.1.2
 https://github.com/jquery/jquery-color

 Copyright 2014 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 Date: Wed Jan 16 08:47:09 2013 -0600
 swiped-events.js - v1.1.9
 Pure JavaScript swipe events
 https://github.com/john-doherty/swiped-events
 @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 @author John Doherty <www.johndoherty.info>
 @license MIT
 SmartBuilder HTML5 widget framework, Copyright (c) 2023 SuddenlySmart;

*/
define("sb4core/sbobjfactory",["./DataUtil","jquery","underscore","jqueryui/widget","util/jquery-color"],function(m,u,q){function p(b){this.engine=b}p.prototype.create=function(b,d,f,e){this.div=b;this.data=d;return this._createObj(b,d,f,e)};p.prototype._createObj=function(b,d,f,e){var a=d.eClass;null==a&&(a=e);var c=null;DEBUG&&console.log("_createObj",arguments);null==f||"Frame"==a?c=this._createFrame(b,d,f):"SlideSet"==a?c=this._createSlideSet(b,d,f):"Slide"==a?c=this._createSlide(b,d,f):"Widget"==
a&&(c=this._createWidget(b,d,f));null!=c&&this.engine.objctx.add(d.id,c.data("sb4-"+c.data("sb4type")));return c};p.prototype._createFrame=function(b,d,f){f={_p:null==f?null:f.data("sb4-"+f.data("sb4type"))};this._parseBaseOptions(d,f);this._parseBounds(d.bounds,f);this._parseDataEntries(d.data,f);return this._createSBObj(b,"com.smartbuilder.axon.widget.frame",f)};p.prototype._createSlide=function(b,d,f){f={_p:null==f?null:f.data("sb4-"+f.data("sb4type"))};this._parseBaseOptions(d,f);d.type="com.smartbuilder.axon.widget.slide";
f=this._createSBObj(b,"com.smartbuilder.axon.widget.slide",f);d=d.widgets;for(var e in d){var a=this._createObjDiv(b),c=this._createObj(a,d[e],f,"Widget");this._activateObjDiv(a,void 0!=c)}return f};p.prototype._createSlideSet=function(b,d,f){f={_p:null==f?null:f.data("sb4-"+f.data("sb4type"))};this._parseBaseOptions(d,f);void 0!=d.mode?f.mode=d.mode:(f.mode=m.getInt(d.type,0),d.mode=f.mode);d.type="com.smartbuilder.axon.widget.slideset";f=this._createSBObj(b,"com.smartbuilder.axon.widget.slideset",
f);d=d.slides;for(var e in d){var a=this._createObjDiv(b),c=this._createObj(a,d[e],f,"Slide");this._activateObjDiv(a,void 0!=c)}return f};p.prototype._createWidget=function(b,d,f){f={_p:null==f?null:f.data("sb4-"+f.data("sb4type"))};this._parseBaseOptions(d,f);this._parseBounds(d.bounds,f);var e=d.type;this._parseDataEntries(d.data,f);return this._createSBObj(b,e,f)};p.prototype._createSBObj=function(b,d,f){void 0==f&&(f={});f._engine=this.engine;var e=sb4runtime.getWidgetInfo(d);DEBUG&&console.log("creating SBObj instance",
d,f);if(void 0!=e){d=e.widgetsvc.getShortUIKey();if(""!=f._tags){e=f._tags.split(" ");for(var a in e)u(b).addClass("tag-"+e[a])}delete f._tags;try{u(b).data("sb4type",d);var c=u(b)[d](f)}catch(g){c=null,console.log("engine work process error: "+g.name+" : "+g.message)}}DEBUG&&console.log("created SBObj instance",c);return c};p.prototype._createObjDiv=function(b){return u("\x3cdiv class\x3d'temp'\x3e",{}).appendTo(b)};p.prototype._createObjDivBefore=function(b){return u("\x3cdiv class\x3d'temp'\x3e",
{}).insertBefore(b)};p.prototype._activateObjDiv=function(b,d){d?b.removeClass("temp"):u(b).remove()};p.prototype._parseBounds=function(b,d){null==b&&(b={});d._x=m.getInt(b.x,0);d._y=m.getInt(b.y,0);d._w=m.getInt(b.w,0);d._h=m.getInt(b.h,0)};p.prototype._parseBaseOptions=function(b,d){d._i=m.getDefaultString(b.id,"");d._n=m.getDefaultString(b.name,"");d._z=m.getInt(b.z,0);d._fxi=m.getInt(b.fxi,"");d._fxo=m.getInt(b.fxo,"");d._tags=m.getDefaultString(b.tags,"");m.isFalse(b.v)&&(d._v=!1);d._d=b};p.prototype._parseDataEntries=
function(b,d){if(b&&b.entries){var f=b.entries,e;for(e in f){var a=f[e].id;if("_prf"==a){var c={},g=f[e].subs,l;for(l in g){var n=g[l],w=n.id,y={},h=[],r=n.subs,v;for(v in r){var t=r[v],C=t.id;t=this._parseIData(t);var B={};B[C]=t.subs?t:t[C];h.push(B)}y.subs=h;c[w]=q.extend(y,JSON.parse(n.value))}d[a]=c}else c=this._parseIData(b.entries[e]),d[a]=c.subs?c:c[a]}}};p.prototype._parseIData=function(b){var d={},f=b.id,e=void 0,a=b.eClass;"StrData"==a?e=m.getDefaultString(b.value,""):"BoolData"==a?e=m.isTrue(b.value):
"ColorData"==a?e=null!=b.cid?"#"+b.cid:u.Color(m.getInt(b.R,0),m.getInt(b.G,0),m.getInt(b.B,0),1).toHexString():"NumData"==a?e=m.parseNumber(b.value):"FontData"==a?(e={},void 0!=b["class"]&&(e["class"]=b["class"]),void 0!=b.name&&(e.fontStyle=0==m.getInt(b.style,0)?"normal":"italic",e.fontWeight=0==m.getInt(b.weight,0)?"normal":"bold",e.fontSize=m.getInt(b.size,10),e.fontFamily=b.name)):"SizeData"==a?e=[m.getInt(b.W,0),m.getInt(b.H,0)]:"ResData"==a?e=m.getDefaultString(b.key,""):"GSONData"==a&&(e=
q.string.isBlank(b.value)?{}:JSON.parse(b.value));d[f]=e;b=b.subs;if(void 0!=b){f=[];for(var c in b)f.push(this._parseIData(b[c]));d.subs=f}return d};return p});
define("sb4core/ObjContext",["underscore","sb4core/DataUtil"],function(m,u){function q(p,b){this.extctx=p;this.map={};m.isFunction(b)&&(this.optionalFinder=b)}q.objMap={};q.prototype.getObjMap=function(){return q.objMap};q.prototype.getTopMap=function(p){p=u.parseString(p);if(!m.str.isBlank(p)){m.has(q.objMap,p)||(this.getObjMap()[p]={});var b=this.getObjMap()[p]}return b};q.prototype.fork=function(p){return new q(this,p)};q.prototype.pop=function(p){0<arguments.length&&1==p||(this.map=void 0);return this.extctx};
q.prototype.add=function(p,b){var d=this.map[p]!==b;this.map[p]=b;if(m.isObject(b))this.onVariableChange(p,b);else if(d)this.onVariableChange(p,b)};q.prototype.set=function(p,b){if(m.has(this.map,p)){var d=this.map[p]!==b;this.map[p]=b;if(m.isObject(b))this.onVariableChange(p,b);else if(d)this.onVariableChange(p,b);return!0}if(void 0!=this.extctx)return this.extctx.set(p,b)};q.prototype.get=function(p,b,d){var f=this.map[p];null==d&&(d=[]);1==b||void 0!=f&&null!=f||void 0!=f||void 0==this.extctx||
(f=this.extctx.get(p,!1,d));void 0!=this.optionalFinder&&null==f&&0>m.indexOf(d,this.optionalFinder)&&(d.push(this.optionalFinder),f=this.optionalFinder(p));return f};q.prototype.remove=function(p){var b=this.map[p];void 0!=b&&delete this.map[p];return b};q.prototype.contains=function(p){return m.has(this.map,p)?!0:void 0!=this.extctx?this.extctx.contains(p):!1};q.prototype.onVariableChange=function(p,b){var d=this;if(0==p.indexOf("global ")){var f=p.substring(7);p=this.get("_frame");m.each(p.engine.subEngines,
function(e){var a=e.objctx.get("[var_widget_id_map]");m.has(a,f)&&m.each(a[f],function(c){c=e.objctx.get(c);null!=c&&u.isWgt(c)&&c._firePaintRequest({updateTextByVar:""})})})}else this.contains("^SB4_local_var_prefix_"+p)&&(f=p,p=this.get("[var_widget_id_map]"),m.has(p,f)&&m.each(p[f],function(e){e=d.get(e);null!=e&&u.isWgt(e)&&e._firePaintRequest({updateTextByVar:""})}))};return q});
define("sb4core/ClassUtil",["sb4core/Logger"],function(m){function u(){}u.logger=new m("util",function(){return m.getDefaultPrefix()+" ClassUtil "});u.invoke=function(q,p,b){var d=null;try{_.isArray(b)||(b=[]),u.logger._info([q,p,b]),void 0!=q&&(d=q[p].apply(q,Array.prototype.slice.call(b,0)))}catch(f){u.logger._warn(f)}return d};u.invokeWgtMethod=function(q,p,b){var d=null;try{u.logger._info([q,p,b]),void 0!=q&&(d=q.data("sb4-"+q.data("sb4type"))[p].apply(q.data("sb4-"+q.data("sb4type")),b))}catch(f){u.logger._warn(f)}return d};
u.getJQueryWidgetRef=function(q){var p=null;try{p=q.data("sb4-"+q.data("sb4type"))}catch(b){u.logger._warn(b)}return p};return u});
define("sb4core/SB4ParseCore",["jquery","underscore","sb4core/Logger","sb4core/DataUtil"],function(m,u,q,p){function b(d){this.engine=d;this.disableStopPoint=!1;var f=this;this.logger=new q("parse",function(){return q.getDefaultPrefix()+f.engine.id+" "})}b.WHEN="sb4_when";b.WHEN_CONDITION="sb4_evt";b.EVT_KEY="sb4_evt_k";b.EVT_KEY2="sb4_evt_k2";b.EVTX_KEY="sb4_evtx_k";b.EVTX_KEY2="sb4_evtx_k2";b.PROCEDURES_DEFRETURN="procedures_defreturn";b.EVT_SCENE="sb4_evt_scene";b.EVT_GEST="sb4_evt_gest";b.EVT_G=
"sb4_evt_g";b.VAL="sb4_val";b.WGT="sb4_wgt";b.WGT_GETTER="sb4_wgt_getter";b.WGT_SETTER="sb4_wgt_setter";b.TRIGGER="sb4_trigger";b.CONTROLS_FOREACH="controls_forEach";b.CONTROLS_FORRANGE="controls_forRange";b.CONTROLS_FLOW_STATEMENTS="controls_flow_statements";b.CONTROLS_WHILE="sb4_controls_while";b.LOGIC_OPERATION="logic_operation";b.LEXICAL_VARIABLE_GET="lexical_variable_get";b.LOCAL_DECLARATION_STATEMENT="local_declaration_statement";b.EVT_TIMELINE="sb4_evt_timeline";b.EVT_PATH="sb4_evt_path";b.disableStopPointBlockTypeMap=
{lexical_variable_get:!0,logic_op2:!0,logic_operation:!0,math_compare:!0,sb4_math_arithmetic:!0,sb4_math_arithmetic2:!0,sb4_val:!0,parseWgt:!0,sb4_wgt_getter:!0,sb4_wgt_method:!0,text_compare:!0,text_join:!0,math_single:!0,lists_create_with:!0,lists_is_list:!0,lists_create_empty:!0,lists_serialize:!0,sb4_branch_numlist:!0,lists_is_in:!0,math_on_list:!0,lists_to_csv_row:!0,lists_length:!0,lists_from_csv_row:!0,lists_is_empty:!0,lists_from_csv_table:!0,lists_pick_random_item:!0,lists_lookup_in_pairs:!0,
lists_position_in:!0,lists_select_item:!0,lists_pick:!0,lists_in_list:!0,lists_copy:!0,lists_random:!0,lists_compare_items:!0,conf_reset:!0,conf_change:!0,sb4_map_get:!0,sb4_map_keys:!0,sb4_map_exist:!0,sb4_map_vals:!0,sb4_map_empty:!0,sb4_map_is:!0,sb4_map_c:!0,sb4_map_froml:!0,sb4_query_map:!0,sb4_map_has:!0,sb4_map_ref:!0,sb4_map_serialize:!0};b.parserMap={lexical_variable_get:"parseLexicalVariableGet",lists_add_items:"parseListsAddItems",lists_append_list:"parseListsAppendList",lists_compare_items:"parseListsCompareItems",
lists_copy:"parseListsCopy",lists_create_empty:"parseListsCreateEmpty",lists_create_with:"parseListsCreateWith",lists_from_csv_row:"parseListsFromCsvRow",lists_from_csv_table:"parseListsFromCsvTable",lists_in_list:"parseListsInList",lists_insert_item:"parseListsInsertItem",lists_is_empty:"parseListsIsEmpty",lists_is_in:"parseListsIsIn",lists_is_list:"parseListsIsList",lists_length:"parseListsLength",lists_lookup_in_pairs:"parseListsLookupInPairs",lists_pick_random_item:"parseListsPickRandomItem",
lists_position_in:"parseListsPositionIn",lists_random:"parseListRandom",lists_remove_item:"parseListsRemoveItem",lists_remove_item2:"parseListsRemoveItem2",lists_remove_list:"parseListsRemoveList",lists_replace_item:"parseListsReplaceItem",lists_select_item:"parseListsSelectItem",lists_to_csv_row:"parseListsToCsvRow",lists_to_csv_table:"parseListsToCsvRow",lists_sortm:"parseListsSortm",lists_sort:"parseListsSort",lists_pick:"parsePick",lists_serialize:"parseListsSerialize",lists_deserialize:"parseListsDeserialize",
local_declaration_statement:"parseLocalDeclarationStatement",logic_negate:"parseLogicNegate",logic_op2:"parseLogicOp2",logic_operation:"parseLogicOperation",math_atan2:"parseMathAtan2",math_compare:"parseMathCompare",math_divide:"parseMathDivide",math_on_list:"parseMathOnList",math_random_float:"parseMathRandomFloat",math_random_int:"parseMathRandomInt",math_single:"parseMathSingle",math_trig:"parseMathTrig",modify_value:"parseModifyValue",sb4_ajax:"parseAjax",sb4_ajax_sync:"parseAjaxSync",sb4_branch_byname:"parseBranchByName",
sb4_branch_byname2:"parseBranchByName2",sb4_branch_names:"parseBranchNames",sb4_branch_numlist:"parseBranchNumList",sb4_breakpoint:"parseBreakPoint",sb4_build_query:"parseBuildQuery",sb4_close_lesson:"parseCloseLesson",sb4_color_make:"parseColorMake",sb4_color_split:"parseColorSplit",sb4_controls_if:"parseIf",sb4_exit:"parseExit",sb4_fire:"parseFire",sb4_focus:"parseFocus",sb4_func:"parseFunc",sb4_func2:"parseFunc",sb4_callproc:"parseCallProc",sb4_callproc2:"parseCallProc",sb4_goto_branch:"parseGotoBranch",
sb4_goto_page:"parseGotoPage",sb4_map_clear:"parseMapClear",sb4_map_deserialize:"parseMapDeserialize",sb4_map_empty:"parseMapEmpty",sb4_map_exist:"parseMapExist",sb4_map_froml:"parseMapFroml",sb4_map_get:"parseMapGet",sb4_map_has:"parsesMapHas",sb4_map_is:"parseMapIs",sb4_map_keys:"parseMapKeys",sb4_map_vals:"parseMapVals",sb4_map_map2var:"parseMapMap2Var",sb4_map_ref:"parseMapRef",sb4_map_remove:"parseMapRemove",sb4_map_serialize:"parseMapSerialize",sb4_map_set:"parseMapSet",sb4_map_var2map:"parsesMapVar2Map",
sb4_map_c:"parseMapC",sb4_map_m:"parseMapM",sb4_math_arithmetic:"parseMathArithmetic",sb4_math_arithmetic2:"parseMathArithmetic2",sb4_move_countdrag:"parseMoveCountDrag",sb4_move_finddrag:"parseMoveFindDrag",sb4_move_findzone:"parseMoveFindZone",sb4_move_inzone:"parseMoveInZone",sb4_move_isdragdrop:"parseMoveIsDragDrop",sb4_move_layout:"parseMoveLayout",sb4_move_path:"parseMovePath",sb4_move_relative:"parseMoveRelative",sb4_move_reset:"parseMoveReset",sb4_move_setdrop:"parseMoveSetDrop",sb4_move_setmdrag:"parseMoveSetMDrag",
sb4_move_udlr:"parseMove",sb4_page_bynum:"parsePageByNum",sb4_pagename_bynum:"parsePageNameByNum",sb4_pagenum:"parsePageNum",sb4_print:"parsePrint",sb4_query_map:"parseQueryMap",sb4_reload_scene:"parseReloadScene",sb4_scene_count:"parseSceneCount",sb4_scene_name:"parseSceneName",sb4_show:"parseShowWithEffect",sb4_show_ind:"parseShowInd",sb4_showex:"parseShowWithEffect",sb4_showfx:"parseShowfx",sb4_tag:"parseTag",sb4_tagx:"parseTagx",sb4_timeline:"parseTimeLine",sb4_timeline_goto:"parseTimeLineGoto",
sb4_trigger:"parseTrigger",sb4_val:"parseVal",sb4_volume:"parseVolume",sb4_wait:"parseWait",sb4_msg:"parseMsg",sb4_wgt:"parseWgt",sb4_wgt_getter:"parseWgtGetter",sb4_wgt_getter_a:"parseWgtGetterA",sb4_wgt_method:"parseWgtMethod",sb4_wgt_method_a:"parseWgtMethodA",sb4_wgt_setter:"parseWgtSetter",sb4_wgt_setter_a:"parseWgtSetterA",sb4_xapi_stg:"parseGetXApiSts",sb4_xapi_stmt1:"parseXapiStmt1",sb4_xapi_stmt2:"parseXapiStmt2",sb4_xapi_stmt3:"parseXapiStmt3",sb4_xapi_stmt4:"parseXapiStmt4",sb4_xapi_stmtb:"parseXapiStmtb",
sb4_xapi_stmtc:"parseXapiStmtc",sb4_xapi_stmtco:"parseXapiStmtco",sb4_xapi_stmtg:"parseGetXApiStmt",sb4_xapi_stmtl:"parseXapiStmtl",sb4_xapi_stmtn:"parseXapiStmtn",sb4_xapi_stmto:"parseXapiStmto",sb4_xapi_stmtpa:"parseXapiStmtpa",sb4_xapi_stmts:"parseSetXApiStmt",sb4_xapi_stmtsc:"parseXapiStmtsc",sb4_xapi_sts:"parseSetXApiSts",sb4_xapi_stm:"parseSetXApiStm",sb4_xapi_wstmts:"parseXApiWstmts",sb4_xapi_spf:"parseXApiSpf",sb4_xapi_gpf:"parseXApiGpf",sb4_xapi_mpf:"parseXApiMpf",sb4_xapi_apfr:"parseXApiApfr",
sb4_xapi_gpfr:"parseXApiGpfr",text_changeCase:"parseTextChangeCase",text_compare:"parseTextCompare",text_contains:"parseTextContains",text_isEmpty:"parseTextIsEmpty",text_join:"parseTextJoin",text_length:"parseTextLength",text_replace_all:"parseTextReplaceAll",text_segment:"parseTextSegment",text_split:"parseTextSplit",text_split_at_spaces:"parseTextSplitAtSpaces",text_trim:"parseTextTrim"};b.prototype.parse=function(d){d=m.parseXML(d);d=m(d);var f=d.find("block").filter(function(){if(m(this).attr("type")==
b.WHEN)return this}),e=d.find("xml").first().attr("id");this.parseWhen(f,e);f=d.find("block").filter(function(){if(m(this).attr("type")==b.PROCEDURES_DEFRETURN)return this});this.parseProceduresDefReturn(f);d=d.find("block").filter(function(){if(m(this).attr("type")==b.LOCAL_DECLARATION_STATEMENT)return this});this.addLocalVarToEngineContext(d)};b.prototype.SIMPLE_EVTMAP={};b.prototype.SIMPLE_EVTMAP[b.EVT_SCENE]=!0;b.prototype.SIMPLE_EVTMAP[b.EVT_GEST]=!0;b.prototype.SIMPLE_EVTMAP[b.WHEN_CONDITION]=
!0;b.prototype.SIMPLE_EVTMAP[b.EVT_KEY]=!0;b.prototype.SIMPLE_EVTMAP[b.EVT_KEY2]=!0;b.prototype.parseWhen=function(d,f){var e=this;m.each(d,function(a,c){e.logger._debug("parseWhen .... ");var g={};if("true"!=m(c).attr("disabled")){m(c).find("block").filter(function(){return b.prototype.SIMPLE_EVTMAP[m(this).attr("type")]&&"true"!=m(this).attr("disabled")}).each(function(){var n=m(this).find("mutation");if(m(this).attr("type")==b.EVT_KEY2){if(void 0!=n){var w=m(this).find("field").html();""==w&&(w=
"[any]");w=n.attr("oid")+"."+w;g[w]=!0}"key_d"==n.attr("oid")?SB4API.KEY_DOWN_YES=!0:"key_u"==n.attr("oid")&&(SB4API.KEY_UP_YES=!0)}else void 0!=n&&(w=n.attr("oid")+"."+n.attr("v"),g[w]=!0),m(this).attr("type")==b.EVT_KEY&&("key_d"==n.attr("oid")?SB4API.KEY_DOWN_YES=!0:"key_u"==n.attr("oid")&&(SB4API.KEY_UP_YES=!0))});m(c).find("block").filter(function(){if(m(this).attr("type")==b.EVT_PATH&&"true"!=m(this).attr("disabled"))return this}).each(function(){var n=m(this).find("mutation").attr("pid"),w=
p.parseNumber(m(this).find("field ").html());0>=w&&(w=-1);n=m(this).find("mutation").attr("oid")+"."+n+"_"+w;g[n]=!0});m(c).find("block").filter(function(){if(m(this).attr("type")==b.EVT_TIMELINE&&"true"!=m(this).attr("disabled"))return this}).each(function(){var n=m(this).find("field").text();"end"==n?n="timeline.end":(n=p.parseNumber(n),0>=n&&(n=-1),n="timeline."+n);g[n]=!0});m(c).find("block").filter(function(){if(m(this).attr("type")==b.EVT_G&&"true"!=m(this).attr("disabled"))return this}).each(function(){var n=
"flow.evt://"+m(this).find("field").html();g[n]=!0});var l=m(this).find("statement").first();m(c).find("block").filter(function(){if(0==m(this).attr("type").indexOf("sb4_evtx")&&"true"!=m(this).attr("disabled"))return this}).each(function(){if("sb4_evtx_a"==m(this).attr("type"))var n=m(this).find("mutation").attr("oid")+"."+m(this).find("mutation").attr("t")+"."+m(this).find("mutation").attr("v")+"."+m(this).attr("type");else if(m(this).attr("type")==b.EVTX_KEY)n=m(this).find("mutation"),n="."+n.attr("t")+
"."+n.attr("v")+"."+m(this).attr("type");else if(m(this).attr("type")==b.EVTX_KEY2){n=m(this).find("mutation");var w=m(this).children("field[name\x3d'v']").text();""==w&&(w="[any]");n="."+n.attr("t")+"."+w+"."+b.EVTX_KEY}else"sb4_evtx_path"==m(this).attr("type")?("end"==m(this).children("field[name\x3d'num']").text()&&m(this).children("field[name\x3d'num']").text("-1"),n=m(this).find("mutation").attr("oid")+"."+m(this).attr("type")):n=0<m(this).children("mutation").length?m(this).find("mutation").attr("oid")+
"."+m(this).attr("type"):"."+m(this).attr("type");e.engine.registerDynamicEvent(n,m(this),l,f+"_"+m(c).attr("id"))});a=u.keys(g);0<a.length&&e.engine.registerEvent(a,l);e.logger._debug("parseWhen end "+a)}})};b.prototype.parseProceduresDefReturn=function(d){var f=this;m.each(d,function(e,a){f.logger._debug("procedures .... ");if("true"!=m(a).attr("disabled")){e=m(a);var c={};c.engineId=f.engine.id;c.ctx=f.engine.objctx.fork();c.name=e.children("field[name\x3dNAME]").text();c.statement=e.children("statement[name\x3dRETURN]");
c.argNames=[];m.each(e.children("mutation").children("arg"),function(g,l){c.argNames.push(m(l).attr("name"))});f.engine.objctx.get("_frame").engine.objctx.add("[fn:"+c.name+"]",c);f.logger._debug("procedures end ")}})};b.prototype.parseBlock=function(d,f){if(0==d.length||"true"==d.attr("disabled"))return d=d.children("next").first(),void 0!=d&&0<d.length?this.parseBlock(d.children("block"),f):f;var e=null,a=this.engine.objctx.get("flow");this.logger._debug("current flow is  "+a);"BREAK"!=a&&"CONTINUE"!=
a&&"true"!=d.attr("disabled")&&null!=b.parserMap[d.attr("type")]&&(e=this[b.parserMap[d.attr("type")]].apply(this,[d,f]));d.attr("type")==b.CONTROLS_FOREACH?e=this.parseControlsForEach(d,f):d.attr("type")==b.CONTROLS_FORRANGE?e=this.parseControlsForRange(d,f):d.attr("type")==b.CONTROLS_FLOW_STATEMENTS?e=this.parseControlsFlowStatements(d,f):d.attr("type")==b.CONTROLS_WHILE&&(e=this.parseControlsWhile(d,f));null==e&&(e=f);f=this.disableStopPoint||u.has(b.disableStopPointBlockTypeMap,d.attr("type"))?
e:this.createStopPoint(e,d);d=d.children("next").first();return void 0!=d&&0<d.length?this.parseBlock(d.children("block"),f):f};b.prototype.arrayToObject=function(d){var f={};u.isArray(d)&&!u.isEmpty(d)&&m.each(d,function(e,a){u.isArray(a)&&2<=a.length&&(f[a[0]]=a[1])});return f};b.prototype.createStopPoint=function(d,f){var e=this;return d.then(function(a){var c=m.Deferred(),g=c.then(function(){SB4API.debug&&null!=f&&e.engine._recordBlockResult(f.attr("id")+"."+f.attr("type"),a);return a});e.engine.addStopPoint(c,
e.engine.objctx);"busy"==e.engine.status&&(e.engine.status="idle");return g})};b.prototype.setDisableStopPoint=function(d){this.disableStopPoint=d};b.prototype.addLocalVarToEngineContext=function(d){var f=this;m.each(d,function(e,a){f.logger._debug("procedures addLocalVarToEngineContext .... ");"true"!=m(a).attr("disabled")&&(e=m(a).children("field"),m.each(e,function(c,g){c=m(g).html();f.engine.objctx.add("^SB4_local_var_prefix_"+c,"")}),f.logger._debug("procedures addLocalVarToEngineContext end "))})};
return b});define("sb4core/DeferredTask",["sb4core/Logger"],function(m){function u(q,p,b){this.c=q;this.tail=p;this.id=b;this.logger=new m("task",function(){return m.getDefaultPrefix()+b+" "})}u.prototype._process=function(){this.logger._debug("tail state is  : "+this.tail.state());if("pending"==this.c.state())this.c.resolve();else if("resolved"==this.tail.state()||"rejected"==this.tail.state())return!0};return u});
(function(m){"function"===typeof define&&define.amd?define("jqueryui/effect",["jquery"],m):m(jQuery)})(function(m){m.effects={effect:{}};(function(u,q){function p(h,r,v){var t=g[r.type]||{};if(null==h)return v||!r.def?null:r.def;h=t.floor?~~h:parseFloat(h);return isNaN(h)?r.def:t.mod?(h+t.mod)%t.mod:0>h?0:t.max<h?t.max:h}function b(h){var r=a(),v=r._rgba=[];h=h.toLowerCase();w(e,function(t,C){t=(t=C.re.exec(h))&&C.parse(t);C=C.space||"rgba";if(t)return t=r[C](t),r[c[C].cache]=t[c[C].cache],v=r._rgba=
t._rgba,!1});return v.length?("0,0,0,0"===v.join()&&u.extend(v,y.transparent),r):y[h]}function d(h,r,v){v=(v+1)%1;return 1>6*v?h+(r-h)*v*6:1>2*v?r:2>3*v?h+(r-h)*(2/3-v)*6:h}var f=/^([\-+])=\s*(\d+\.?\d*)/,e=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(h){return[h[1],h[2],h[3],h[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(h){return[2.55*h[1],2.55*h[2],
2.55*h[3],h[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(h){return[h[1],h[2]/100,h[3]/100,h[4]]}}],a=u.Color=function(h,r,v,t){return new u.Color.fn.parse(h,
r,v,t)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},g={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=a.support={},n=u("\x3cp\x3e")[0],w=u.each;n.style.cssText="background-color:rgba(1,1,1,.5)";l.rgba=-1<n.style.backgroundColor.indexOf("rgba");w(c,function(h,r){r.cache="_"+h;r.props.alpha={idx:3,type:"percent",def:1}});
a.fn=u.extend(a.prototype,{parse:function(h,r,v,t){if(h===q)return this._rgba=[null,null,null,null],this;if(h.jquery||h.nodeType)h=u(h).css(r),r=q;var C=this,B=u.type(h),A=this._rgba=[];r!==q&&(h=[h,r,v,t],B="array");if("string"===B)return this.parse(b(h)||y._default);if("array"===B)return w(c.rgba.props,function(E,F){A[F.idx]=p(h[F.idx],F)}),this;if("object"===B)return h instanceof a?w(c,function(E,F){h[F.cache]&&(C[F.cache]=h[F.cache].slice())}):w(c,function(E,F){var G=F.cache;w(F.props,function(z,
x){if(!C[G]&&F.to){if("alpha"===z||null==h[z])return;C[G]=F.to(C._rgba)}C[G][x.idx]=p(h[z],x,!0)});C[G]&&0>u.inArray(null,C[G].slice(0,3))&&(C[G][3]=1,F.from&&(C._rgba=F.from(C[G])))}),this},is:function(h){var r=a(h),v=!0,t=this;w(c,function(C,B){var A=r[B.cache];if(A){var E=t[B.cache]||B.to&&B.to(t._rgba)||[];w(B.props,function(F,G){if(null!=A[G.idx])return v=A[G.idx]===E[G.idx]})}return v});return v},_space:function(){var h=[],r=this;w(c,function(v,t){r[t.cache]&&h.push(v)});return h.pop()},transition:function(h,
r){var v=a(h);h=v._space();var t=c[h],C=0===this.alpha()?a("transparent"):this,B=C[t.cache]||t.to(C._rgba),A=B.slice();v=v[t.cache];w(t.props,function(E,F){E=F.idx;var G=B[E],z=v[E],x=g[F.type]||{};null!==z&&(null===G?A[E]=z:(x.mod&&(z-G>x.mod/2?G+=x.mod:G-z>x.mod/2&&(G-=x.mod)),A[E]=p((z-G)*r+G,F)))});return this[h](A)},blend:function(h){if(1===this._rgba[3])return this;var r=this._rgba.slice(),v=r.pop(),t=a(h)._rgba;return a(u.map(r,function(C,B){return(1-v)*t[B]+v*C}))},toRgbaString:function(){var h=
"rgba(",r=u.map(this._rgba,function(v,t){return null==v?2<t?1:0:v});1===r[3]&&(r.pop(),h="rgb(");return h+r.join()+")"},toHslaString:function(){var h="hsla(",r=u.map(this.hsla(),function(v,t){null==v&&(v=2<t?1:0);t&&3>t&&(v=Math.round(100*v)+"%");return v});1===r[3]&&(r.pop(),h="hsl(");return h+r.join()+")"},toHexString:function(h){var r=this._rgba.slice(),v=r.pop();h&&r.push(~~(255*v));return"#"+u.map(r,function(t){t=(t||0).toString(16);return 1===t.length?"0"+t:t}).join("")},toString:function(){return 0===
this._rgba[3]?"transparent":this.toRgbaString()}});a.fn.parse.prototype=a.fn;c.hsla.to=function(h){if(null==h[0]||null==h[1]||null==h[2])return[null,null,null,h[3]];var r=h[0]/255,v=h[1]/255,t=h[2]/255;h=h[3];var C=Math.max(r,v,t),B=Math.min(r,v,t),A=C-B,E=C+B,F=.5*E;return[Math.round(B===C?0:r===C?60*(v-t)/A+360:v===C?60*(t-r)/A+120:60*(r-v)/A+240)%360,0===A?0:.5>=F?A/E:A/(2-E),F,null==h?1:h]};c.hsla.from=function(h){if(null==h[0]||null==h[1]||null==h[2])return[null,null,null,h[3]];var r=h[0]/360,
v=h[1],t=h[2];h=h[3];v=.5>=t?t*(1+v):t+v-t*v;t=2*t-v;return[Math.round(255*d(t,v,r+1/3)),Math.round(255*d(t,v,r)),Math.round(255*d(t,v,r-1/3)),h]};w(c,function(h,r){var v=r.props,t=r.cache,C=r.to,B=r.from;a.fn[h]=function(A){C&&!this[t]&&(this[t]=C(this._rgba));if(A===q)return this[t].slice();var E=u.type(A),F="array"===E||"object"===E?A:arguments,G=this[t].slice();w(v,function(x,D){x=F["object"===E?x:D.idx];null==x&&(x=G[D.idx]);G[D.idx]=p(x,D)});if(B){var z=a(B(G));z[t]=G;return z}return a(G)};
w(v,function(A,E){a.fn[A]||(a.fn[A]=function(F){var G=u.type(F),z="alpha"===A?this._hsla?"hsla":"rgba":h,x=this[z](),D=x[E.idx];if("undefined"===G)return D;"function"===G&&(F=F.call(this,D),G=u.type(F));if(null==F&&E.empty)return this;"string"===G&&(G=f.exec(F))&&(F=D+parseFloat(G[2])*("+"===G[1]?1:-1));x[E.idx]=F;return this[z](x)})})});a.hook=function(h){h=h.split(" ");w(h,function(r,v){u.cssHooks[v]={set:function(t,C){var B,A="";if("transparent"!==C&&("string"!==u.type(C)||(B=b(C)))){C=a(B||C);
if(!l.rgba&&1!==C._rgba[3]){for(B="backgroundColor"===v?t.parentNode:t;(""===A||"transparent"===A)&&B&&B.style;)try{A=u.css(B,"backgroundColor"),B=B.parentNode}catch(E){}C=C.blend(A&&"transparent"!==A?A:"_default")}C=C.toRgbaString()}try{t.style[v]=C}catch(E){}}};u.fx.step[v]=function(t){t.colorInit||(t.start=a(t.elem,v),t.end=a(t.end),t.colorInit=!0);u.cssHooks[v].set(t.elem,t.start.transition(t.end,t.pos))}})};a.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");
u.cssHooks.borderColor={expand:function(h){var r={};w(["Top","Right","Bottom","Left"],function(v,t){r["border"+t+"Color"]=h});return r}};var y=u.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(m);(function(){function u(b){var d=b.ownerDocument.defaultView?
b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(d&&d.length&&d[0]&&d[d[0]])for(b=d.length;b--;){var e=d[b];"string"===typeof d[e]&&(f[m.camelCase(e)]=d[e])}else for(e in d)"string"===typeof d[e]&&(f[e]=d[e]);return f}var q=["add","remove","toggle"],p={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};m.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,d){m.fx.step[d]=
function(f){if("none"!==f.end&&!f.setAttr||1===f.pos&&!f.setAttr)m.style(f.elem,d,f.end),f.setAttr=!0}});m.fn.addBack||(m.fn.addBack=function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))});m.effects.animateClass=function(b,d,f,e){var a=m.speed(d,f,e);return this.queue(function(){var c=m(this),g=c.attr("class")||"",l=a.children?c.find("*").addBack():c;l=l.map(function(){return{el:m(this),start:u(this)}});var n=function(){m.each(q,function(w,y){if(b[y])c[y+"Class"](b[y])})};
n();l=l.map(function(){this.end=u(this.el[0]);var w=this.start,y=this.end,h={},r;for(r in y){var v=y[r];w[r]===v||p[r]||!m.fx.step[r]&&isNaN(parseFloat(v))||(h[r]=v)}this.diff=h;return this});c.attr("class",g);l=l.map(function(){var w=this,y=m.Deferred(),h=m.extend({},a,{queue:!1,complete:function(){y.resolve(w)}});this.el.animate(this.diff,h);return y.promise()});m.when.apply(m,l.get()).done(function(){n();m.each(arguments,function(){var w=this.el;m.each(this.diff,function(y){w.css(y,"")})});a.complete.call(c[0])})})};
m.fn.extend({addClass:function(b){return function(d,f,e,a){return f?m.effects.animateClass.call(this,{add:d},f,e,a):b.apply(this,arguments)}}(m.fn.addClass),removeClass:function(b){return function(d,f,e,a){return 1<arguments.length?m.effects.animateClass.call(this,{remove:d},f,e,a):b.apply(this,arguments)}}(m.fn.removeClass),toggleClass:function(b){return function(d,f,e,a,c){return"boolean"===typeof f||void 0===f?e?m.effects.animateClass.call(this,f?{add:d}:{remove:d},e,a,c):b.apply(this,arguments):
m.effects.animateClass.call(this,{toggle:d},f,e,a)}}(m.fn.toggleClass),switchClass:function(b,d,f,e,a){return m.effects.animateClass.call(this,{add:d,remove:b},f,e,a)}})})();(function(){function u(p,b,d,f){m.isPlainObject(p)&&(b=p,p=p.effect);p={effect:p};null==b&&(b={});m.isFunction(b)&&(f=b,d=null,b={});if("number"===typeof b||m.fx.speeds[b])f=d,d=b,b={};m.isFunction(d)&&(f=d,d=null);b&&m.extend(p,b);d=d||b.duration;p.duration=m.fx.off?0:"number"===typeof d?d:d in m.fx.speeds?m.fx.speeds[d]:m.fx.speeds._default;
p.complete=f||b.complete;return p}function q(p){return!p||"number"===typeof p||m.fx.speeds[p]||"string"===typeof p&&!m.effects.effect[p]||m.isFunction(p)||"object"===typeof p&&!p.effect?!0:!1}m.extend(m.effects,{version:"1.11.2",save:function(p,b){for(var d=0;d<b.length;d++)null!==b[d]&&p.data("ui-effects-"+b[d],p[0].style[b[d]])},restore:function(p,b){var d;for(d=0;d<b.length;d++)if(null!==b[d]){var f=p.data("ui-effects-"+b[d]);void 0===f&&(f="");p.css(b[d],f)}},setMode:function(p,b){"toggle"===
b&&(b=p.is(":hidden")?"show":"hide");return b},getBaseline:function(p,b){switch(p[0]){case "top":var d=0;break;case "middle":d=.5;break;case "bottom":d=1;break;default:d=p[0]/b.height}switch(p[1]){case "left":p=0;break;case "center":p=.5;break;case "right":p=1;break;default:p=p[1]/b.width}return{x:p,y:d}},createWrapper:function(p){if(p.parent().is(".ui-effects-wrapper"))return p.parent();var b={width:p.outerWidth(!0),height:p.outerHeight(!0),"float":p.css("float")},d=m("\x3cdiv\x3e\x3c/div\x3e").addClass("ui-effects-wrapper sb-effect-wrapper").css({fontSize:"100%",
background:"transparent",border:"none",margin:0,padding:0}),f={width:p.width(),height:p.height()},e=document.activeElement;try{e.id}catch(a){e=document.body}p.wrap(d);(p[0]===e||m.contains(p[0],e))&&m(e).focus();d=p.parent();"static"===p.css("position")?(d.css({position:"relative"}),p.css({position:"relative"})):(m.extend(b,{position:p.css("position"),zIndex:p.css("z-index")}),m.each(["top","left","bottom","right"],function(a,c){b[c]=p.css(c);isNaN(parseInt(b[c],10))&&(b[c]="auto")}),p.css({position:"relative",
top:0,left:0,right:"auto",bottom:"auto"}));p.css(f);return d.css(b).show()},removeWrapper:function(p){var b=document.activeElement;p.parent().is(".ui-effects-wrapper")&&(p.parent().replaceWith(p),(p[0]===b||m.contains(p[0],b))&&m(b).focus());return p},setTransition:function(p,b,d,f){f=f||{};m.each(b,function(e,a){e=p.cssUnit(a);0<e[0]&&(f[a]=e[0]*d+e[1])});return f}});m.fn.extend({effect:function(){function p(a){function c(){m.isFunction(l)&&l.call(g[0]);m.isFunction(a)&&a()}var g=m(this),l=b.complete,
n=b.mode;(g.is(":hidden")?"hide"===n:"show"===n)?(g[n](),c()):e.call(g[0],b,c)}var b=u.apply(this,arguments),d=b.mode,f=b.queue,e=m.effects.effect[b.effect.toLowerCase()];return m.fx.off||!e?d?this[d](b.duration,b.complete):this.each(function(){b.complete&&b.complete.call(this)}):!1===f?this.each(p):this.queue(f||"fx",p)},show:function(p){return function(b){if(q(b))return p.apply(this,arguments);var d=u.apply(this,arguments);d.mode="show";return this.effect.call(this,d)}}(m.fn.show),hide:function(p){return function(b){if(q(b))return p.apply(this,
arguments);var d=u.apply(this,arguments);d.mode="hide";return this.effect.call(this,d)}}(m.fn.hide),toggle:function(p){return function(b){if(q(b)||"boolean"===typeof b)return p.apply(this,arguments);var d=u.apply(this,arguments);d.mode="toggle";return this.effect.call(this,d)}}(m.fn.toggle),cssUnit:function(p){var b=this.css(p),d=[];m.each(["em","px","%","pt"],function(f,e){0<b.indexOf(e)&&(d=[parseFloat(b),e])});return d}})})();(function(){var u={};m.each(["Quad","Cubic","Quart","Quint","Expo"],
function(q,p){u[p]=function(b){return Math.pow(b,q+2)}});m.extend(u,{Sine:function(q){return 1-Math.cos(q*Math.PI/2)},Circ:function(q){return 1-Math.sqrt(1-q*q)},Elastic:function(q){return 0===q||1===q?q:-Math.pow(2,8*(q-1))*Math.sin((80*(q-1)-7.5)*Math.PI/15)},Back:function(q){return q*q*(3*q-2)},Bounce:function(q){for(var p,b=4;q<((p=Math.pow(2,--b))-1)/11;);return 1/Math.pow(4,3-b)-7.5625*Math.pow((3*p-2)/22-q,2)}});m.each(u,function(q,p){m.easing["easeIn"+q]=p;m.easing["easeOut"+q]=function(b){return 1-
p(1-b)};m.easing["easeInOut"+q]=function(b){return.5>b?p(2*b)/2:1-p(-2*b+2)/2}})})();return m.effects});
define("sb4core/parse/core/text_join",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseTextJoin=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.children("value");if(0<d.length){var f="",e=$.Deferred(),a=e,c=$.Deferred(),g=0,l=b.engine.objctx;$.each(d,function(n,w){a=b.parseBlock($(w).find("block:first"),a).then(function(y){f=_.str.join("",f,u.parseString(y));g+=1;g==d.length&&c.resolve()}).then(function(){b.engine.objctx=
l})});e.resolve();return c.then(function(){return f})}})}});
define("sb4core/parse/core/sb4_wgt_setter",["sb4core/SB4ParseCore","sb4core/ClassUtil"],function(m,u){m.prototype.parseWgtSetter=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.find("mutation").attr("oid"),f="set"+_.str.capitalize(q.find("mutation").attr("m"));b.logger._debug(q.attr("id")+"."+q.attr("type")+" parseWgtSetter ..."+d+" "+f);var e=q.children("value").find("block:first"),a=$.Deferred();e=b.parseBlock(e,a).then(function(c){var g=
b.engine.objctx.get(d);u.invoke(g,f,[c])});a.resolve();return e})}});
define("sb4core/parse/core/sb4_math_arithmetic2",["sb4core/SB4ParseCore","sb4core/DataUtil","lib/decimal"],function(m,u,q){m.prototype.parseMathArithmetic2=function(p,b){var d=this;return b.then(function(){d.logger._debug(p.attr("id")+"."+p.attr("type")+" start ... ");var f=p.children("field[name\x3dOP]").text(),e=p.children("value");if(0<e.length){var a=[],c=$.Deferred(),g=$.Deferred(),l=0,n=d.engine.objctx;c.then(function(){$.each(e,function(y,h){d.engine.objctx=n;var r=$.Deferred();d.parseBlock($(h).find("block:first"),
r).then(function(v){a[y]=u.parseNumber(v);l+=1;l==e.length&&g.resolve()});r.resolve()})});var w=g.then(function(){if(2<=a.length){if("ADD"==f){var y=a.shift(),h=new q(y);$.each(a,function(B,A){h=h.add(A)});return h.toNumber()}if("MINUS"==f){y=a.shift();var r=new q(y);$.each(a,function(B,A){r=r.sub(A)});return r.toNumber()}if("MULTIPLY"==f){y=a.shift();var v=new q(y);$.each(a,function(B,A){v=v.mul(A)});return v.toNumber()}if("DIVIDE"==f){y=a.shift();var t=new q(y);$.each(a,function(B,A){t=t.div(A)});
return t.toNumber()}if("POWER"==f){y=a.shift();var C=new q(y);$.each(a,function(B,A){C=C.pow(A)});return C.toNumber()}d.logger._warn(p.attr("id")+"."+p.attr("type")+" op is error ");return!1}return 1==a.length?a[0]:0});c.resolve();return w}})}});
define("sb4core/parse/core/sb4_goto_branch",["sb4core/SB4ParseCore"],function(m){m.prototype.parseGotoBranch=function(u,q){var p=this;return q.then(function(){p.logger._info(u.attr("id")+"."+u.attr("type")+" start ... ");var b={};b.v=u.children("field[name\x3dv]").text();var d=p.engine.objctx.get("_frame"),f=$.Deferred();f.reject();f.fail(function(){p.engine.interrupt("gotoPage");d.onEnginePageEvent(u.attr("type"),b)});return f})}});
define("sb4core/parse/core/sb4_wgt_getter",["sb4core/SB4ParseCore","sb4core/ClassUtil"],function(m,u){m.prototype.parseWgtGetter=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.find("mutation").attr("oid"),f="get"+_.str.capitalize(q.find("mutation").attr("m"));b.logger._debug(q.attr("id")+"."+q.attr("type")+" parseWgtGetter ..."+d+" "+f);d=b.engine.objctx.get(d);return u.invoke(d,f,[])})}});
define("sb4core/parse/core/text_compare",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseTextCompare=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.children("field[name\x3dOP]").text().trim(),f=b.engine.objctx,e=$.Deferred(),a=b.parseBlock(q.children("value[name\x3dTEXT1]").find("block:first"),e),c=$.Deferred(),g=b.parseBlock(q.children("value[name\x3dTEXT2]").find("block:first"),c);a=$.when(a,g).then(function(l,
n){b.logger._debug(q.attr("id")+"."+q.attr("type")+" "+l+" parseTextCompare "+n);l=u.parseString(l);n=u.parseString(n);if("LT"==d)return l<n;if("EQUAL"==d)return l==n;if("GT"==d)return l>n;b.logger._debug(q.attr("id")+"."+q.attr("type")+" op is error ");return!1});e.resolve();b.engine.objctx=f;c.resolve();return a})}});
define("sb4core/parse/core/sb4_wgt_method",["sb4core/SB4ParseCore","sb4core/ClassUtil"],function(m,u){m.prototype.parseWgtMethod=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.find("mutation").attr("oid"),f=q.find("mutation").attr("m"),e=[];$.each(q.children(),function(y,h){"field"!=$(h).prop("tagName")&&"value"!=$(h).prop("tagName")||e.push(h)});e=_.sortBy(e,function(y){return $(y).attr("name")});var a=$.Deferred(),c=[],g=$.Deferred(),
l=g,n=b.engine.objctx;$.each(e,function(y,h){l=l.then(function(r){var v=$(h).attr("name").split("-")[1];if("value"==$(h).prop("tagName")){b.engine.objctx=n;r=$.Deferred();var t=b.parseBlock($(h).find("block:first"),r).then(function(C){c[v]=C});r.resolve();return t}c[v]=$(h).html()})});b.logger._debug(q.attr("id")+"."+q.attr("type")+" parseWgtMethod ..."+d+" "+f+" ",c);var w=a.then(function(){var y=b.engine.objctx.get(d);return u.invoke(y,f,c)});l.then(function(){a.resolve()});g.resolve();return w})}});
define("sb4core/parse/core/sb4_goto_page",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseGotoPage=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d={},f=b.engine.objctx.get("_frame"),e=q.children("field[name\x3dv]").html();d.id=u.parseString(e);e=$.Deferred();e.reject();e.fail(function(){b.engine.interrupt("gotoPage");f.onEnginePageEvent("sb4_goto_scene_by_id",d)});return e})}});
define("sb4core/parse/core/sb4_math_arithmetic",["sb4core/SB4ParseCore","sb4core/DataUtil","lib/decimal"],function(m,u,q){m.prototype.parseMathArithmetic=function(p,b){var d=this;return b.then(function(){d.logger._info(p.attr("id")+"."+p.attr("type")+" start ... ");var f=d.engine.objctx,e=$.Deferred(),a=$.Deferred(),c=p.children("field[name\x3dOP]").text(),g=d.parseBlock(p.children("value[name\x3dA]").find("block:first"),e),l=d.parseBlock(p.children("value[name\x3dB]").find("block:first"),a);e.resolve();
d.engine.objctx=f;a.resolve();return $.when(g,l).then(function(n,w){d.logger._debug(p.attr("id")+"."+p.attr("type")+" "+n+" : "+w);n=u.parseNumber(n);w=u.parseNumber(w);if("ADD"==c)return(new q(n)).add(w).toNumber();if("MINUS"==c)return(new q(n)).sub(w).toNumber();if("MULTIPLY"==c)return(new q(n)).mul(w).toNumber();if("DIVIDE"==c)return(new q(n)).div(w).toNumber();if("POWER"==c)return(new q(n)).pow(w).toNumber();d.logger._warn(p.attr("id")+"."+p.attr("type")+" op is error ");return!1})})}});
define("sb4core/parse/core/math_compare",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseMathCompare=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=$.Deferred(),f=$.Deferred(),e=q.children("field[name\x3dOP]").text(),a=b.parseBlock(q.children("value[name\x3dA]").find("block:first"),d),c=b.parseBlock(q.children("value[name\x3dB]").find("block:first"),f),g=b.engine.objctx;d.resolve();b.engine.objctx=g;
f.resolve();return $.when(a,c).then(function(l,n){b.logger._debug(q.attr("id")+"."+q.attr("type")+" "+l+" : "+n);if(null==e)return b.logger._warn(q.attr("id")+"."+q.attr("type")+" op is error "),!1;if("S"==e.charAt(e.length-1)){l=u.parseString(l);n=u.parseString(n);if("EQS"==e)return l==n;if("NEQS"==e)return l!=n;if("LTS"==e)return l<n;if("LTES"==e)return l<=n;if("GTS"==e)return l>n;if("GTES"==e)return l>=n}else{if(_.isObject(l)||_.isObject(n))return l instanceof $.Color||n instanceof $.Color?(l=
u.parseColor(l),n=u.parseColor(n),"EQ"==e||"LTE"==e||"GTE"==e?l.is(n):"NEQ"==e?!l.is(n):!1):"EQ"==e||"LTE"==e||"GTE"==e?l===n:"NEQ"==e?l!==n:!1;null==l&&(l="");null==n&&(n="");if("EQ"==e)return l==n;if("NEQ"==e)return l!=n;if("LT"==e)return l<n;if("LTE"==e)return l<=n;if("GT"==e)return l>n;if("GTE"==e)return l>=n}})})}});
define("sb4core/parse/core/sb4_showex",["sb4core/SB4ParseCore","sb4core/ClassUtil","sb4core/DataUtil"],function(m,u,q){m.prototype.parseShowWithEffect=function(p,b){var d=this;return b.then(function(){d.logger._info(p.attr("id")+"."+p.attr("type")+" start ... ");var f=p.children("field[name\x3dOP]").text().trim(),e=p.children("field[name\x3dEFFECT]").text(),a=$.Deferred(),c=d.engine.objctx.get(SB4API._OBJECT_KEY.EFFECT_TIME),g=[],l=0,n=p.children("value[name\x3dWGT]").children("block");if(0<n.length){var w=
d.engine.objctx;$.each(n,function(y,h){d.engine.objctx=w;y=$.Deferred();d.parseBlock($(h),y).then(function(r){g=g.concat(r);l+=1;l==n.length&&a.resolve()});y.resolve()});return a.then(function(){return _.union(g)}).then(function(y){y=q.parseWidgetArray(y);$.each(y,function(h,r){h=[];h.push(e);h.push("");h.push(c);u.invoke(r,f,h)})})}})}});
define("sb4core/parse/core/sb4_controls_if",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseIf=function(q,p){var b=this;b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=1,f=q.find("mutation").attr("elseif");f&&(d+=u.parseInt(f));var e=$.Deferred(),a=function(c,g){if(c<d){var l=q.children("statement[name\x3dDO"+c+"]"),n=q.children("value[name\x3dIF"+c+"]").find("block:first");b.parseBlock(n,g).then(function(w){if(u.isTrue(w)){w=$.Deferred();var y=b.parseBlock(l.find("block:first"),
w).then(function(){e.resolve()});w.resolve();return y}w=$.Deferred();w.resolve();c+=1;return a(c,w)})}else{n=q.children("statement[name\x3dELSE]");if(void 0!=n&&0<n.length)return g=$.Deferred(),n=b.parseBlock(n.find("block:first"),g).then(function(){e.resolve()}),g.resolve(),n;e.resolve()}};a(0,p);return e}});
define("sb4core/parse/core/logic_operation",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseLogicOperation=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=$.Deferred(),f=$.Deferred(),e=q.children("field[name\x3dOP]").text(),a=b.parseBlock(q.children("value[name\x3dA]").find("block:first"),d),c=b.parseBlock(q.children("value[name\x3dB]").find("block:first"),f);d.resolve();return $.when(a).then(function(g){b.logger._debug(q.attr("id")+
"."+q.attr("type")+" op1 \x3d "+g);g=u.parseBoolean(g);if("AND"==e)return g?(f.resolve(),$.when(c).then(function(l){b.logger._debug(q.attr("id")+"."+q.attr("type")+" op2 \x3d "+l);return u.parseBoolean(l)})):!1;if(g)return!0;f.resolve();return $.when(c).then(function(l){b.logger._debug(q.attr("id")+"."+q.attr("type")+" op2 \x3d "+l);return u.parseBoolean(l)})})})}});
define("sb4core/parse/core/sb4_wgt",["sb4core/SB4ParseCore"],function(m){m.prototype.parseWgt=function(u,q){var p=this;return q.then(function(){p.logger._info(u.attr("id")+"."+u.attr("type")+" start ... ");var b=u.find("mutation").attr("oid");p.logger._debug(u.attr("id")+"."+u.attr("type")+" parseWgtGetter ..."+b);return p.engine.objctx.get(b)})}});
define("sb4core/parse/core/sb4_val",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseVal=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.find("mutation").attr("vtype"),f=q.children("field[name\x3dV]").text();"BOOL"==d?f=u.parseBoolean(f):"TXT"==d?f=u.parseString(f):"COLOR"==d?f=u.parseColor(f).toHexString():"NUM"==d&&(f=u.parseNumber(f));b.logger._debug(q.attr("id")+"."+q.attr("type")+" "+d+" parseVal  value\x3d "+
f);return f})}});
define("sb4core/parse/core/logic_op2",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.prototype.parseLogicOp2=function(q,p){var b=this;return p.then(function(){b.logger._debug(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.children("field[name\x3dOP]").text(),f=q.children("value");if(0<f.length){var e=[],a=$.Deferred(),c=$.Deferred(),g=b.engine.objctx;a.then(function(){$.each(f,function(n,w){b.engine.objctx=g;n=$.Deferred();b.parseBlock($(w).find("block:first"),n).then(function(y){e.push(u.parseBoolean(y));
e.length==f.length&&c.resolve()});n.resolve()})});var l=c.then(function(){if(1<=e.length){if("AND"==d){var n=!0;$.each(e,function(w,y){if(!y)return n=!1})}else n=!1,$.each(e,function(w,y){if(y)return n=!0,!1});return n}return!1});a.resolve();return l}return!1})}});
define("sb4core/parse/core/lexical_variable_get",["sb4core/SB4ParseCore"],function(m){m.prototype.parseLexicalVariableGet=function(u,q){var p=this;return q.then(function(){p.logger._info(u.attr("id")+"."+u.attr("type")+" start ... ");var b=u.children("field[name\x3dVAR]").text();return p.engine.objctx.get(b)})}});
define("sb4core/parse/core/lexical_variable_set",["sb4core/SB4ParseCore","sb4core/DataUtil"],function(m,u){m.parserMap.lexical_variable_set="parseLexicalVariableSet";m.prototype.parseLexicalVariableSet=function(q,p){var b=this;return p.then(function(){b.logger._info(q.attr("id")+"."+q.attr("type")+" start ... ");var d=q.children("field[name\x3dVAR]").text(),f=$.Deferred(),e=b.parseBlock(q.children("value[name\x3dVALUE]").find("block:first"),f).then(function(a){0==d.indexOf("global ")?b.engine.objctx.set(d,
a):b.engine.objctx.contains(d)?b.engine.objctx.set(d,a):b.engine.objctx.add(d,a)});f.resolve();return e})}});
define("sb4core/parse/parse_core","sb4core/parse/core/text_join sb4core/parse/core/sb4_wgt_setter sb4core/parse/core/sb4_math_arithmetic2 sb4core/parse/core/sb4_goto_branch sb4core/parse/core/sb4_wgt_getter sb4core/parse/core/text_compare sb4core/parse/core/sb4_wgt_method sb4core/parse/core/sb4_goto_page sb4core/parse/core/sb4_math_arithmetic sb4core/parse/core/math_compare sb4core/parse/core/sb4_showex sb4core/parse/core/sb4_controls_if sb4core/parse/core/logic_operation sb4core/parse/core/sb4_wgt sb4core/parse/core/sb4_val sb4core/parse/core/logic_op2 sb4core/parse/core/lexical_variable_get sb4core/parse/core/lexical_variable_set".split(" "),function(){});
define("sb4core/SB4Engine","jquery underscore sb4core/Logger sb4core/ClassUtil sb4core/DataUtil sb4core/SB4ParseCore sb4core/DeferredTask underscore_str jqueryui/core jqueryui/effect sb4core/parse/parse_core".split(" "),function(m,u,q,p,b,d,f){function e(c,g,l,n){void 0==c&&(c="");this.id=c;void 0==c&&(c="-");this.name=n;this.timer=-1;this.tick=b.parseNumber(g);this.tick=0>=this.tick?8:this.tick;g>e.MAX_TITCK&&(this.tick=e.MAX_TITCK);this.logger=new q("engine",function(){return q.getDefaultPrefix()+
c+" "+n+" "});this.status=e.STATUS_STOP;this.taskQueue=new a;this.subEngines=[];this.initObjctx=this.objctx=l;this.idleCount=0;this.maxIdleCount=1E3;this.startFlag=!0;this.results=[];this.eventMap={};this.dynamicEventMap={};this.eventIdleCount=0;this.maxEventIdleCount=10;this.parse=new d(this);this.eventQueue=[];this.lastParsedEventQueue=[];this.lastBlockResultQueue=[];this.statementQueue=[];this.listenerQueue=[];this.stopPoints=[];this.burst=e.BURST;this.isFork=!1;this.logger._info("SB4Engine init .. "+
c)}function a(){this.queue=[]}e.BURST=20;e.STATUS_STOP="stop";e.STATUS_SLEEP="sleep";e.STATUS_DEAD="dead";e.STATUS_IDLE="idle";e.STATUS_BUSY="busy";e.MODE_GOTO_PAGE="gotoPage";e.MAX_TITCK=50;e.prototype._workProcess=function(){var c=this;if(this.status==e.STATUS_DEAD)return this.logger._debug("SB4Engine is dead, ignoring _work tick"),!1;if(this.status==e.STATUS_BUSY)return this.logger._debug(" is busy"),!1;if(this.status==e.STATUS_STOP)return this.logger._debug(" is stop"),!1;if(0<this.taskQueue.length()){this.status=
e.STATUS_BUSY;this.idleCount=0;var g=this.taskQueue.first(),l=this.stopPoints;this.stopPoints=[];0<u.size(l)&&u.each(l,function(n,w){c.logger._debug("stop point deferred resolve");c.objctx=n[1];n[0].resolve()});if(this.status==e.STATUS_STOP)return this.logger._debug(" is sleep after resolve stop point deferred"),!1;try{if(g._process()&&this.taskQueue)if(this.taskQueue.shift(),0<this.taskQueue.length()){if(this.status=e.STATUS_BUSY,this.idleCount=0,l=this.stopPoints,this.stopPoints=[],0<u.size(l)&&
u.each(l,function(n,w){c.logger._debug("stop point deferred resolve");c.objctx=n[1];n[0].resolve()}),g=this.taskQueue.first(),null==g||g._process())this.status=e.STATUS_IDLE}else this.status=e.STATUS_IDLE}catch(n){null!=this.taskQueue&&0<this.taskQueue.length()&&(g=this.taskQueue.shift(),u.isFunction(g.c.reject)&&(g.c.reject(),this.logger._warn("remove error task"))),this.status!=e.STATUS_DEAD&&(this.status=e.STATUS_IDLE),this.logger._warn("engine work process error: "+n.name+" : "+n.message)}}else{if(0<
this.statementQueue.length)return this.idleCount=0,g=this.statementQueue.shift(),this._processStatement(g),!1;g=!1;0<this.eventQueue.length?(l=this.eventQueue.shift(),this._parseEvent(l)):(this.idleCount+=1,g=!0);this.idleCount>this.maxIdleCount&&(this.status=e.STATUS_SLEEP,clearInterval(this.timer),clearTimeout(this.timer),this.timer=-1,g=!0);return!g}};e.prototype.start=function(c){this.logger._debug(" start, isParentCall: "+c+" ,startFlag:"+this.startFlag);this.idleCount=0;c||(this.startFlag=!0);
if(!c||this.startFlag)if(this.status==e.STATUS_SLEEP||this.status==e.STATUS_STOP){c=this.status==e.STATUS_STOP&&!this.isFork;this.status=e.STATUS_IDLE;var g=this;this.timer=setInterval(function(){for(var l=g.burst;0<--l&&0!=g._workProcess(););},this.tick);c&&u.each(u.values(this.initObjctx.map),function(l,n){b.isWgt(l)&&u.isFunction(l._play)&&l._play()})}this.status!=e.STATUS_DEAD&&m.each(this.subEngines,function(l,n){n.status!=e.STATUS_SLEEP&&this.status!=e.STATUS_STOP||n.start(!0)})};e.prototype.stop=
function(c){this.logger._info(" stop "+c);this.status!=e.STATUS_DEAD&&m.each(this.subEngines,function(l,n){n.stop(!0)});c||(this.startFlag=!1);if(this.status!=e.STATUS_DEAD){if(this.status!=e.STATUS_STOP&&!this.isFork){var g=this;u.each(u.keys(this.initObjctx.map),function(l,n){n=g.initObjctx.map[l];b.isWgt(n)&&n.options._i==l&&u.isFunction(n._stop)&&n._stop()})}this.status=e.STATUS_STOP;clearInterval(this.timer);clearTimeout(this.timer);this.timer=-1;this.idleCount=0}};e.prototype.destroy=function(){this.logger._info(" destroy ");
this.status!=e.STATUS_DEAD&&m.each(this.subEngines,function(c,g){g.destroy()});this.stop();this.status=e.STATUS_DEAD;this.results=this.listenerQueue=this.initObjctx=this.lastBlockResultQueue=this.lastParsedEventQueue=this.parse=this.dynamicEventMap=this.eventMap=this.statementQueue=this.eventQueue=this.objctx=this.subEngines=this.taskQueue=this.timer=void 0};e.prototype.addEngine=function(c){this.subEngines.push(c)};e.prototype.addSubEngine=function(c,g){u.str.isBlank(c)&&(c=u.uniqueId(this.id+"_"));
c=new e(c,1.1*this.tick,this.objctx.fork(),g);this.subEngines.push(c);return c};e.prototype._purgeSubEngine=function(){if(this.status!=e.STATUS_DEAD)for(var c=this.subEngines.length-1;0<=c;c--)this.subEngines[c].status==e.STATUS_DEAD&&(this.logger._debug("  _purgeSubEngine, removed "+this.subEngines[c].id),this.subEngines.splice(c,1))};e.prototype.isSubEnginesInState=function(c){return void 0!=u.find(this.subEngines,function(g){if(void 0!=g&&g.status!=c)return!0})?!1:!0};e.prototype.getSubEngineByID=
function(c){var g;!u.str.isBlank(c)&&0<u.size(this.subEngines)&&m.each(this.subEngines,function(l,n){c==n.id&&(g=n)});return g};e.prototype._longTaskFinish=function(c){this.logger._debug("_longTaskFinish ",c,this.results);this.status!=e.STATUS_DEAD&&(void 0!=c&&this.results.push(c),this.status=e.STATUS_IDLE)};e.prototype.addEngineEventListener=function(c){u.contains(this.listenerQueue,c)||"onEngineEvent"in c&&this.listenerQueue.push(c)};e.prototype.removeEngineEventListener=function(c){var g=this;
m.each(this.listenerQueue,function(l,n){if(n===c)return g.listenerQueue.splice(l,1),!1})};e.prototype.registerEvent=function(c,g){if(this.status!=e.STATUS_DEAD){var l=this;m.each(c,function(n,w){n=l.eventMap[w];void 0==n&&(n=[],l.eventMap[w]=n);if(m.isArray(g))for(var y=0;y<g.length;y++)g[y].id=w,n.push(g[y]);else g.id=w,n.push(g)})}};e.prototype.registerDynamicEvent=function(c,g,l,n){if(this.status!=e.STATUS_DEAD){var w={};w.condition=g;w.expr=l;w.whenBlockId=n;(g=this.dynamicEventMap[c])?g.push(w):
(g=[],g.push(w),this.dynamicEventMap[c]=g)}};e.prototype.addEvent=function(c,g,l){var n=this;if(this.status!=e.STATUS_DEAD)if(SB4API.disableEngineAddEvent)this.logger._debug(" disable event ",c,g,l);else{this.eventQueue.push([c,g,l]);this.logger._info(" addEvent ",c,g,l);if("flow"==c&&u.string.startsWith(g,"evt://")&&null!=l&&l.broadcast)SB4API.onGlobalEventListener(c+"."+g,l["[evtval]"]);if(null!=l&&l.broadcast)this.status==e.STATUS_SLEEP&&this.start(),m.each(this.listenerQueue,function(w,y){y.onEngineEvent(n,
c,g,l)});else if("flow"!=c||"load"!=g)this.status==e.STATUS_SLEEP&&this.start(),m.each(this.listenerQueue,function(w,y){y.onEngineEvent(n,c,g,l)})}};e.prototype._parseEvent=function(c){var g=!0,l=this,n=c[0],w=b.parseString(c[1]),y=c[2];l.objctx.remove("[evt_k.key]");l.objctx.remove("[evt_k]");var h=n+"."+w;if(0==w.indexOf("sb4_evtx")){if("sb4_evtx_a"==w)h=n+"."+y.src.options._d.type+"."+y.v+"."+w;else if(w==d.EVTX_KEY){var r=SB4API.LEGACY_KEYMAP[y.evt.key];void 0==r&&(r=y.evt.key);h=n+"."+y.op+"."+
r+"."+w;l.objctx.add("[evt_k.key]",r);l.objctx.add("[evt_k]",y.evt)}r=this.dynamicEventMap[h];w==d.EVTX_KEY&&(r=u.union(r,this.dynamicEventMap[n+"."+y.op+".[any]."+w]));if(r&&0<r.length){n=!1;if(y&&y.remove&&(n=y.remove())){var v=[];m.each(l.eventQueue,function(C,B){C=B[0];var A=b.parseString(B[1]),E=C+"."+A;"sb4_evtx_a"==w&&(E=C+"."+B[2].src.options._d.type+"."+B[2].v+"."+A);h==E&&v.push(B)});m.each(v,function(C,B){l.eventQueue=u.without(l.eventQueue,B)})}var t={};m.each(r,function(C,B){var A={},
E=C=m.Deferred();m.each(m(B.condition).children(),function(F,G){"value"==m(G).prop("tagName")?E=E.then(function(){l.parse.setDisableStopPoint(!0);var z=m.Deferred(),x=l.parse.parseBlock(m(G).find("block:first"),z).then(function(D){l.parse.setDisableStopPoint(!1);A[m(G).attr("name")]=D});z.resolve();return x}):"field"==m(G).prop("tagName")?E=E.then(function(){A[m(G).attr("name")]=m(G).html()}):"mutation"==m(G).prop("tagName")&&(E="sb4_evtx_path"==w?E.then(function(){A.src=l.objctx.get(m(G).attr("pid"))}):
E.then(function(){m(G).attr("name")&&(A[m(G).attr("name")]=m(G).attr(m(G).attr("name")))}))});E=E.then(function(){l.logger._info("sb4_evtx result ",A);var F=u.keys(A);if(0<F.length){var G=!0;m.each(F,function(z,x){u.isArray(y[x+"_list"])&&u.isArray(A[x])?m.each(y[x+"_list"],function(D,H){u.contains(A[x],H)||(G=!1)}):"[any]"==y[x]||u.isEqual(A[x],y[x])||(G=!1)});G&&(F=B.whenBlockId,u.has(t,F)||(y&&y.src?l.objctx.add("[source]",y.src):l.objctx.get(c[0])?l.objctx.add("[source]",l.objctx.get(c[0])):l.objctx.add("[source]",
null),y&&l.objctx.add("[evtval]",y["[evtval]"]),g=!1,l._recordEvent(c),l.statementQueue.push(B.expr),u.str.isBlank(F)||(t[F]=1)))}});C.resolve()})}else if(n=y.WGT)"sb4_evtx_a"==w&&(h=y.v+"."+w),this.objctx.get(n.options._i,!0)&&n.addIgnoreEvent(h)}else{r=this.eventMap[h];if("key_d"==n||"key_u"==n)r=u.union(r,this.eventMap[n+".[any]"]),l.objctx.add("[evt_k.key]",w),l.objctx.add("[evt_k]",y);void 0!=r&&0<r.length?(m.each(r,function(C,B){C=!1;if(y&&y.remove&&(C=y.remove())){var A=[];m.each(l.eventQueue,
function(E,F){E=F[0];var G=b.parseString(F[1]);h==E+"."+G&&A.push(F)});m.each(A,function(E,F){l.eventQueue=u.without(l.eventQueue,F)})}l._recordEvent(c);l.statementQueue.push(B)}),g=!1,y&&y.src?l.objctx.add("[source]",y.src):l.objctx.get(c[0])?l.objctx.add("[source]",l.objctx.get(c[0])):l.objctx.add("[source]",null),y&&l.objctx.add("[evtval]",y["[evtval]"])):(n=this.objctx.get(n,!0))&&n.addIgnoreEvent(w)}g?0<this.eventQueue.length&&this.eventIdleCount<this.maxEventIdleCount?(this.eventIdleCount++,
n=this.eventQueue.shift(),this._parseEvent(n)):this.eventIdleCount=0:this.eventIdleCount=0};e.prototype.parseXml=function(c){this.status!=e.STATUS_DEAD&&this.parse.parse(c)};e.prototype.addFunctionTask=function(c,g,l,n){var w=m.Deferred(),y=w.then(function(){return p.invoke(c,g,l)});y=this.parse.createStopPoint(y);n=new f(w,y,n);this.taskQueue.push(n)};e.prototype._processStatement=function(c){this.logger._debug(" _processStatement ",c);if(u.isFunction(c)){var g=m.Deferred(),l=g.then(function(){return c()});
l=this.parse.createStopPoint(l);var n=new f(g,l,"statement function");this.taskQueue.push(n)}else{var w=new d(this);this.parse=w;var y=this;g=m.Deferred();var h=g.then(function(){y.objctx=y.objctx.fork();y.objctx.add(SB4API._OBJECT_KEY.CURRENT_CONTEXT,y.objctx)});try{l=this.parse.parseBlock(c.find("block:first"),h),l=this.parse.createStopPoint(l),n=new f(g,l,c.id),l.fail(function(){y.logger._info("fail task and change status to idle")}).always(function(){w&&null!=w.engine&&(w.engine.objctx=w.engine.initObjctx)}),
this.taskQueue.push(n)}catch(r){throw r;}}};e.prototype.forkWaitEngine=function(c){var g=this.addSubEngine(u.uniqueId(this.id+"_"),c);g.isFork=!0;g.isWait=!0;m.each(this.listenerQueue,function(l,n){g.addEngineEventListener(n)});g.objctx=g.objctx.pop();g.initObjctx=g.objctx;this.objctx=this.initObjctx;return g};e.prototype.fork=function(c){var g=this.addSubEngine(u.uniqueId(this.id+"_"),c);g.isFork=!0;for(m.each(this.listenerQueue,function(l,n){g.addEngineEventListener(n)});0<this.taskQueue.length();)g.taskQueue.push(this.taskQueue.shift());
g.parse=this.parse;this.parse.engine=g;this.addDestroySubEngineTask(g);this.objctx=this.initObjctx;this.status=e.STATUS_IDLE;return g};e.prototype.addDestroySubEngineTask=function(c){var g=this,l=function(){c.isSubEnginesInState(e.STATUS_DEAD)?(c.parse.engine=g,c.destroy(),g._purgeSubEngine()):(c.statementQueue.push(l),c.status=e.STATUS_IDLE)};c.statementQueue.push(l)};e.prototype.interrupt=function(c){e.MODE_GOTO_PAGE==c&&(this.taskQueue.shift(),this.status=e.STATUS_IDLE)};e.prototype.getWgtByID=
function(c){return this.objctx.get(c)};e.prototype.invokeWidgetMethod=function(c,g,l){return p.invokeWgtMethod(c,g,l)};e.prototype._recordEvent=function(c){10<=u.size(this.lastParsedEventQueue)&&this.lastParsedEventQueue.pop();var g=c[2];g=g&&g.src?g.src:this.objctx.get(c[0])?this.objctx.get(c[0]):c[0];u.isObject(g)&&(g=g.options._n);var l={};l.obj=g;l.name=c[1];this.lastParsedEventQueue.push(l)};e.prototype.addStopPoint=function(c,g){this.stopPoints.push([c,g])};e.prototype._recordBlockResult=function(c,
g){g=b.stringify(g);10<=u.size(this.lastBlockResultQueue)&&this.lastBlockResultQueue.pop();var l={};l[c]=g;this.lastBlockResultQueue.push(l)};a.prototype.shift=function(){return this.queue.shift()};a.prototype.push=function(c){this.queue.push(c)};a.prototype.unshift=function(c){this.queue.unshift(c)};a.prototype.first=function(){return u.first(this.queue)};a.prototype.length=function(){return this.queue.length};return e});
define("sb4core/textlib",[],function(){function m(b,d,f,e){this.glyphReg=b;this.textReg=d;this.ctx=f.getContext("2d");this.dscratchpad=e}window.DEBUG&&console.log("textlib load");if("undefined"==typeof u){var u=function(b){return b.replace(/[\u00A0-\uffff<>&]/g,function(d){return"\x26"+(u.entityTable[d.charCodeAt(0)]||"#"+d.charCodeAt(0))+";"})};u.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",
168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",
211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",
252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",
961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",
8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",
338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"}}CanvasRenderingContext2D.prototype.clear=CanvasRenderingContext2D.prototype.clear||function(b){b&&(this.save(),this.setTransform(1,0,0,1,0,0));this.clearRect(0,
0,this.canvas.width,this.canvas.height);b&&this.restore()};m.prototype._applyFontformat=function(b,d,f){null!=d&&(void 0!=d["class"]&&b.addClass(d["class"]),void 0!=d.fontSize&&(f=parseInt(d.fontSize*f),b.css("font-size",f+"px")),void 0!=d.fontFamily&&(_.str.contains(d.fontFamily,'"')||_.str.contains(d.fontFamily,",")?b.css("font-family",d.fontFamily+", Roboto, Arial , sans-serif"):b.css("font-family",'"'+d.fontFamily+'", Roboto, Arial , sans-serif')),void 0!=d.fontWeight&&b.css("font-weight",d.fontWeight),
void 0!=d.fontStyle&&b.css("font-style",d.fontStyle))};m.prototype.stringToHtml=function(b){var d=[];b=b.split(/\n/);jQuery(document.createElement("div"));for(var f=0;f<b.length;f++)d.push(b[f]);return d.join("\x3cbr\x3e")};m.prototype.drawDivText=function(b,d,f,e,a,c,g,l,n,w,y){d=e;a=a.replace(RegExp("\r\n","g"),"\n");a=a.replace(RegExp("\r","g"),"\n");a=u(a);a=a.replace(RegExp("  ","g")," \x26nbsp;");a=this.stringToHtml(a);e=$(this.dscratchpad);e.css({});e.css({visibility:"hidden",position:"absolute",
height:"auto",width:"auto"});void 0!=w&&0<w&&(e.css("display","block"),e.css("width",w));this._applyFontformat(e,g,c);null!=n&&e.css("color",n);1==l?e.css("text-align","center"):2==l?e.css("text-align","right"):e.css("text-align","left");f=[];$(this.dscratchpad).css("word-wrap","break-word");$(this.dscratchpad).html(a);e=$(this.dscratchpad).get(0).getBoundingClientRect();f[0]=Math.ceil(e.width);f[1]=Math.ceil(e.height);var h=0;if(_.has(g,"h")&&0<g.h){h=parseInt($(this.dscratchpad).css("font-size").replace("font-size"));
for(var r=!0;g.h<f[1]&&r;)4<h?(--h,$(this.dscratchpad).css("font-size",h+"px"),e=$(this.dscratchpad).get(0).getBoundingClientRect(),f[0]=Math.ceil(e.width),f[1]=Math.ceil(e.height)):r=!1}$(this.dscratchpad).empty();$(this.dscratchpad).css("word-wrap","normal");e=$(d);e.css("word-wrap","break-word");this._applyFontformat(e,g,c);0<h&&e.css("font-size",h+"px");null!=n&&e.css("color",n);1==l?e.css("text-align","center"):2==l?e.css("text-align","right"):e.css("text-align","left");0<=w&&(e.width(f[0]),
e.height(f[1]));e.html(a);null!=y&&""!=y&&(e.off("click"),e.click(function(){SB4API.linkLib.handleLinkData(b,y)}));f.push(!1);y&&(e.removeClass("notouch"),e.addClass("cursor_pointer"));return f};m.prototype.drawDivRichText=function(b,d,f,e,a,c,g,l,n,w){e=$(e);g&&this._applyFontformat(e,g,c);e.html(a);0<$("a",e).length&&(e.removeClass("notouch"),$("a",e).each(function(){var y=$(this).attr("href");if(_.string.startsWith(y,"evt://"))$(this).removeAttr("onclick"),$(this).click(function(t){t.preventDefault();
if(t=$(this).attr("href")){t=t.split("::");if(void 0!=t[2]&&""!=t[2]){var C=t[2].split(",");void 0==t[0]&&(t[0]="");void 0==t[1]&&(t[1]="");t[1]=_.string.trim(C[0]," '");C=C.splice(1);t[2]=_.string.trim(C.join()," '")}SB4API.linkLib.openHyperLink(b,t[0],t[1],t[2])}});else{y=$(this).attr("onclick");var h=void 0,r=$(this).attr("target");if(_.str.startsWith(y,"window.open(this.href")){var v=y.split(",",3);null!=v&&3==v.length&&(r=v[1],r=_.string.trim(r," '"),y=y.substring(v[0].length+v[1].length+2),
v=y.lastIndexOf("'"),h=y.substring(0,v),h=_.string.trim(h," '"))}$(this).removeAttr("onclick");$(this).click(function(t){t.preventDefault();t=$(this).attr("href");SB4API.linkLib.openHyperLink(b,t,r,h)})}}));e.css("width",w)};m.prototype.drawText=function(b,d,f,e,a,c,g,l,n,w,y,h,r){if(void 0==a||""==a)l=!1,a="";$(e).addClass("notouch");if(void 0!=l&&1!=l)return g?this.drawDivRichText(b,d,f,e,a,c,n,w,y,h):this.drawDivText(b,d,f,e,a,c,n,w,y,h,r);l=d+"."+f;this.ctx.clear();var v=void 0;this.textReg&&
(v=this.getTextRegData(l));if(!v||0==_.size(v.chars))return g?this.drawDivRichText(b,d,f,e,a,c,n,w,y,h):this.drawDivText(b,d,f,e,a,c,n,w,y,h,r);a=this.feelText(v,c);this.ctx.canvas.width=a[0];this.ctx.canvas.height=a[1];var t=this.drawTextByCode(l,c,y,r);c=$("canvas:first-child",e);0==c.length?(c=document.createElement("canvas"),$(e).append(c)):c=c[0];c.id=d+"."+f;c.width=a[0];c.height=a[1];$(c).addClass("notouch");10>c.height&&$(c).addClass("text");c.getContext("2d").drawImage(this.ctx.canvas,0,
0);var C=this.glyphReg.linkData;_.isEmpty(C)&&null!=r&&(C=r);!_.isEmpty(C)&&0<t.length&&($(e).removeClass("notouch"),$(c).removeClass("notouch"),d=null,null!=r?($(e).addClass("cursor_pointer"),d=function(B){1!=B.which&&"mousemove"!=B.type||"mousemove"==B.type||void 0==_.find(t,function(A){return B.offsetX>=A[0]&&B.offsetX<=A[2]&&B.offsetY>=A[1]&&B.offsetY<=A[3]})||SB4API.linkLib.handleLinkData(b,r)}):d=function(B){if(1==B.which||"mousemove"==B.type){var A=_.find(t,function(F){return B.offsetX>=F[0]&&
B.offsetX<=F[2]&&B.offsetY>=F[1]&&B.offsetY<=F[3]});if(void 0==A)$(e).removeClass("cursor_pointer");else if("mousemove"==B.type)$(e).addClass("cursor_pointer");else if(A=C[A[4]],void 0!=A){A=A.split("::");if(void 0!=A[2]&&""!=A[2]){var E=A[2].split(",");void 0==A[0]&&(A[0]="");void 0==A[1]&&(A[1]="");A[1]=_.string.trim(E[0]," '");E=E.splice(1);A[2]=_.string.trim(E.join()," '")}SB4API.linkLib.openHyperLink(b,A[0],A[1],A[2])}}},c.addEventListener("click",d,!1),c.addEventListener("mousemove",d,!1));
return a};m.prototype.thinStroke=function(b){return b};m.prototype.drawGlyph=function(b,d,f,e,a,c){for(var g=this.getGlyphData(b),l=g.length,n=0,w=0;w<l;w++){b=g[w];switch(b.o){case 1:var y=a*b.d[0]+f,h=c*b.d[1]+e;y=this.thinStroke(y);h=this.thinStroke(h);d.moveTo(y,h);break;case 2:y=a*b.d[0]+f;h=c*b.d[1]+e;y=this.thinStroke(y);h=this.thinStroke(h);d.lineTo(y,h);break;case 3:d.bezierCurveTo(a*b.d[0]+f,c*b.d[1]+e,a*b.d[2]+f,c*b.d[3]+e,a*b.d[4]+f,c*b.d[5]+e);n=Math.max(n,c*b.d[5]+e);break;case 4:d.closePath()}0<
b.o&&4!=b.o&&null==b.d&&console.log("unexpected stroke data",b);0<b.o&&null!=b.d&&(n=Math.max(n,c*b.d[1]+e))}return n};m.prototype.getGlyphData=function(b){var d=this.glyphReg.data[b];void 0==d&&(d=[]);if(d instanceof Array)return d;d=d.split(",");for(var f=[],e=0;e<d.length;e++){var a=d[e],c={};c.o=0==a.length%6?2:parseInt(a.substring(0,1),10);c.d=[];a=0==a.length%6?a:a.substring(1);if(0<a.length)for(var g=a.length/6,l=0;l<g;l++){var n=a.substring(6*l,6*(l+1)),w=(this.revertDate(this.clearChars(n.substring(0,
3)))/10).toString();n=(this.revertDate(this.clearChars(n.substring(3,6)))/10).toString();c.d.push(w,n)}f.push(c)}this.glyphReg.data[b]=f;return this.glyphReg.data[b]};m.prototype.revertDate=function(b){if(1<b.length){var d=parseInt(b,36);0==parseInt(b.charAt(0),36)?d=parseInt(b.substring(1),36):(b=this.isPositive(d),d=-1==b.positive?-1*(Math.pow(36,b.digit)-d):d)}else d=parseInt(b,36),18<d&&(d=-1*(36-d));return d};m.prototype.isPositive=function(b){var d={},f=0,e=0,a=18*Math.pow(36,f),c=Math.pow(36,
f+1);do b>=e&&b<=a?d.positive=1:b>a&&b<c&&(d.positive=-1),f++,e=Math.pow(36,f),a=18*Math.pow(36,f)-1,c=Math.pow(36,f+1);while(b>=e);0==d.positive&&console.log("error "+b);d.digit=f;return d};m.prototype.clearChars=function(b){for(;1<b.length&&"#"==b.charAt(0);)b=b.substring(1);return b};m.prototype.getTextRegData=function(b){var d=this.textReg[b];if(void 0!=d){if(null!=d.refid&&(b="@"+d.refid,d=this.textReg[b],void 0==d))return;if("object"==typeof d&&d.chars instanceof Array)return d;var f={},e=[];
var a=_.str.isBlank(d.chars)?[]:d.chars.split(",");for(var c=-1,g=-1,l=-1,n=0;n<a.length;n++){var w={},y=a[n].split("|"),h={};4==y[0].length?(w.mode=0,h.width=parseInt(y[0].substring(0,2),36),h.height=parseInt(y[0].substring(2,4),36)):(w.mode=parseInt(y[0].charAt(0)),h.width=parseInt(y[0].substring(1,3),36),h.height=parseInt(y[0].substring(3,5),36));w.size=h;h={};h.x=this.revertDate(y[1]);h.y=this.revertDate(y[2]);w.pos=h;"0"==y[3]?l=-1:""==y[3]?-1!=l&&(w.link=l):(l=y[3],w.link=l);""!=y[4]&&(c=y[4]);
w.color=c;w.vectorCode=y[5];7==y.length&&(""!=y[6]&&(g=y[6]),w.bgcolor=g);e.push(w)}f.chars=e;f.size=d.size;this.textReg[b]=f;return this.textReg[b]}};m.prototype.drawTextByCode=function(b,d,f,e){null==d&&(d=1);var a=void 0,c=[];if(b=this.getTextRegData(b)){for(var g=0;g<b.chars.length;g++){var l=b.chars[g],n=l.vectorCode,w=this.getGlyphData(n),y=null;0<w.length&&0==w[0].o&&(y=w[0].d);void 0!=f?a=f.toString():void 0!=l.color&&(a=this.glyphReg.colorData[l.color],a=this.hex2RGBA(a));null!=y&&(this.ctx.beginPath(),
l.bgcolor&&(w=this.glyphReg.colorData[l.bgcolor],w=this.hex2RGBA(w),this.ctx.fillStyle=w,this.ctx.fillRect(l.pos.x,l.pos.y,l.size.width,l.size.height)),this.ctx.beginPath(),this.ctx.fillStyle=a,this.drawGlyph(n,this.ctx,l.pos.x*d,l.pos.y*d,l.size.width/y[0]*d,l.size.height/y[1]*d),this.ctx.fill());if(void 0!=l.mode)switch(l.mode){case 1:this.ctx.beginPath();this.ctx.arc(l.pos.x,l.pos.y,l.size.width/2,0,2*Math.PI,!0);this.ctx.fillStyle=a;this.ctx.fill();this.ctx.closePath();break;case 9:this.ctx.beginPath(),
this.ctx.moveTo(l.pos.x,l.pos.y),this.ctx.lineTo(l.pos.x+l.size.width,l.pos.y),this.ctx.stroke(),this.ctx.closePath()}void 0!=e&&""!=e?c.push([l.pos.x,l.pos.y,l.pos.x+l.size.width,l.pos.y+l.size.height,e]):void 0!=l.link&&c.push([l.pos.x,l.pos.y,l.pos.x+l.size.width,l.pos.y+l.size.height,l.link])}return c}};m.prototype.feelText=function(b,d){void 0==d&&(d=1);var f=[0,0],e=!0;b.size&&(f[0]=b.size.width,0<=b.size.width&&(e=!1));for(var a=0;a<b.chars.length;a++){var c=b.chars[a],g=this.getGlyphData(c.vectorCode);
if(0!=g.length){var l=null;0==g[0].o&&(l=g[0].d);null!=l&&(g=c.pos.x+c.size.width,c=c.pos.y+c.size.height,e&&g>f[0]&&(f[0]=g),c>f[1]&&(f[1]=c))}}f[0]*=d;f[1]*=d;return f};m.prototype.hex2RGBA=function(b){if(void 0==b)return"rgba(0, 0, 0, 0)";var d="rgba(0, 0, 0, 0)";if(6==b.length)d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b),d={r:parseInt(d[1],16),g:parseInt(d[2],16),b:parseInt(d[3],16),a:255};else if(8==b.length)d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b),d={r:parseInt(d[1],
16),g:parseInt(d[2],16),b:parseInt(d[3],16),a:parseInt(d[4],16)};else return d;return"rgba("+d.r+","+d.g+","+d.b+","+d.a/255+")"};var q=document.createElement("div");q.id="textLibDiv";$(q).css("display","none");var p=document.createElement("canvas");p.id="textLibCanvas";p.width=2E3;p.height=2E3;p.style="border:0px solid #ffffff;";q.appendChild(p);document.body.appendChild(q);q=document.createElement("div");q.id="divTextDiv";$(q).css({visibility:"hidden",position:"absolute",height:"auto",width:"auto"});
document.body.appendChild(q);p=document.getElementById("textLibCanvas");return new m({},{},p,q)});
define("sb4core/SB4Debug",["sb4core/DataUtil"],function(m){function u(q){this.loEngine=q;this.breakPoint=!1;this.objctx=null}u.prototype.getDebugInfo=function(){var q=_.clone(this.loEngine).subEngines[0],p=_.clone(q.objctx.get("_frame")),b=p.scene,d={};d.engine=this.getDebugEngine(p.sceneLocalEngine);d.folders=this.getSlideSets(p,q);p={};p["Page:["+b.name+"]"]=d;p["Global Variables"]=this.getGlobalVars(q);p["Local Variables"]=this.getLocalVars(this.objctx);p.Maps=SB4API.rootContext.getObjMap();return m.stringifyStageJsonModel(p)};
u.prototype.getDebugEngine=function(q){var p={};p.id=q.id;p.status=q.status;p.lastParsedEvents=q.lastParsedEventQueue;p.lastBlockResults=q.lastBlockResultQueue;return p};u.prototype.getGlobalVars=function(q){var p={},b=q.objctx.map;q=_.keys(q.objctx.map);_.each(q,function(d,f){0==d.indexOf("global ")&&(f=b[d],"boolean"===typeof f?p[d]=1==f?!0:!1:0==isNaN(f)?p[d]=f:p[d]=b[d]?b[d]:"[undefined]")});return p};u.prototype.getLocalVars=function(q){var p={};null==q||_.has(q.map,"[ctx_type]")||(void 0!=q.extctx&&
(p=_.extend(this.getLocalVars(q.extctx),p)),p=_.extend(p,q.map));return p};u.prototype.getSlideSets=function(q,p){var b=this,d=[],f=q.scene,e=_.indexBy(f.layers,"id"),a=q.mastermap;_.each(f.slides,function(c,g){var l=m.trimRefString(c.$ref);e[l]?(g=e[l],c="L: "+g.name,g=b.parseSlideSet(e[l],q.sceneLocalEngine)):(g=a[l],c="M: "+g.name,g=b.parseSlideSet(a[l],p.getSubEngineByID(l)),g.engine=b.getDebugEngine(p.getSubEngineByID(l)));l={};l[c]=g;d.push(l)});return d};u.prototype.parseSlideSet=function(q,
p){q=m.stringifyStageJsonModel(q);q=JSON.parse(q);_.has(q,"slides")&&(q.layers=_.map(q.slides,function(b){var d={};_.has(b,"widgets")&&(b.widgets=_.map(b.widgets,function(f){null==p.objctx.get(f.id)&&(f["._error"]=!0);var e={};e[f.name]=_.pick(f,"id","type","._error");return e}));d[b.name]=_.pick(b,"widgets");return d}));return _.pick(q,"layers")};u.prototype.onBreakPoint=function(q,p){this.onBreakPointExt&&(this.breakPoint=!0,this.objctx=p,this.loEngine.stop(!1),q.info=this.getDebugInfo(),this.onBreakPointExt(m.stringifyStageJsonModel(q)))};
u.prototype.start=function(){this.breakPoint=!1;this.objctx=null;this.loEngine.start()};return u});
(function(m,u){"function"===typeof define&&define.amd?define("sb4core/sbaction-config",[],u):m.sb4actionconfig=u(m.b)})("undefined"!==typeof self?self:this,function(m){return{_OBJECT_KEY:{MOVE_TIME:"_CONF_md",LAYOUT_TIME:"_CONF_me",EFFECT_TIME:"_CONF_ed",EXIT_MSG:"_CONF_exit.msg",EXIT_URL:"_CONF_exit.url",XAPI_CONTEXT:"_CONF_xapi.context",CSS_FILTER_BLUR:"_CONF_cssblur",CSS_FILTER_GRAYSCALE:"_CONF_cssgrayscale",CSS_FILTER_INVERT:"_CONF_cssinvert",CSS_FILTER_OPACITY:"_CONF_cssopacity",CSS_FILTER_BRIGHTNESS:"_CONF_cssbrightness",
CSS_FILTER_CONTRAST:"_CONF_csscontrast",CSS_FILTER_SATURATE:"_CONF_csssaturate",CSS_FILTER_SEPIA:"_CONF_csssepia",DND_LAYOUT:"_CONF_dnd.layout",Q_PATH:"_CONF_qpath"},blk_conf:[["move duration (ms)","md",1E3],["move easing","me","linear"],["effect duration (ms)","ed",1E3],["lesson exit message","exit.msg","You may close your browser"],["lesson exit url","exit.url","https://example.com"],["xapi context","xapi.context",'{"instructor":{"name":"John","mbox":"mailto:a@example.com"}}'],["filter blur","cssblur",
5],["filter grayscale","cssgrayscale",100],["filter invert","cssinvert",100],["filter opacity","cssopacity",50],["filter brightness","cssbrightness",150],["filter contrast","csscontrast",150],["filter saturate","csssaturate",150],["filter sepia","csssepia",100],["ajax credential","ajax.credential",!0],["DnD layout duration (lesson)","dnd.layout",100],["enforce qualified path","qpath",!1]]}});
define("sb4core/loplayer","underscore ./sbobjfactory sb4core/loloader sb4core/ObjContext sb4core/SB4Engine sb4core/textlib sb4core/SB4Debug sb4core/sbaction-config sb4core/ClassUtil".split(" "),function(m,u,q,p,b,d,f,e,a){SB4API.stageLog("loplayer init");return{factory:null,play:function(){$("#a508").on("focusout",function(){});SB4API.stageLog("loplayer play start");var c=m.find(q.lo.meta.entries,function(z){return"id"==z.id}),g="";null!=c&&(g=c.value);SB4API.tabOrder=m.find(q.lo.meta.entries,function(z){return"tabOrder"==
z.id}).value;SB4API.mediaAutoPlayAuthorization=m.find(q.lo.meta.entries,function(z){return"mediaAutoPlay"==z.id}).value;SB4API.disableEngineAddEvent=!1;SB4API.autoPlayList=[];SB4API.requestAutoplay=function(z,x){SB4API.isPlayButtonNotExist()?null===z?x():a.invoke(z,x,[]):SB4API.autoPlayList.push([z,x])};SB4API.isPlayButtonNotExist=function(){return 0===$("#playFull").length};var l=m.find(q.lo.meta.entries,function(z){return"scaling"==z.id}).value;SB4API.getOrientation=function(){var z=window.orientation;
if("number"==typeof z&&"object"==typeof window.onorientationchange)switch(z){case 90:case -90:z="landscape";break;default:z="portrait"}else z=window.innerWidth>window.innerHeight?"landscape":"portrait";return z};SB4API.isNewIPAD=function(){if(void 0==SB4API.newIPAD){var z=!1;navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints&&(z=!0);SB4API.newIPAD=z}return SB4API.newIPAD};SB4API.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},AndroidNonTablet:function(){return SB4API.isMobile.Android()&&
navigator.userAgent.match(/Mobile/i)&&!navigator.userAgent.match(/Kindle/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)||SB4API.isNewIPAD()},iPhone:function(){return navigator.userAgent.match(/iPhone/i)},iOSNonTablet:function(){return navigator.userAgent.match(/iPhone|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},
any:function(){return SB4API.isMobile.Android()||SB4API.isMobile.BlackBerry()||SB4API.isMobile.iOS()||SB4API.isMobile.Opera()||SB4API.isMobile.Windows()},anyPhone:function(){return SB4API.isMobile.AndroidNonTablet()||SB4API.isMobile.BlackBerry()||SB4API.isMobile.iOSNonTablet()||SB4API.isMobile.Opera()||SB4API.isMobile.Windows()}};c=m.find(q.lo.meta.entries,function(z){return"profile"==z.id});c=m.map(c.subs,function(z){var x=JSON.parse(z.value);x.id=z.id;x.hMap=m.omit(x.hMap,function(D,H,J){return 0==
D});return x});SB4API.profile={};SB4API.updateScale=function(z){if(SB4API.isMobile.any()){var x=document.querySelector('meta[name\x3d"viewport"]');var D=null!=SB4API.currentScene?SB4API.currentScene.id:SB4API.initSceneId?SB4API.initSceneId:q.lo.frame.flow.subflow.id;var H=z.h;m.has(z.hMap,D)&&(H=z.hMap[D]);"landscape"==SB4API.getOrientation()?(D=Math.max(screen.height,screen.width)/z.w,H=Math.min(screen.height,screen.width)/H):(D=screen.width/z.w,H=screen.height/H);D=0==l?D:Math.min(D,H);x.setAttribute("content",
"width\x3d"+z.w+", initial-scale\x3d"+D+",maximum-scale\x3d"+D+", minimum-scale\x3d"+D+" ,user-scalable\x3dno")}};SB4API.profile.selectProfile=function(){if(m.isArray(SB4API.currentViewport)){var z=SB4API.currentViewport[0];var x=SB4API.currentViewport[1]}else{var D=document.documentElement.getBoundingClientRect();z=D.width;x=D.height}if(SB4API.isMobile.any()){var H=[],J=[],N=[],P=[],O=[];m.each(SB4API.profile.list,function(I,K){"PHONE"==I.t?I.w>I.h?H.push(I):N.push(I):"TABLET"==I.t?I.w>I.h?J.push(I):
P.push(I):O.push(I)});D="landscape"==SB4API.getOrientation()?SB4API.isMobile.anyPhone()?0<H.length?H:0<J.length?J:O:0<J.length?J:O:SB4API.isMobile.anyPhone()?0<N.length?N:0<P.length?P:O:0<P.length?P:O;var L=m.filter(D,function(I){return I.w<=z}),R=0;m.each(L,function(I,K){I.w>R&&(R=I.w)});L=m.filter(L,function(I){return I.w==R});if(0==L.length)var Q=D[0];else 1==L.length?Q=L[0]:1<L.length&&(L=m.sortBy(L,function(I){return I.h}),Q=m.find(L.reverse(),function(I){return I.h<x}),null==Q&&(Q=m.last(L)))}else{O=
[];var U=[];m.each(SB4API.profile.list,function(I,K){"PC"==I.t?O.push(I):U.push(I)});L=m.filter(O,function(I){return I.w<=z});0==L.length&&(L=m.filter(U,function(I){return I.w<=z}));R=0;m.each(L,function(I,K){I.w>R&&(R=I.w)});L=m.filter(L,function(I){return I.w==R});0==L.length?Q=SB4API.profile.list[0]:1==L.length?Q=L[0]:1<L.length&&(L=m.sortBy(L,function(I){return I.h}),Q=m.find(L.reverse(),function(I){return I.h<x}),null==Q&&(Q=m.last(L)))}return Q};SB4API.profile.list=m.sortBy(c,function(z){return z.w});
if(SB4API.fixProfile)SB4API.profile.current=SB4API.fixProfile;else if("function"==typeof GetInitProfileIdFunction){var n=GetInitProfileIdFunction();if(c=m.find(SB4API.profile.list,function(z){return z.id==n}))SB4API.profile.current=c}null==SB4API.profile.current&&(SB4API.profile.current=SB4API.profile.selectProfile());var w=function(z,x){if(z){m.has(x,z.id)?z.time=x[z.id]:delete z.time;var D=z.flows;m.isArray(D)&&m.each(D,function(H,J){w(H,x)});w(z.subflow,x)}},y=m.throttle(function(z){SB4API.alignToBody(z&&
"scroll"==z.type);E._util.floatWidgetsPosition()},250,{leading:!1});SB4API.updateProfile=function(z){var x=SB4API.profile.current,D;if((D=m.isString(z)?m.find(SB4API.profile.list,function(J){return J.id==z}):SB4API.fixProfile?SB4API.fixProfile:SB4API.profile.selectProfile())&&x.id!=D.id){SB4API.disableEngineAddEvent=!0;SB4API.profile.current=D;w(E.options._d.flow,D.hMap);SB4API.showLoading();E.preloadResourcesBeforeChangeProfile();E.changeProfile(D);SB4API.hideLoading();SB4API.disableEngineAddEvent=
!1;x={broadcast:!1};x["[evtval]"]=D.d;for(var H=0;H<E.engine.subEngines.length;H++)E.engine.subEngines[H].addEvent("flow","pchange",x);"function"==typeof OnProfileChangeFunction&&OnProfileChangeFunction(D.id)}else y();0<$("#playButton").length&&(0==SB4API.mediaAutoPlayAuthorization?(x=$(".com_smartbuilder_axon_widget_frame").eq(0),D=document.documentElement.clientWidth>x.width()?parseInt((x.width()-$("#playButton").width())/2)+x.offset().left+"px":parseInt((document.documentElement.clientWidth-$("#playButton").width())/
2)+x.scrollLeft()+"px",x=document.documentElement.clientHeight>x.height()?parseInt((x.height()-$("#playButton").height())/2)+x.offset().top+"px":parseInt((document.documentElement.clientHeight-$("#playButton").height())/2)+x.scrollTop()+"px"):(D=parseInt((document.documentElement.clientWidth-$("#playButton").width())/2)+"px",x=parseInt((document.documentElement.clientHeight-$("#playButton").height())/2)+"px"),$("#playButton").css("left",D),$("#playButton").css("top",x))};"number"==typeof window.orientation&&
"object"==typeof window.onorientationchange?(c=m.throttle(SB4API.updateProfile,400,{leading:!1}),window.addEventListener("orientationchange",c,!1)):(c=m.throttle(SB4API.updateProfile,200,{leading:!1}),$(window).resize(c));q.lo.lib&&(assetmap=m.clone(q.lo.lib));SB4API.txtLib=d;SB4API.txtLib.glyphReg=q.text.glyphReg;SB4API.txtLib.textReg=q.text.textReg;var h=new p;SB4API.launchTime=$.now();SB4API.getDurationValue=function(){if(SB4API.launchTime){var z=$.now()-SB4API.launchTime;return 0<z?z/1E3:0}return-1};
SB4API.getPageDurationValue=function(){if(SB4API.pageLaunchTime){var z=$.now()-SB4API.pageLaunchTime;return 0<z?z/1E3:0}return-1};m.isObject(SB4API.lms)&&0<SB4API.lms.type&&(c=$.sb4.com_smartbuilder_axon_widget_data_track(),c.lmsEnable=!0,h.add("scorm",c));SB4API.xapi.tincan&&(c=$.sb4.com_smartbuilder_axon_widget_data_xapi(),c.xapiEnable=!0,h.add("xapi",c),SB4API.xapi.launchLesson(),$(document).one("click",function(){SB4API.xapi.attemptLesson()}));SB4API.terminateLMS=function(){var z=h.get("scorm");
null!=z&&z.terminate()};var r=assetmap.audios,v=assetmap.videos;0<r?(SB4API.audioCapable=!1,!0===SB4API.previewEmbed&&SB4API.setAudioCapable()):SB4API.audioCapable=!0;if(!0!==SB4API.previewEmbed&&(0<r||0<v)){c=$("\x3cdiv id\x3d'media'\x3e\x3c/div\x3e");c.hide();c.appendTo("body");var t=r;c=v;32<=t&&(t=32);32<=c&&(c=32);if("undefined"!==typeof window.orientation){for(v=0;v<t;v++)r=$("\x3caudio  src \x3d'"+SB4API.emptyMP3+"' class\x3d'audio-unused'\x3e\x3c/audio\x3e"),r.appendTo("#media");for(v=0;v<
c;v++)t=$("\x3cvideo src \x3d'"+SB4API.emptyMP4+"' class\x3d'video-unused'\x3e\x3c/video\x3e"),t.appendTo("#media")}else 0<r&&(r=$("\x3caudio  src \x3d'"+SB4API.emptyMP3+"' class\x3d'audio-unused'\x3e\x3c/audio\x3e"),r.appendTo("#media")),0<v&&(t=$("\x3cvideo src \x3d'"+SB4API.emptyMP4+"' class\x3d'video-unused'\x3e\x3c/video\x3e"),t.appendTo("#media"));2==SB4API.mediaAutoPlayAuthorization?($(document).one("click",function(){$.each($("audio"),function(z,x){x.load()});SB4API.setAudioCapable();$.each($("video"),
function(z,x){$(x).hasClass("video-unused")&&x.setAttribute("src","");x.load()});"undefined"===typeof window.orientation&&$("#media").empty()}),$("#playFull").remove()):1==SB4API.mediaAutoPlayAuthorization&&$(document).ready(function(){SB4API.playButtonBackgroundColor&&$("#playFull").css("background-color",SB4API.playButtonBackgroundColor);$("#playFull").show();var z=0;1==SB4API.tabOrder&&(z=1);$("#playFull").html('\x3cdiv id\x3d"playButton" style\x3d"width: 150px;height: 150px;position:absolute;"\x3e\x3cdiv class\x3d"notouch" style\x3d"width: 100%; height: 100%; position: absolute"\x3e\x3cbutton tabindex\x3d"'+
z+'" class\x3d"" style\x3d"width: 100%; height: 100%;border: none; background-color: rgba(255,255,255,0);" aria-label\x3d"Authorize media to autoplay."\x3e\x3c/button\x3e\x3c/div\x3e\x3csvg version\x3d"1.1" id\x3d"Layer_1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink" x\x3d"0px" y\x3d"0px"\t width\x3d"150px" height\x3d"150px" viewBox\x3d"0 0 92 92" enable-background\x3d"new 0 0 92 92" xml:space\x3d"preserve"\x3e\x3cg\x3e\t\x3cpath fill\x3d"#6B6B6B" d\x3d"M46,8c20.953,0,38,17.047,38,38S66.953,84,46,84C25.047,84,8,66.953,8,46S25.047,8,46,8 M46,1\t\tC21.147,1,1,21.147,1,46c0,24.854,20.147,45,45,45c24.851,0,45-20.146,45-45C91,21.147,70.852,1,46,1L46,1z"/\x3e\t\x3cpath fill\x3d"#6B6B6B" d\x3d"M38.167,25.147c-0.368,0-0.736,0.085-1.077,0.257c-0.802,0.406-1.309,1.229-1.309,2.129v37.725\t\tc0,0.899,0.506,1.723,1.309,2.129c0.34,0.172,0.71,0.257,1.077,0.257c0.5,0,0.996-0.156,1.414-0.463l25.667-18.863\t\tc0.611-0.45,0.973-1.164,0.973-1.923c0-0.759-0.361-1.473-0.973-1.923L39.58,25.61C39.163,25.304,38.666,25.147,38.167,25.147\t\tL38.167,25.147z"/\x3e\x3c/g\x3e\x3c/svg\x3e\x3c/div\x3e');
z=parseInt((document.documentElement.clientWidth-$("#playButton").width())/2)+"px";var x=parseInt((document.documentElement.clientHeight-$("#playButton").height())/2)+"px";$("#playButton").css("left",z);$("#playButton").css("top",x);$("#playFull").on("click",function(){$.each($("audio"),function(J,N){N.load()});SB4API.setAudioCapable();$.each($("video"),function(J,N){N.setAttribute("src","");N.load()});"undefined"===typeof window.orientation&&$("#media").empty();var D=B.subEngines[0].objctx.get("_frame"),
H=D.objctx.get("playFull_scene");$("#playFull").remove();D._renderScene(H);D.objctx.remove("playFull_scene")})})}else $("#playFull").remove();$(document).ready(function(){if(m.isObject(SB4API.lms)&&0<SB4API.lms.type)$(window).on("beforeunload",function(){SB4API.showErrorMessage=!1;"closed"!=SB4API.STATUS&&SB4API.terminateLMS()})});0==m.find(q.lo.meta.entries,function(z){return"bgchoice"==z.id}).value?(t=m.find(q.lo.meta.entries,function(z){return"bgcolor"==z.id}),null!=t.cid?$("body").css("background-color",
"#"+t.cid):(c=null!=t.R?t.R:0,v=null!=t.G?t.G:0,t=null!=t.B?t.B:0,$("body").css("background-color","rgb("+c+","+v+","+t+")"))):(c=m.find(q.lo.meta.entries,function(z){return"bgimage"==z.id}),0===m.find(q.lo.meta.entries,function(z){return"bgmode"==z.id}).value?($("body").css("background","url("+SB4API.util.getWidgetAssetURI(c.key)+")  no-repeat center center fixed"),$("body").css("background-size","cover")):($("body").css("background-image","url("+SB4API.util.getWidgetAssetURI(c.key)+")"),$("body").css("background-repeat",
"repeat")));SB4API.rootContext=h;SB4API._OBJECT_KEY=m.extend(SB4API._OBJECT_KEY,e._OBJECT_KEY);var C=m.values(SB4API._OBJECT_KEY);m.each(e.blk_conf,function(z,x){x=SB4API._OBJECT_KEY.CONFIG_BLOCK_OBJECT_KEY_PREFIX+z[1];SB4API.rootContext.add(x,z[2]);m.contains(C,x)||(SB4API._OBJECT_KEY[x]=x)});var B=new b(g,null,h);B.objctx.add("[ctx_type]","lo");this.factory=new u(B);SB4API.initSceneId&&(g={eClass:"StrData",id:"selectedScene"},g.value=SB4API.initSceneId,q.lo.frame.data.entries.push(g));var A=this.factory._createObjDiv($("#playerstage"));
$(A).css("visibility","hidden");SB4API.isLTR||$(A).prop("dir","auto");g=q.lo.frame;g.bounds.w=SB4API.profile.current.w;g.bounds.h=SB4API.profile.current.h;w(g.flow,SB4API.profile.current.hMap);g=this.factory.create(A,g,null,"Frame");SB4API.isMobile.any()?(c=function(z){if(0<z.changedTouches.length){z=z.changedTouches[0];var x=$(A).position();SB4API.rootContext.add("[stageXY]",[Math.round(z.pageX-x.left),Math.round(z.pageY-x.top)])}},A.get(0).addEventListener("touchstart",c,!1),A.get(0).addEventListener("touchmove",
c,!1)):$(A).mousemove(function(z){var x=$(A).position();SB4API.rootContext.add("[stageXY]",[z.pageX-x.left,z.pageY-x.top])});SB4API.alignToBody=function(z){$("body").width()>=$(A).width()?$(A).css("left",parseInt(($("body").width()-$(A).width())/2)+"px"):($(A).css("left","0px"),z||(document.documentElement.scrollLeft=parseInt(($(A).width()-$("body").width())/2)));$(A).css("top","0px");E._util.floatWidgetsPosition();if(0<$("#playFull").length){var x=$(".com_smartbuilder_axon_widget_frame").eq(0);z=
document.documentElement.clientWidth>x.width()?parseInt((x.width()-$("#playButton").width())/2)+x.offset().left+"px":parseInt((document.documentElement.clientWidth-$("#playButton").width())/2)+x.scrollLeft()+"px";x=document.documentElement.clientHeight>x.height()?parseInt((x.height()-$("#playButton").height())/2)+x.offset().top+"px":parseInt((document.documentElement.clientHeight-$("#playButton").height())/2)+x.scrollTop()+"px";$("#playButton").css("left",z);$("#playButton").css("top",x)}};var E=
h.get(g.attr("id"));SB4API.alignToBody();"undefined"==typeof window.orientation&&(c=m.debounce(SB4API.alignToBody,300),$(window).resize(c));this.factory._activateObjDiv(A,void 0!=g);$(A).css("visibility","inherit");$("#a508").hasClass("sb4-need-focus")&&$("#a508").focus({preventScroll:!0});g=new f(B);SB4API.debug=g;DEBUG&&console.log("loplayer: started");$(document).keydown(function(z){if(SB4API.KEY_DOWN_YES){z.broadcast=!0;var x=SB4API.LEGACY_KEYMAP[z.key];void 0==x&&(x=z.key);E.onEngineEvent(B,
"key_d",x,z)}});$(document).keyup(function(z){if(SB4API.KEY_UP_YES){z.broadcast=!0;var x=SB4API.LEGACY_KEYMAP[z.key];void 0==x&&(x=z.key);E.onEngineEvent(B,"key_u",x,z)}});$("#lesson_begin").focus(function(){SB4TabOrder.current="begin";0!=m.size(SB4TabOrder.previousOrder)&&0==m.size(SB4TabOrder.nextOrder)&&(SB4TabOrder.nextOrder=SB4TabOrder.previousOrder.slice(0),SB4TabOrder.nextOrder=SB4TabOrder.nextOrder.reverse(),SB4TabOrder.previousOrder=[])});$("#lesson_end").focus(function(){SB4TabOrder.current=
"end";0==m.size(SB4TabOrder.previousOrder)&&0!=m.size(SB4TabOrder.nextOrder)&&(SB4TabOrder.previousOrder=SB4TabOrder.nextOrder.slice(0),SB4TabOrder.previousOrder=SB4TabOrder.previousOrder.reverse(),SB4TabOrder.nextOrder=[])});var F=$("#tab_previous"),G=$("#tab_next");G.focus(function(){if("end"==SB4TabOrder.current)F.triggerHandler("focus");else{SB4TabOrder.current="";if(""!=SB4TabOrder.focusElement){var z=SB4TabOrder.focusElement,x=E._util.getStageObjectInstanceByElement($("#"+z));x&&(x.setAccessibilityHidden(!0),
x.setTabIndex(-1));0<SB4TabOrder.previousOrder.length?SB4TabOrder.previousOrder.splice(0,0,z):SB4TabOrder.previousOrder.push(z)}for(z=!1;!z;)if(0<SB4TabOrder.nextOrder.length){x=SB4TabOrder.nextOrder.shift();var D=E._util.getStageObjectInstanceByElement($("#"+x));if(D){var H=D.getScreenReaderTabElement();H&&0<H.length&&(SB4TabOrder.focusElement=x,D.setAccessibilityHidden(!1),z=!0,setTimeout(function(){D.setFocus()},100))}z||(0<SB4TabOrder.previousOrder.length?SB4TabOrder.previousOrder.splice(0,0,
x):SB4TabOrder.previousOrder.push(x))}else SB4TabOrder.focusElement="",z=!0,setTimeout(function(){$("#lesson_end").focus()},100);$(this)}});F.focus(function(){if("begin"==SB4TabOrder.current)G.triggerHandler("focus");else{SB4TabOrder.current="";if(""!=SB4TabOrder.focusElement){var z=SB4TabOrder.focusElement,x=E._util.getStageObjectInstanceByElement($("#"+z));x&&(x.setAccessibilityHidden(!0),x.setTabIndex(-1));0<SB4TabOrder.nextOrder.length?SB4TabOrder.nextOrder.splice(0,0,z):SB4TabOrder.nextOrder.push(z)}for(z=
!1;!z;)if(0<SB4TabOrder.previousOrder.length){x=SB4TabOrder.previousOrder.shift();var D=E._util.getStageObjectInstanceByElement($("#"+x));if(D){var H=D.getScreenReaderTabElement();H&&0<H.length&&(SB4TabOrder.focusElement=x,z=!0,D.setAccessibilityHidden(!1),setTimeout(function(){D.setFocus()},100))}z||(0<SB4TabOrder.nextOrder.length?SB4TabOrder.nextOrder.splice(0,0,x):SB4TabOrder.nextOrder.push(x))}else SB4TabOrder.focusElement="",z=!0,setTimeout(function(){$("#lesson_begin").focus()},100);$(this)}})}}});
define("sb4core/syscheck",["sb4core/DataUtil","modernizr"],function(m){DEBUG&&console.log("syscheck started");Modernizr.cssBackgroundImageGradient=!0;var u=!1,q=window.navigator.userAgent;-1<q.indexOf("MSIE ")||q.match(/Trident.*rv:11\./)||-1<q.indexOf("Edge")?(u=!0,Modernizr.cssBackgroundImageGradient=!1):"Safari"===(-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Edg")?"Edge":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":
-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":"unknown")&&(q=(q=q.match(/version\/(\d+(\.?_?\d+)+)/i))&&0<q.length&&q[1]||"",q=_.str.contains(q,".")?q.split(".")[0]:q,m=m.parseInt(q),13>m&&0!=m&&(u=!0));Modernizr.oldBrowser=u;Modernizr.oldBrowser&&SB4API.handleError("Warning: outdated browser");SB4API.preferXHR=!1;u=[];Modernizr.svg||u.push("svg");Modernizr.canvas||u.push("canvas");
Modernizr.audio||u.push("audio");Modernizr.video||u.push("video");0<u.length&&SB4API.handleError("Warning: Your browser does not support the following required HTML5 features: "+u);return u});
(function(m,u){"function"===typeof define&&define.amd?define("lib/FileSaver.min",[],u):"undefined"!==typeof exports?u():(u(),m.FileSaver={})})(this,function(){function m(e,a){"undefined"===typeof a?a={autoBom:!1}:"object"!==typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a});return a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function u(e,a,c){var g=
new XMLHttpRequest;g.open("GET",e);g.responseType="blob";g.onload=function(){f(g.response,a,c)};g.onerror=function(){console.error("could not download file")};g.send()}function q(e){var a=new XMLHttpRequest;a.open("HEAD",e,!1);try{a.send()}catch(c){}return 200<=a.status&&299>=a.status}function p(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(c){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null);e.dispatchEvent(a)}}var b="object"===
typeof window&&window.window===window?window:"object"===typeof self&&self.self===self?self:"object"===typeof global&&global.global===global?global:void 0,d=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=b.saveAs||("object"!==typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(e,a,c){var g=b.URL||b.webkitURL,l=document.createElement("a");a=a||e.name||"download";l.download=a;l.rel="noopener";
"string"===typeof e?(l.href=e,l.origin!==location.origin?q(l.href)?u(e,a,c):p(l,l.target="_blank"):p(l)):(l.href=g.createObjectURL(e),setTimeout(function(){g.revokeObjectURL(l.href)},4E4),setTimeout(function(){p(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,c){a=a||e.name||"download";if("string"===typeof e)if(q(e))u(e,a,c);else{var g=document.createElement("a");g.href=e;g.target="_blank";setTimeout(function(){p(g)})}else navigator.msSaveOrOpenBlob(m(e,c),a)}:function(e,a,c,g){if(g=g||open("",
"_blank"))g.document.title=g.document.body.innerText="downloading...";if("string"===typeof e)return u(e,a,c);a="application/octet-stream"===e.type;c=/constructor/i.test(b.HTMLElement)||b.safari;var l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&c||d)&&"undefined"!==typeof FileReader){var n=new FileReader;n.onloadend=function(){var h=n.result;h=l?h:h.replace(/^data:[^;]*;/,"data:attachment/file;");g?g.location.href=h:location.href=h;g=null};n.readAsDataURL(e)}else{var w=b.URL||b.webkitURL,y=
w.createObjectURL(e);g?g.location=y:location.href=y;g=null;setTimeout(function(){w.revokeObjectURL(y)},4E4)}});b.saveAs=f.saveAs=f;"undefined"!==typeof module&&(module.exports=f)});
define("sb4core/linkhandler",[],function(){DEBUG&&console.log("linkhandler loaded");var m={generateWindowParam:function(u){var q="";if(null==u)return q;if(null!=u.w||null!=u.h)q="toolbar\x3dno,menubar\x3dno,fullscreen\x3dno,width\x3d"+parseInt(u.w)+",",q=q+"height\x3d"+parseInt(u.h)+",";return q},openHyperLink:function(u,q,p,b){if(void 0!=q&&""!=q)if(0==q.indexOf("evt://"))null!=u&&(p={},b=q.lastIndexOf(":"),5<b&&(p["[evtval]"]=q.substring(b+1),q=q.substring(0,b)),u.fireGlobalEvent(q,p));else{if(null==
p||""==p)p="_blank";if(SB4API._EMBEDDED)if($.notify("Open external URL("+q+") is not fully supported in authoring preview mode.","warn"),"_self"!=p){if("ok"===SB4WindowHandlerFunction("open",q))return}else if(0!=q.toUpperCase().indexOf("HTTP://")&&0!=q.toUpperCase().indexOf("HTTPS://"))return;return null!=b&&""!=b?SB4API.openWindow(q,p,b):SB4API.openWindow(q,p)}},handleLinkData:function(u,q){if(_.isObject(q)){var p=[];p[0]=q.link;if(!_.string.isBlank(p[0]))if(null!=q.subs){p=q.subs[0].t;var b=q.subs[1].o;
_.string.isBlank(b)||(b=b.split(","),p=_.string.trim(b[0]," '"),b=b.splice(1),b=_.string.trim(b.join()," '"));this.openHyperLink(u,q.link,p,b)}else this.linkLib.openHyperLink(u,q.link,"","")}}};return SB4API.linkLib=m});
define("widgets/com.smartbuilder.axon.widget.frame/timeline",["jquery","underscore","sb4core/Logger","sb4core/DataUtil"],function(m,u,q,p){function b(d,f){this.engine=d;this.maxWaitCount=20;this.waitAudioCount=this.waitCount=0;this.maxWaitAudioCount=10;this.gotoTimer=-1;this.time=this.endTime=0;this.timer=-1;this.points=[];this.tick=50;this.data=f?JSON.parse(f):{};this.ascStartTimeWgts=[];this.ascEndTimeWgts=[];this.lastTickTime=this.nextEndTime=this.nextStartTime=-1;this.activeWgts={};this.logger=
new q("timeline",function(){return q.getDefaultPrefix()+" timeline "});this.status=this.STATUS_IDLE;this.refAudio=void 0;this._init()}b.prototype.STATUS_DEAD="dead";b.prototype.STATUS_STOP="stop";b.prototype.STATUS_PROCESS="process";b.prototype.STATUS_IDLE="idle";b.prototype._init=function(){this.logger._debug("init ... ");if(u.isEmpty(this.data))this.logger._warn("timeline not data"),this.play("destroy");else{this.endTime=this.data.endTime;this._createPoints(this.data._qPoint,0);var d=this._parseData(this.data._children);
this.data.wgts=d;0<this.data.wgts.length&&(this._parseAscStartTimeWgts(this.data.wgts,0),this._parseAscEndTimeWgts(this.data.wgts,0));this._modifyNextStartTime();this._modifyNextEndTime();m.each(d,function(f,e){e.obj._timelineStop(!1)});this.logger._debug("init  ok ")}};b.prototype._parseData=function(d){var f=[],e=this;m.each(d,function(a,c){m.each(c.ranges,function(g,l){g={};g.id=c.id;g.obj=e.getWgtByID(g.id);g.start=l.start;g.end=l.end;"com.smartbuilder.axon.widget.audio"!=g.obj.options._d.type||
u.string.isBlank(g.obj.src)?g.isAudio=!1:g.isAudio=!0;g.isFixToEnd=1==l.isFixToEnd?l.isFixToEnd:g.end==e.endTime?!0:!1;g.obj&&f.push(g)})});return f};b.prototype._createPoints=function(d,f){var e=[];u.isArray(d)&&0<d.length&&(m.each(d,function(a,c){c.time>=f&&e.push(c)}),this.points=u.sortBy(e,function(a){return a.time}))};b.prototype._parseAscStartTimeWgts=function(d,f){d=u.filter(d,function(e){return e.start>=f});d=u.sortBy(d,function(e){return e.start});d=u.groupBy(d,function(e){return e.start});
this.ascStartTimeWgts=u.values(d)};b.prototype._parseAscEndTimeWgts=function(d,f){d=u.filter(d,function(e){return!e.isFixToEnd});d=u.sortBy(d,function(e){return e.start});d=u.sortBy(d,function(e){return e.end});d=u.groupBy(d,function(e){return e.end});this.ascEndTimeWgts=u.values(d)};b.prototype._timelineGoto=function(d){this._timelineStop(!0);d=p.parseNumber(d);0>d&&(d=0);this.time=d=100*Math.floor(10*d);this._createPoints(this.data._qPoint,d);0<this.data.wgts.length&&(this._parseAscStartTimeWgts(this.data.wgts,
d),this._parseAscEndTimeWgts(this.data.wgts,d));this._modifyNextStartTime();this._modifyNextEndTime();this._updateActiveWgts(d);var f=this;f._clearRefAudio();m.each(u.values(this.activeWgts),function(e,a){if(a.isAudio)return f.refAudio=a,!1});clearInterval(this.gotoTimer);this.gotoTimer=setInterval(function(){f._processGoto()},this.tick)};b.prototype._timelinePlay=function(){if(!(0<this.timer||u.isEmpty(this.data))){this.logger._debug("play ");this.status=this.STATUS_PROCESS;var d=this;this.lastTickTime=
m.now();var f=u.values(this.activeWgts);0<f.length&&m.each(f,function(e,a){a.obj._timelineGoto(d.time-a.start);a.obj._timelinePlay()});this._process();this.timer=setInterval(function(){d._process()},this.tick)}};b.prototype._process=function(){var d=this;0<this.points.length&&this.time>=this.points[0].time&&(this.engine.addEvent("timeline",this.points[0].index,{broadcast:!0}),this.points.shift());if(this.time>this.endTime)this._timelineStop(!1),this.engine.addEvent("timeline","end",{broadcast:!0});
else{var f=!0;if(-1!=this.nextEndTime&&this.time>=this.nextEndTime&&0<this.ascEndTimeWgts.length){var e=this.ascEndTimeWgts.shift();u.isArray(e)&&(m.each(e,function(l,n){void 0!=d.activeWgts[n.id]&&(n.obj._timelineStop(!1),delete d.activeWgts[n.id],d.refAudio&&d.refAudio.id==n.id&&d._clearRefAudio())}),this._modifyNextEndTime())}e=m.now();var a=this.time+e-this.lastTickTime;if(-1!=this.nextStartTime&&this.time>=this.nextStartTime&&0<this.ascStartTimeWgts.length){this.logger._debug("correction time "+
this.time+" to "+this.nextStartTime);this.time=this.nextStartTime;e=this.ascStartTimeWgts[0];e=e.concat(u.values(this.activeWgts));var c=!1;void 0==this.refAudio&&m.each(e,function(l,n){if(n.isAudio)return d.refAudio=n,c=!0,!1});if(u.isArray(e)){if(c){var g=e.length;m.each(e,function(l,n){u.contains(u.keys(d.activeWgts),n.id)?n.obj._timelineStop(!0):n.obj._timelineStop(!1);n.obj._timelineGoto(d.time-n.start)&&g--;n.obj._timelineGoto(d.time-n.start)});this.waitAudioCount++;this.waitAudioCount>this.maxWaitAudioCount&&
(g=0)}else e=u.without(e,this.refAudio),g=e.length,m.each(e,function(l,n){n.obj._timelineGoto(d.time-n.start);g--});0==g?(this.waitAudioCount=0,this.ascStartTimeWgts.shift(),m.each(e,function(l,n){u.contains(u.keys(d.activeWgts),n.id)||(d.activeWgts[n.id]=n);n.obj._timelinePlay()}),this.lastTickTime=m.now(),this._modifyNextStartTime(),this.time=a):(f=!1,c&&d._clearRefAudio())}}f?this._addTime():this.lastTickTime=m.now()}};b.prototype._timelineStop=function(d){this.logger._debug("stop ... ");clearInterval(this.timer);
clearInterval(this.gotoTimer);this.gotoTimer=this.timer=-1;if(this.status!=this.STATUS_STOP){this.status=this.STATUS_STOP;0!=this.time&&(d?this._addTime():this.time=this.endTime+this.tick);var f=this;if(u.isObject(this.activeWgts)){var e=u.values(this.activeWgts);0<e.length&&m.each(e,function(a,c){!d&&c.isFixToEnd?c.obj._timelineStop(!0,f.time-c.start,d):c.obj._timelineStop(d,f.time-c.start,d)})}d||(this.activeWgts={});this.logger._debug("stop ok ")}};b.prototype._destroy=function(){this._timelineStop(!1);
this.status=this.STATUS_DEAD;this.engine=void 0;this.waitCount=0;this.gotoTimer=-1;this.time=this.endTime=0;this.timer=-1;this.ascEndTimeWgts=this.ascStartTimeWgts=this.data=this.points=void 0;this.lastTickTime=this.nextEndTime=this.nextStartTime=-1;this.refAudio=this.activeWgts=void 0;this.logger._debug("destroy")};b.prototype._addTime=function(){if(void 0==this.refAudio){var d=m.now();this.time+=d-this.lastTickTime;this.lastTickTime=d}else d=Math.floor(1E3*this.refAudio.obj.getCurrentTime()+this.refAudio.start),
this.time==d&&this.time+100>=this.refAudio.end?this.time=d+100:0!=d&&(this.time=d),this.lastTickTime=m.now();this.logger._debug("time is "+this.time+"ms")};b.prototype._modifyNextStartTime=function(){this.nextStartTime=0<this.ascStartTimeWgts.length?this.ascStartTimeWgts[0][0].start:-1;this.logger._debug("next start time is "+this.nextStartTime+"ms")};b.prototype._modifyNextEndTime=function(){this.nextEndTime=0<this.ascEndTimeWgts.length?this.ascEndTimeWgts[0][0].end:-1;this.logger._debug("next end time is "+
this.nextEndTime+"ms")};b.prototype._updateActiveWgts=function(d){var f=this;f.activeWgts={};m.each(this.data.wgts,function(e,a){d>=a.start&&d<=a.end?f.activeWgts[a.id]=a:a.obj._timelineStop(!1)})};b.prototype._processGoto=function(){var d=this,f=u.values(this.activeWgts),e=f.length;m.each(f,function(a,c){c.obj._timelineStop(!0);c.obj._timelineGoto(d.time-c.start)&&e--});0==e?(m.each(f,function(a,c){c.obj._timelinePlay()}),this.waitCount=0,clearInterval(this.gotoTimer),this.gotoTimer=-1,this.play("play")):
this.waitCount>this.maxWaitCount?(clearInterval(this.gotoTimer),this.gotoTimer=-1,this.play("play")):this.waitCount++};b.prototype.play=function(d){"play"==d?this._timelinePlay():"stop"==d?this._timelineStop(!0):this._destroy()};b.prototype.getWgtByID=function(d){return this.engine.getWgtByID(d)};b.prototype.getStatus=function(){return this.status};b.prototype.getTime=function(){return this.time>this.endTime?this.endTime:this.time};b.prototype.isAutoPlay=function(){return this.data&&!1===this.data.autoplay?
!1:!0};b.prototype._clearRefAudio=function(){this.refAudio=void 0};b.prototype.getCurrentTime=function(){return this.time};b.prototype.getEndTime=function(){return this.endTime};return b});
define("wgt/com.smartbuilder.axon.widget.frame/s","module sb4core/sbobj sb4core/sbobjfactory sb4core/DataUtil underscore sb4core/ObjContext sb4core/SB4Engine sb4core/SB4Decode sb4core/data widgets/com.smartbuilder.axon.widget.frame/timeline sb4core/ClassUtil underscore_str".split(" "),function(m,u,q,p,b,d,f,e,a,c,g){function l(h){"function"!==typeof window.CustomEvent&&(window.CustomEvent=function(z,x){x=x||{bubbles:!1,cancelable:!1,detail:void 0};var D=document.createEvent("CustomEvent");D.initCustomEvent(z,
x.bubbles,x.cancelable,x.detail);return D},window.CustomEvent.prototype=window.Event.prototype);document.addEventListener("touchstart",function(z){var x;a:{for(x=z.target;x&&x!==document.documentElement;){var D=x.getAttribute("data-swipe-ignore");if(D){x=D;break a}x=x.parentNode}x="false"}if(!(x="true"===x))a:{for(x=z.target;x&&x!==document.documentElement;){if((D=p.getStageObjectInstanceByElement(x))&&D.isDraggable()){x=!0;break a}x=x.parentNode}x=!1}x||(A=z.target,F=$(z.target).closest(".axon_sbobj"),
B=Date.now(),r=z.touches[0].clientX,v=z.touches[0].clientY,C=t=0,E=z.touches.length,G=!1)},{capture:!1,passive:!1});document.addEventListener("touchmove",function(z){if(r&&v){var x=z.touches[0].clientY;t=r-z.touches[0].clientX;C=v-x;if(null!==F&&F.hasClass("axon_sbobj")&&!0===h){if(z.cancelable){var D=Date.now()-B;x="";var H=z.changedTouches||z.touches||[];Math.abs(t)>Math.abs(C)&&(G||100<Math.abs(t)&&300>D&&(G=!0),G&&(x=0<t?"swiping-left":"swiping-right"));""!==x&&(D={dir:x.replace(/swiping-/,""),
touchType:(H[0]||{}).touchType||"direct",fingers:E,xStart:parseInt(r,10),xEnd:parseInt((H[0]||{}).clientX||-1,10),yStart:parseInt(v,10),yEnd:parseInt((H[0]||{}).clientY||-1,10)},A.dispatchEvent(new CustomEvent(x,{bubbles:!0,cancelable:!0,detail:D})))}10<Math.abs(t)?z.preventDefault():G&&z.cancelable&&z.preventDefault()}}},{capture:!1,passive:!1});document.addEventListener("touchend",function(z){if(null!==F&&F.hasClass("axon_sbobj")){var x=Date.now()-B,D="",H=z.changedTouches||z.touches||[];if(!0!==
h){z=30;var J="px";var N=200}else z=35,J="vw";if("vh"===J||"vw"===J)z=Math.min(Math.round(z/100*document.documentElement.clientHeight),Math.round(z/100*document.documentElement.clientWidth));if(!0!==h)Math.abs(t)>Math.abs(C)?Math.abs(t)>z&&x<N&&(D=0<t?"swiped-left":"swiped-right"):Math.abs(C)>z&&x<N&&(D=0<C?"swiped-up":"swiped-down");else{if(!G)return;Math.abs(t)>Math.abs(C)?Math.abs(t)>z&&(D=0<t?"swiped-left":"swiped-right"):Math.abs(C)>z&&(D=0<C?"swiped-up":"swiped-down");A.dispatchEvent(new CustomEvent("swiped",
{bubbles:!0,cancelable:!0,detail:{dir:""!==D?D.replace(/swiped-/,""):""}}))}""!==D&&(N={dir:D.replace(/swiped-/,""),touchType:(H[0]||{}).touchType||"direct",fingers:E,xStart:parseInt(r,10),xEnd:parseInt((H[0]||{}).clientX||-1,10),yStart:parseInt(v,10),yEnd:parseInt((H[0]||{}).clientY||-1,10),widget:p.getStageObjectInstanceByElement(F)},A.dispatchEvent(new CustomEvent(D,{bubbles:!0,cancelable:!0,detail:N})));F=B=v=r=null;G=!1}},!1);var r=null,v=null,t=null,C=null,B=null,A=null,E=0,F=null,G=!0}m=m.config().widgetsvc;
var n=m.getShortUIKey(),w,y;$.widget(m.getFullUIKey(),$.sb4[u],{options:{},_create:function(){this.firstRenderScene=0;this.pageDeletionTask=null;w=new createjs.LoadQueue(SB4API.preferXHR);w.setMaxConnections(10);y=new createjs.LoadQueue(SB4API.preferXHR);y.setMaxConnections(10);this.pageNumIdMap=a.lo.pageNumIdMap;this.pageIdNumMap=a.lo.pageIdNumMap;this.pageNumNameMap=a.lo.pageNumNameMap;this.searchData=a.lo.searchData;this.chunkMap=a.lo.chunkmap;this.preloadMap=a.lo.preloadmap;this.preloadResourceArray=
[];this.element.addClass(n);var h=this.options;this._super();this.totalSceneCount=this.getFlowSceneCount(h._d.flow.subflow);this.scrollToTop=b.find(a.lo.meta.entries,function(B){return"scrollToTop"==B.id}).value;this.enablePageSwipe=b.find(a.lo.meta.entries,function(B){return"enablePageSwipe"==B.id}).value;var r=(100-b.find(a.lo.meta.entries,function(B){return"stagebgtransparency"==B.id}).value)/100;if(0==b.find(a.lo.meta.entries,function(B){return"stagebgchoice"==B.id}).value){var v=b.find(a.lo.meta.entries,
function(B){return"stagebgcolor"==B.id});null!=v.cid?this.element.css("background-color",$.Color("#"+v.cid).alpha(r).toRgbaString()):this.element.css("background-color","rgba("+p.getInt(v.R,0)+","+p.getInt(v.G,0)+","+p.getInt(v.B,0)+","+r+")")}else v=b.find(a.lo.meta.entries,function(B){return"stagebgimage"==B.id}),1===r?this.element.css("background-image","url("+SB4API.util.getWidgetAssetURI(v.key)+")"):this.element.css("background-image","linear-gradient(rgba(255, 255, 255, "+(1-r)+"), rgba(255, 255, 255, "+
(1-r)+")), url("+SB4API.util.getWidgetAssetURI(v.key)+")"),this.element.css("background-repeat","repeat"),this.element.css("background-color","");this.element.css("overflow","hidden");this.element.css("clip-path","inset(0px)");this.objctx=h._engine.objctx.fork();this.objctx.add("_frame",this);SB4API.rootContext.add(["[frame]"],this);this.scene=null;this.subFlowMap={};this._initSubFlowMap(this.options._d.flow.subflow,"root");this.engine=new f(h._i,null,this.objctx,"frame");this.engine.objctx.add("[ctx_type]",
"frame");h._engine.addEngine(this.engine);this.factory=new q(this.engine);this.mastermap=b.indexBy(h._d.slides,"id");var t=this;SB4API.getSearchResult=function(B,A){if(null==t.searchData||b.str.isBlank(B))return[];var E=!0;/^[\w\s,.]+$/.test(B)||(E=!1);var F=E?new RegExp("(?:\\S+\\s){0,2}\\S*"+B+"\\S*(?:\\s\\S+){0,2}","gi"):new RegExp("(.{0,10}"+B+".{0,10})","gi");var G=new RegExp(B,"gi");B=b.map($(".sceneMasterLayer"),function(x){return $(x).attr("id")});var z=[];b.each(b.pick(t.searchData.masterPages,
B),function(x){b.each(b.values(x),function(D){b.each(D.text,function(H){z=z.concat(b.map(H.match(F),function(J){return J.replace(G,A)}))})})});return b.map(t.searchData.localPages,function(x,D){var H=[];b.each(b.values(x),function(J){b.each(J.text,function(N){H=H.concat(b.map(N.match(F),function(P){return P.replace(G,A)}))})});D==SB4API.currentScene.id&&(H=H.concat(z));x={};x.id=D;x.number=t.pageIdNumMap[D];x.name=t.pageNumNameMap[x.number];x.text=H;return x})};var C=this.objctx;r=h._d.blockDefRegistry;
void 0!=r&&b.each(r.defs,function(B){C.add("global "+B.name)});h.selectedScene?(r=this._findHashSceneByID(this.options._d.flow.subflow,h.selectedScene),h.selectedScene=null,null==r&&(r=this._selectNextScene({cmd:"restart"}))):r=this._selectNextScene({cmd:"restart"});(r=this._findFinalScene(r))&&this._revertScene(r);l(this.enablePageSwipe);this.element.get(0).addEventListener("swiped-left",function(B){if(!0!==t.enablePageSwipe)for(var A=0;A<t.engine.subEngines.length;A++)t.engine.subEngines[A].addEvent("flow",
"l",{src:B.detail.widget});else if(A=SB4API.rootContext.get("[swipeLeft]"),b.has(A,"type"))t.onEnginePageEvent(A.type,A.data);else for(A=0;A<t.engine.subEngines.length;A++)t.engine.subEngines[A].addEvent("flow","l",{src:B.detail.widget})});this.element.get(0).addEventListener("swiped-right",function(B){if(!0!==t.enablePageSwipe)for(var A=0;A<t.engine.subEngines.length;A++)t.engine.subEngines[A].addEvent("flow","r",{src:B.detail.widget});else if(A=SB4API.rootContext.get("[swipeRight]"),b.has(A,"type"))t.onEnginePageEvent(A.type,
A.data);else for(A=0;A<t.engine.subEngines.length;A++)t.engine.subEngines[A].addEvent("flow","r",{src:B.detail.widget})});this.element.get(0).addEventListener("swiping-left",function(B){if(!0===t.enablePageSwipe){var A=SB4API.rootContext.get("[swipeLeft]");b.has(A,"type")&&(t.element.css("left",B.detail.xEnd-B.detail.xStart),t._util.floatWidgetsPositionBySwipe())}});this.element.get(0).addEventListener("swiping-right",function(B){if(!0===t.enablePageSwipe){var A=SB4API.rootContext.get("[swipeRight]");
b.has(A,"type")&&(t.element.css("left",B.detail.xEnd-B.detail.xStart),t._util.floatWidgetsPositionBySwipe())}});this.element.get(0).addEventListener("swiped",function(B){!0===t.enablePageSwipe&&(B=B.detail.dir,"left"===B||"right"===B?(t.element.css("left","0px"),$(".axon_sbobj_absolute_position").removeClass("axon_sbobj_absolute_position"),t._util.floatWidgetsPosition()):$(t.element).animate({left:"0"},{complete:function(){$(".axon_sbobj_absolute_position").removeClass("axon_sbobj_absolute_position");
t._util.floatWidgetsPosition()},progress:function(){t._util.floatWidgetsPositionBySwipe()}}))})},_selectNextScene:function(h){var r=null,v=this.options._d;"restart"==h.cmd?r=v.flow:"sb4_goto_branch"==h.cmd?(v=this.scene.flows,"_next"==h.v?r=void 0==this.scene.flows||b.isEmpty(v)?this._findNextSceneAfterSubflow(this.scene.id):v[0]:"_nextRandom"==h.v?r=void 0==this.scene.flows||b.isEmpty(v)?this._findNextSceneAfterSubflow(this.scene.id):b.sample(v):"_prev"==h.v?(r=this._findSceneId(this.scene.id),r=
this._findPrevSceneByBranchID(this.options._d.flow.subflow,r)):b.str.isBlank(h.v)||(r=b.find(v,function(t){return t.id==h.v}))):"global_sb4_goto_scene"==h.cmd?r=this._findHashSceneByID(this.options._d.flow.subflow,h.v):"reload"==h.cmd&&(r=this.scene);return r},_findHashSceneByID:function(h,r){if(b.str.isBlank(r)||null==h)return null;var v=null;if(h.id==r)return h;var t=h.flows;if(null!=t)for(var C in t)if(v=this._findHashSceneByID(t[C],r),null!=v)return v;h=h.subflow;if(null!=h){if(h.id==r)return h;
v=this._findHashSceneByID(h,r)}return v},_findSceneByID:function(h,r){if(b.str.isBlank(r)||null==h)return null;if(h.id==r)return h;h=h.flows;if(void 0==h)return null;var v=null,t;for(t in h)if(v=this._findSceneByID(h[t],r),null!=v)break;return v},_findPrevSceneByBranchID:function(h,r){if(b.str.isBlank(r)||null==h)return null;var v=h.flows,t;for(t in v)if(v[t].id==r)return h;var C=null;for(t in v)if(C=this._findPrevSceneByBranchID(v[t],r),null!=C)break;null==C&&(v=h.subflow,null!=v&&(v.id==r?C=h:v.flows&&
(C=this._findPrevSceneByBranchID(v,r))));return C},_findSceneId:function(h){var r=this._findHashSceneByID(this.options._d.flow.subflow,this.subFlowMap[h]);if(null!=r){var v=r.subflow;if(b.str.isBlank(h)||null==v)return null;if(null!=r&&v.id==h)return h=r.id,this._findSceneId(h)}return h},_findNextSceneAfterSubflow:function(h){var r=null;h=this._findHashSceneByID(this.options._d.flow.subflow,this.subFlowMap[h]);null!=h&&(r=void 0!=h.flows&&0<b.size(h.flows)?h.flows[0]:this._findNextSceneAfterSubflow(h.id));
return r},_renderScene:function(h){if(0!=$("#playFull").length&&1==SB4API.mediaAutoPlayAuthorization)this.engine.objctx.add("playFull_scene",h);else if(null==h)SB4API.hideLoadingWithOpacity();else{b.has(SB4API.queryMap,"mid")?this.mastermap[SB4API.queryMap.mid]?SB4API.stageLog("render master :  name is "+this.mastermap[SB4API.queryMap.mid].name):SB4API.stageLog("render master :  can not find valid master by mid\x3d"+SB4API.queryMap.mid):SB4API.stageLog("render scene : num is "+this.pageIdNumMap[h.id]+
" , name is "+h.name);this.scene=h;var r=this.scene.id;this.options._h=h.time&&0<h.time?h.time:SB4API.profile.current.h;this.element.height(this.options._h);this.scrollToTop&&$(document.documentElement).scrollTop(0);0!=$("#playFull").length&&0==SB4API.mediaAutoPlayAuthorization&&0==$("#playButton").length&&$(document).ready(function(){SB4API.playButtonBackgroundColor?$("#playFull").css("background-color",SB4API.playButtonBackgroundColor):$("#playFull").css("background-color","rgba(255,255,255,0.8)");
var K=0;1==SB4API.tabOrder&&(K=1);$('\x3cdiv id\x3d"playButton" style\x3d"width: 150px;height: 150px;position:absolute;"\x3e\x3cdiv class\x3d"notouch" style\x3d"width: 100%; height: 100%; position: absolute"\x3e\x3cbutton tabindex\x3d"'+K+'" class\x3d"" style\x3d"width: 100%; height: 100%;border: none; background-color: rgba(255,255,255,0);" aria-label\x3d"Authorize media to autoplay."\x3e\x3c/button\x3e\x3c/div\x3e\x3csvg version\x3d"1.1" id\x3d"Layer_1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink" x\x3d"0px" y\x3d"0px"\t width\x3d"150px" height\x3d"150px" viewBox\x3d"0 0 92 92" enable-background\x3d"new 0 0 92 92" xml:space\x3d"preserve"\x3e\x3cg\x3e\t\x3cpath fill\x3d"#6B6B6B" d\x3d"M46,8c20.953,0,38,17.047,38,38S66.953,84,46,84C25.047,84,8,66.953,8,46S25.047,8,46,8 M46,1\t\tC21.147,1,1,21.147,1,46c0,24.854,20.147,45,45,45c24.851,0,45-20.146,45-45C91,21.147,70.852,1,46,1L46,1z"/\x3e\t\x3cpath fill\x3d"#6B6B6B" d\x3d"M38.167,25.147c-0.368,0-0.736,0.085-1.077,0.257c-0.802,0.406-1.309,1.229-1.309,2.129v37.725\t\tc0,0.899,0.506,1.723,1.309,2.129c0.34,0.172,0.71,0.257,1.077,0.257c0.5,0,0.996-0.156,1.414-0.463l25.667-18.863\t\tc0.611-0.45,0.973-1.164,0.973-1.923c0-0.759-0.361-1.473-0.973-1.923L39.58,25.61C39.163,25.304,38.666,25.147,38.167,25.147\t\tL38.167,25.147z"/\x3e\x3c/g\x3e\x3c/svg\x3e\x3c/div\x3e').appendTo("#playFull");
$("#playFull").show();var M=$(".com_smartbuilder_axon_widget_frame").eq(0);K=document.documentElement.clientWidth>M.width()?parseInt((M.width()-$("#playButton").width())/2)+M.offset().left+"px":parseInt((document.documentElement.clientWidth-$("#playButton").width())/2)+M.scrollLeft()+"px";M=document.documentElement.clientHeight>M.height()?parseInt((M.height()-$("#playButton").height())/2)+M.offset().top+"px":parseInt((document.documentElement.clientHeight-$("#playButton").height())/2)+M.scrollTop()+
"px";$("#playButton").css("left",K);$("#playButton").css("top",M);$("#playFull").on("click",function(){$.each($("audio"),function(T,S){S.load()});SB4API.setAudioCapable();$.each($("video"),function(T,S){$(S).hasClass("video-unused")&&S.setAttribute("src","");S.load()});"undefined"===typeof window.orientation&&$("#media").empty();$("#playFull").remove();$.each(SB4API.autoPlayList,function(T,S){if(null===S[0])S[1]();else g.invoke(S[0],S[1],[])})})});var v=!1,t=0,C=0;SB4API.currentFrameSize&&(t=this.options._h-
SB4API.currentFrameSize._h,C=this.options._w-SB4API.currentFrameSize._w,0!=t||0!=C)&&(v=!0);SB4API.currentFrameSize={_w:this.options._w,_h:this.options._h};SB4API.currentScene={name:this.scene.name,id:r,num:this.pageIdNumMap[r]};SB4API.updateScale(SB4API.profile.current);SB4API.updateProfile(SB4API.profile.current.id);v&&"function"==typeof onSceneHeightChange&&onSceneHeightChange();SB4API.hideLoadingWithOpacity();b.isObject(SB4API.xapi.tincan)&&SB4API.xapi.pageVisit(this.scene.name,this.pageIdNumMap[r]);
var B=this,A=h.slides,E=h.layers,F=[];void 0!=E&&(F=F.concat(E));E=b.map(this.mastermap,function(K,M){return K});F=F.concat(E);E=b.indexBy(F,"id");var G=0,z={};F=[];for(var x in A){var D=E[p.trimRefString(A[x].$ref)];void 0!=D&&(F.push(D),z[D.id]=G,G++)}var H=b.indexBy(F,"id"),J={};this.element.find(".com_smartbuilder_axon_widget_slideset").each(function(K,M){K=$(M);M=K.attr("id");H[M]&&K.hasClass("sceneMasterLayer")&&(J[M]=K)});var N={};N["[evtval]"]=SB4API.profile.current.d;this.sceneLocalEngine=
this.engine.addSubEngine(r,"local");this.sceneLocalEngine.objctx.add("[ctx_type]","local");this.sceneLocalEngine.objctx.add("[var_widget_id_map]",{});this.sceneLocalEngine.eventQueue.push(["flow","load",N]);if(!b.isEmpty(J)){var P=!1,O=-1;b.each(b.keys(J),function(K,M){K=p.parseInt(z[K],-1);K>O?O=K:P=!0});P&&this.element.children().sort(function(K,M){K=p.parseInt(z[$(K).attr("id")],-1);M=p.parseInt(z[$(M).attr("id")],-1);return K<M?-1:K>M?1:0}).appendTo(this.element)}b.each(b.keys(J),function(K,M){(K=
B.engine.getSubEngineByID(K))&&K.eventQueue.push(["flow","change",N])});A=[];for(var L in F)if(x=F[L].id,G=null,J[x])G=$("#"+x,this.element),(x=B.engine.getSubEngineByID(x))&&b.map(b.uniq(b.values(x.initObjctx.map)),function(K){if(p.isWgt(K)&&!K.element.hasClass("float_axon_sbobj")&&v){var M=K._getCurrentProfile();if(null!=M&&("B"==M.f.v||"R"==M.f.h)){var T=K.getPos();"B"==M.f.v&&(T.top+=t);"R"==M.f.h&&(T.left+=C);K.setPos(T)}}});else{G=null;E="sceneLocalLayer";if(this.mastermap[x]){var R=this.engine.addSubEngine(x,
this.mastermap[x].name);R.objctx.add("[ctx_type]","master");R.objctx.add("[var_widget_id_map]",{});R.eventQueue.push(["flow","load",N]);R.addEngineEventListener(B);G=new q(R);E="sceneMasterLayer"}else G=new q(this.sceneLocalEngine);D=null;for(var Q=parseInt(L)+1;Q<F.length;Q++){var U=F[Q].id;if(J[U]){D=U;break}}Q=null;Q=null!=D?G._createObjDivBefore($("#"+D)):G._createObjDiv(this.element);D=G._createObj(Q,F[L],this.element,"SlideSet");D.addClass(E);G._activateObjDiv(Q,void 0!=D);A.push($(D));G=D;
J[x]=G;"sceneMasterLayer"==E&&F[L].actions&&$.each(F[L].actions,function(K,M){R.parseXml(M.val)})}h.actions&&$.each(h.actions,function(K,M){B.sceneLocalEngine.parseXml(M.val)});this.sceneLocalEngine.addEngineEventListener(this);L={};L.id=r;L.name=h.name;SB4API.flowcontext.setContext(L);var I=[];b.each(SB4API.cacheSvgIdList,function(K,M){0==$("."+K).length?$("#svg_"+K).remove():I.push(K)});SB4API.cacheSvgIdList=I;SB4API.pageLaunchTime=$.now();this._postRenderScene(A,h)}},_postRenderScene:function(h,
r){SB4API.rootContext.add("[swipeLeft]",{type:"sb4_goto_branch",data:{v:"_next"}});SB4API.rootContext.add("[swipeRight]",{type:"sb4_goto_branch",data:{v:"_prev"}});var v=this.element.get(0);$("body").width()>=$(v).width()?$(v).css("left",parseInt(($("body").width()-$(v).width())/2)+"px"):$(v).css("left","0px");this._util.floatWidgetsPosition();0==this.firstRenderScene?("hidden"!==this.element.css("visibility")?$("#a508").focus({preventScroll:!0}):$("#a508").addClass("sb4-need-focus"),this.firstRenderScene=
1):this.firstRenderScene=-1;this.engine.start();var t=this;SB4API.stageLog("stage ready");$.each(h,function(C,B){t.sceneLocalEngine.invokeWidgetMethod(B,"_onStageReady");t.sceneLocalEngine.invokeWidgetMethod(B,"_onParentShowHide",[!0,!0])});this.timeline=new c(this.sceneLocalEngine,r.timeline);this.timeline.isAutoPlay()&&this.timeline.play("play");this._util.calculateTabindex();this.engine.objctx.add("_timeline",this.timeline);SB4API.flowcontext.fireEvent();this.element.append($("\x3cdiv class\x3d'sb_nvda_508_trigger' style\x3d'width: 0px;height: 0px;'\x3e\x3c/div\x3e"));
$("#playerstage").append($("\x3cdiv class\x3d'sb_nvda_508_trigger' style\x3d'width: 0px;height: 0px;'\x3e\x3c/div\x3e"));setTimeout(function(){$(".sb_nvda_508_trigger").remove()},500)},onEngineEvent:function(h,r,v,t){if("onHide"==v||"onShow"==v||"onMove"==v)this.debounce||(this.debounce=b.debounce(this._util.calculateTabindex,300)),this.debounce();t=b.clone(t);if(null!=t&&t.broadcast){t.broadcast=!1;for(var C=0;C<this.engine.subEngines.length;C++)h!=this.engine.subEngines[C]&&this.engine.subEngines[C].addEvent(r,
v,t)}else if("flow"==r&&(t.cmd=v,"sb4_goto_branch"==v||"restart"==v||"global_sb4_goto_scene"==v||"reload"==v))this.onEnginePageEvent(v,t)},onEnginePageEvent:function(h,r){if("sb4_goto_branch"==h||"restart"==h||"global_sb4_goto_scene"==h||"reload"==h){this.cmd=r.cmd=h;var v=this._selectNextScene(r)}else"sb4_goto_scene_by_name"==h?v=this.gotoSceneByName(this.options._d.flow.subflow,r.name):"sb4_goto_branch_by_name"==h?v=this.gotoBranchByName(r.name):"sb4_goto_scene_by_id"==h&&(v=this._findHashSceneByID(this.options._d.flow.subflow,
r.id));if(v=this._findFinalScene(v))this.engine.stop(),this._revertScene(v)},_findFinalScene:function(h){h=this.getSenceSubFlow(h);if(null==h)return null;var r=this.scene;return"restart"!=this.cmd&&"reload"!=this.cmd&&null!=r&&r.id==h.id?null:h},_destroy:function(){this.engine.destroy();this.engine=null;this.mastermap=void 0;this.factory=this.objctx=null;this._super()},_revertScene:function(h){if(null!=h){this.cmd=null;var r=this,v=h.slides,t=[];for(F in v){var C=p.trimRefString(v[F].$ref);void 0!=
C&&t.push(C)}this.timeline&&this.timeline.play("destroy");var B=[];this.sceneLocalEngine&&(B.push(this.sceneLocalEngine.id),this.sceneLocalEngine.destroy());this.element.find(".com_smartbuilder_axon_widget_slideset").each(function(x,D){var H=$(D);x=H.attr("id");if(!b.contains(t,x)||!H.hasClass("sceneMasterLayer")){H.hasClass("sceneMasterLayer")&&(x=r.engine.getSubEngineByID(x))&&(B.push(x.id),x.destroy());var J=r._getElementWidgetInstance(D);J.destroy();H.parent().hasClass("ui-effects-wrapper")?H.parent().remove():
H.remove();r.pageDeletionTask=function(){J.destroy();H.remove()}}});this.engine._purgeSubEngine();var A=[];b.each(b.keys(this.engine.objctx.map),function(x,D){D=r.engine.objctx.map[x];b.str.startsWith(x,"[fn:")&&b.contains(B,D.engineId)&&A.push(x)});b.each(A,function(x,D){r.engine.objctx.remove(x)});SB4API.showLoadingWithOpacity();if(h.layers)this._preloadResourcesAndRender(h,[]);else{b.invert(a.lodict.id);var E=[];var F=b.keys(this.mastermap);v="?t\x3d"+(new Date).toISOString();0<F.length&&void 0==
this.mastermap[F[0]].name&&E.push({src:SB4API.addBustParam("app/master.js")+v,id:"master",loadTimeout:1E4});F={};C=this._findChunkID(h.id);null!=C&&(F.src=SB4API.addBustParam("app/sc_"+C+".js")+v,F.id=C,F.loadTimeout=1E4,E.push(F));var G=function(x){x=b.keys(r.mastermap);0<x.length&&void 0==r.mastermap[x[0]].name&&(b.isArray(master)||(master=e.decodeSb4Data(master)),e.revertLoColor(master,a.text.glyphReg.colorData),a.lodict.id&&e.revertTextWgtId(master,a.lodict.id),e.decodeLO(master,a.lodict),this.mastermap=
b.indexBy(master,"id"),$.each(master,function(D,H){H.textReg&&(D=b.keys(H.textReg),$.each(D,function(J,N){J=N.split(".")[0];var P=H.textReg[N];if(b.isObject(P)&&b.has(P,"refid")){var O=P.refid;P.refid=a.lodict.id[O.substring(0,O.indexOf("."))]+O.substring(O.indexOf("."))}SB4API.txtLib.textReg[a.lodict.id[J]+N.substring(J.length)]=P}))}),r.mastermap=b.indexBy(master,"id"));x=r._findChunkID(h.id);"undefined"==typeof local&&(SB4API._console.error("scene file format error"),local=void 0);void 0==local&&
(local=h.layers);void 0!=local&&null!=x&&w.getResult(x)&&(b.isObject(local)||(local=e.decodeSb4Data(local)),b.each(local,function(D,H,J){e.revertLoColor(D,a.text.glyphReg.colorData);a.lodict.id&&e.revertTextWgtId(D,a.lodict.id);e.decodeLO(D,a.lodict);D.textReg&&(SB4API.txtLib.textReg=b.extend(SB4API.txtLib.textReg,D.textReg));J=H;a.lodict.id&&(J=a.lodict.id[H]);H=r._findHashSceneByID(r.options._d.flow.subflow,J);H.actions=D.actions;H.layers=D.layers}),local=void 0);r._preloadResourcesAndRender(h,
[])},z=function(x){SB4API._console.error("_handleFinalError "+x.data.src+" "+x.title+" "+x.message);w.removeAllEventListeners();alert("Network connection lost. Please refresh your browser.\n\n(Time: "+(new Date).toISOString()+", URL: "+location.origin+location.pathname.substring(0,location.pathname.lastIndexOf("/")+1)+x.data.src+")")};w.removeAllEventListeners();w.on("complete",G);w.on("error",function(x){SB4API.setConsoleEnable(!0,12E4);SB4API._console.error("_handleError "+x.data.src+" "+x.title+
" "+x.message);w.removeAllEventListeners();setTimeout(function(){w.on("complete",G);w.on("error",z);E[0].src+="\x26retry\x3d1";w.loadManifest(E)},5E3)});w.loadManifest(E)}}},_findChunkID:function(h){for(var r in this.chunkMap)if(0<=this.chunkMap[r].indexOf(h))return r;return null},_preloadResourcesAndRender:function(h,r){var v=this;this._findChunkID(h.id);var t=function(E){console.log("_handleesourecesLoadCompleter");v._renderScene(h)},C=function(E){console.log("_handleesourecesLoadError "+E.data.src+
" "+E.title+" "+E.message)};this._preloadChunkAssets(h,r);if(b.isEmpty(r))h["preloadResources"+SB4API.profile.current.id]=!0,v._renderScene(h);else{for(var B=[],A=0;A<r.length;A++)B.push({id:r[A],src:r[A],loadTimeout:1E4});y.loadManifest(B);y.removeAllEventListeners();y.on("complete",t);y.on("error",C)}},_preloadResources:function(h,r){alert("deprecated 4");var v=this,t=function(E){console.log("_handleesourecesLoadCompleter");h["preloadResources"+SB4API.profile.current.id]=!0;v._renderScene(h)},C=
function(E){console.log("_handleesourecesLoadError "+E.data.src+" "+E.title+" "+E.message)};if(h["preloadResources"+SB4API.profile.current.id])this._renderScene(h);else if(this._findPreloadResources(h,r),b.isEmpty(r))h["preloadResources"+SB4API.profile.current.id]=!0,v._renderScene(h);else{for(var B=[],A=0;A<r.length;A++)B.push({id:r[A],src:r[A],loadTimeout:1E4});y.loadManifest(B);y.removeAllEventListeners();y.on("complete",t);y.on("error",C)}},_isAlreadyPreload2:function(h,r){h=SB4API.util.getWidgetAssetURI(h,
r);if(b.contains(this.preloadResourceArray,h))return!0;this.preloadResourceArray.push(h);return!1},_preloadChunkAssets:function(h,r){if(null!=this.preloadMap){var v=this.preloadMap[SB4API.profile.current.id];h=this._findChunkID(h.id);if(null!=v&&(h=this.chunkMap[h],null!=v))for(var t in h){var C=v[h[t]],B;for(B in C){var A=C[B].lastIndexOf(","),E="";0>=A?A=C[B]:(E=C[B].substring(A+1),A=C[B].substring(0,A));this._isAlreadyPreload2(A,E)||r.push(b.last(this.preloadResourceArray))}}}},_findPreloadResources:function(h,
r){alert("deprecated");var v=this,t=[];this._findWgts(h.layers,t);var C=b.map(h.layers,function(B){return B.id});$.each(h.slides,function(B,A){B=p.trimRefString(A.$ref);null==B||b.contains(C,B)||v._findWgts(v.mastermap[B].slides,t)});$.each(t,function(B,A){null!=A.data.entries&&v._findPreloadResourcesByWgt(A.data.entries,r,A.type)})},_isAlreadyPreload:function(h,r){alert("deprecated 3");h=SB4API.util.getWidgetAssetURI(h,r);if(b.contains(this.preloadResourceArray,h))return!0;this.preloadResourceArray.push(h);
return!1},_findPreloadResourcesBySubEntry:function(h,r,v,t){alert("Deprecated");if(b.isArray(h.subs)){var C=this;$.each(h.subs,function(B,A){"ResData"==A.eClass&&A.key&&!C._isAlreadyPreload(A.key,t)&&r.push(b.last(v));C._findPreloadResourcesBySubEntry(A,r,v,t)})}},_findPreloadResourcesByWgt:function(h,r,v){alert("deprecated 2");var t=this,C=SB4API.profile.current.id,B=b.find(h,function(E){return"_prf"==E.id});if(B&&(B=b.find(B.subs,function(E){return E.id==C}))&&(B=B.subs,b.isArray(B))){var A=b.map(B,
function(E){return E.id});h=b.reject(h,function(E){return b.contains(A,E.id)});h=B.concat(h)}t._isPreloadRes(h)?$.each(h,function(E,F){"ResData"==F.eClass&&F.key&&(t._isAlreadyPreload(F.key,v)||r.push(b.last(void 0)));"_"!==F.id&&t._findPreloadResourcesBySubEntry(F,r,void 0,v)}):$.each(h,function(E,F){"pload"==F.id&&"ResData"==F.eClass&&(t._isAlreadyPreload(F.key,v)||r.push(b.last(void 0)),b.isArray(F.subs)&&$.each(F.subs,function(G,z){t._isAlreadyPreload(z.key,v)||r.push(b.last(void 0))}))})},_findWgts:function(h,
r){var v=this;if(b.isArray(h))$.each(h,function(C,B){v._findWgts(B,r)});else if(b.isObject(h))if(b.isArray(h.widgets)&&!b.isEmpty(h.widgets))$.each(h.widgets,function(C,B){r.push(B)});else for(var t in h)"object"==typeof h[t]&&this._findWgts(h[t],r)},_isPreloadRes:function(h){var r=!1;null!=h?$.each(h,function(v,t){"preload"==t.id&&1==t.value&&(r=!0)}):r=!0;return r},_timelineGoto:function(h){return this.timeline._timelineGoto(h)},_timelinePlay:function(){this.timeline.play("play")},_timelineStop:function(){this.timeline.play("stop")},
gotoSceneByName:function(h,r){return this.findSceneByName(h,r)},findSceneByName:function(h,r){if(null==h)return null;var v=null,t=h.subflow;if(null!=t){if(t.name.toLowerCase()==r.toLowerCase())return t;v=this.findSceneByName(t,r);if(null!=v)return v}if(h.name.toLowerCase()==r.toLowerCase())return h;h=h.flows;if(null!=h)for(var C in h)if(v=this.findSceneByName(h[C],r),null!=v)break;return v},_initSubFlowMap:function(h,r){if(null==h)return null;this.subFlowMap[h.id]=r;var v=h.subflow;null!=v&&this._initSubFlowMap(v,
h.id);h=h.flows;if(null!=h)for(var t in h)this._initSubFlowMap(h[t],r)},exitFlow:function(){var h=this._findExitFlowNextScene(this.scene);this._revertScene(this.getSenceSubFlow(h))},_findExitFlowNextScene:function(h){h=this.subFlowMap[h.id];if("root"!=h&&(h=this._findHashSceneByID(this.options._d.flow.subflow,h),null!=h))return b.isArray(h.flows)&&0<b.size(h.flows)?h.flows[0]:this._findExitFlowNextScene(h)},getBranchNames:function(){var h=this.scene.flows;return 0<b.size(h)?b.map(h,function(r){return r.name}):
[]},getBranchNums:function(){var h=this.scene.flows;if(0<b.size(h)){var r=this;return b.map(h,function(v){return r.pageIdNumMap[v.id]})}return[]},getSenceSubFlow:function(h){return null!=h&&null!=h.subflow?(h=h.subflow,this.getSenceSubFlow(h)):h},gotoBranchByName:function(h){var r=this.scene.flows,v=null;if(null!=r)for(var t in r)if(r[t].name.toLowerCase()==h.toLowerCase()){v=r[t];break}return v},getFlowSceneCount:function(h){var r=1,v=h.subflow;null!=v&&(r=r+this.getSubFlowSceneCount(v)-1);h=h.flows;
if(null!=h){var t=this;$.each(h,function(C,B){r+=t.getFlowSceneCount(B)})}return r},getSubFlowSceneCount:function(h){var r=1;h=h.flows;if(null!=h){var v=this;$.each(h,function(t,C){r+=v.getFlowSceneCount(C)})}return r},_play:function(){this._super()&&this.timeline&&this.timeline.play("play")},_stop:function(){this._super();this.timeline.play("stop")},_isPlaying:function(){this._super();return void 0!=this.timeline&&this.timeline.getStatus()==this.timeline.STATUS_PROCESS?!0:!1},changeProfile:function(h){this.options._w=
h.w;var r=this.scene.id,v=h.hMap;this.options._h=v[r]?v[r]:h.h;this.element.width(this.options._w);this.element.height(this.options._h);SB4API.alignToBody();$("body").scrollTop(0);SB4API.currentFrameSize={_w:this.options._w,_h:this.options._h};this._super(h)},preloadResourcesBeforeChangeProfile:function(){var h=this,r=function(A){console.log("_handleesourecesLoadCompleter");h.scene["preloadResources"+SB4API.profile.current.id]=!0},v=function(A){console.log("_handleesourecesLoadError "+A.data.src+
" "+A.title+" "+A.message)};if(!h.scene["preloadResources"+SB4API.profile.current.id]){var t=[];this._preloadChunkAssets(h.scene,t);if(b.isEmpty(t))h.scene["preloadResources"+SB4API.profile.current.id]=!0;else{for(var C=[],B=0;B<t.length;B++)C.push({id:t[B],src:t[B],loadTimeout:1E4});y.loadManifest(C);y.removeAllEventListeners();y.on("complete",r);y.on("error",v)}}}});return n});
define("wgt/com.smartbuilder.axon.widget.slideset/s",["module","sb4core/sbobj"],function(m,u){m=m.config().widgetsvc;var q=m.getShortUIKey();$.widget(m.getFullUIKey(),$.sb4[u],{options:{mode:0},_create:function(){this.element.addClass(q);this._super();this.idx=-1;this.list=null},_onStageReady:function(){var p=this;this.element.children(".com_smartbuilder_axon_widget_slide").each(function(b,d){0==b?$(d).removeClass("com_smartbuilder_axon_widget_slide"):1==$(d).data("sb4-"+$(d).data("sb4type"))._vv&&
(p.idx=b-1)});this.list=this.element.children(".com_smartbuilder_axon_widget_slide");this._super()},_paintWidgetShow:function(p){var b=this;if(_.has(p,"idx")){var d=p.idx;this.element.children(".com_smartbuilder_axon_widget_slide").each(function(a,c){a=$(c).data("sb4-"+$(c).data("sb4type"));0==a._vv&&a.hide(p.hidefx,b)});var f=!0,e=!1;this.element.children(".com_smartbuilder_axon_widget_slide").each(function(a,c){a=$(c).data("sb4-"+$(c).data("sb4type"));1==a._vv&&(a.show(p.showfx,b),b.fireEvent("onAnyLayerShown"),
e=!0);0==a.visited&&(f=!1)});e||b.fireEvent("onAllLayerHidden");this.idx=d;b.fireEvent("onLayerChange");1==f&&1!=b.firedAllVisisted&&(b.firedAllVisisted=!0,b.fireEvent("onAllLayerViewed"))}this._super()},showSlide:function(p){p=this._util.parseInt(p);p=this._getSlideRef(p);null!=p&&this._showSlide(!0,p)},hideSlide:function(p){p=this._util.parseInt(p);p=this._getSlideRef(p);null!=p&&this._showSlide(!1,p)},showNextPrevSlide:function(p){0>this.idx&&(this.idx=-1);"_next"==p?this.idx+2>this.list.length||
this.showSlide(this.idx+2):"_prev"!=p||0>this.idx-1||this.showSlide(this.idx)},getVisibleLayerIndexList:function(){var p=[];1==this.getVisible()&&this.element.children(".com_smartbuilder_axon_widget_slide").each(function(b,d){1==$(d).data("sb4-"+$(d).data("sb4type"))._vv&&p.push(b+1)});return p.join()},getVisibleLayers:function(){var p=[],b=this;1==this.getVisible()&&this.element.children(".com_smartbuilder_axon_widget_slide").each(function(d,f){d=b._getSlideRef(d+1);1==d._vv&&p.push(d)});return p},
_getSlideRef:function(p){if(1>p)return null;p=this.element.children(".com_smartbuilder_axon_widget_slide").eq(p-1);return 0==p.length?null:p=p.data("sb4-"+p.data("sb4type"))},_getSlideIdxByRef:function(p){return this.list.index(p.element)},_showSlide:function(p,b,d){var f=this.options,e=this._getSlideIdxByRef(b);this.element.children(".com_smartbuilder_axon_widget_slide").each(function(a,c){a=$(c).data("sb4-"+$(c).data("sb4type"));1==f.mode?a==b&&(a._vv=p):1==p?a._vv=a==b?!0:!1:a==b&&(a._vv=!1)});
if(0!=f.mode||0!=p||this.idx==e)e={idx:e},1==p?e.showfx=d:e.hidefx=d,this._firePaintRequest(e)},getSlideCount:function(){return this.list.length},getSize:function(){return this.options._p.getSize()}});return q});
define("wgt/com.smartbuilder.axon.widget.slide/s",["module","sb4core/sbobj"],function(m,u){m=m.config().widgetsvc;var q=m.getShortUIKey();$.widget(m.getFullUIKey(),$.sb4[u],{options:{},_create:function(){this.element.addClass(q);this._super();this.visited=!1},_onStageReady:function(){this._super()},show:function(p,b){var d=this.options;b==d._p||"_showOrHide"==b?(this.visited=!0,d=d._engine.objctx.get(SB4API._OBJECT_KEY.EFFECT_TIME),this._super(p,b,d)):d._p._showSlide(!0,this,p)},hide:function(p,b){var d=
this.options;b==d._p||"_showOrHide"==b?(d=d._engine.objctx.get(SB4API._OBJECT_KEY.EFFECT_TIME),this._super(p,b,d)):d._p._showSlide(!1,this,p)},getSize:function(){return this.options._p.getSize()},_refreshFxElement:function(){this.element.children(".axon_sbobj").each(function(p,b){$(b).data("sb4-"+$(b).data("sb4type"))._refreshFxElement()})},setSlideVisiblityWithParent:function(p){var b=this.options;"show"==p?(b._p._showSlide(!0,this),b._p.show()):"hide"==p&&(b._p.hide(),b._p._showSlide(!1,this))},
_paintWidgetShow:function(p){this.visited=!0;this._super()}});return q});define("text!widgets/com.smartbuilder.axon.widget.shape/svg.html",[],function(){return'\x3cdiv\n\tstyle\x3d"position: relative; text-align: center; width: 100%; height: 100%;"\x3e\n\t\x3csvg aria-hidden\x3d"true" focusable\x3d"false" xmlns\x3d"http://www.w3.org/2000/svg"\n\t\txmlns:xlink\x3d"http://www.w3.org/1999/xlink"\n\t\txmlns:svg\x3d"http://www.w3.org/2000/svg"\n\t\tcontentScriptType\x3d"text/ecmascript" display\x3d"block" width\x3d"100%" zoomAndPan\x3d"magnify"\n\t\tcontentStyleType\x3d"text/css" height\x3d"100%" preserveAspectRatio\x3d"none"\n\t\tversion\x3d"1.0"\x3e\n\t\t'});
define("lib/css!widgets/com.smartbuilder.axon.widget.shape/style",[],function(){});define("text!widgets/com.smartbuilder.axon.widget.shape/text.html",[],function(){return'\x3c/svg\x3e\n\x3cdiv id\x3d"text"\x3e\x3c/div\x3e\n\x3c/div\x3e'});
define("wgt/com.smartbuilder.axon.widget.shape/s","module sb4core/sbobj text!widgets/com.smartbuilder.axon.widget.shape/svg.html css!widgets/com.smartbuilder.axon.widget.shape/style.css text!widgets/com.smartbuilder.axon.widget.shape/styles.xml text!widgets/com.smartbuilder.axon.widget.shape/text.html".split(" "),function(m,u,q,p,b,d){var f=m.config().widgetsvc,e=f.getShortUIKey();$.widget(f.getFullUIKey(),$.sb4[u],{options:{},_create:function(){null==this.stateChangeMap&&(this.stateChangeMap={});
DEBUG&&console.log("__create");this.element.addClass(e);this._super();this.applyProfileFlag||(this.clkCnt=0,this.lineWidth=this.options.lineWidth,this.linecolor=this.options.line,this.transparency=this.options.transparency,this.textValue=this.options.text,this.textColorValue=this.options.fontColor,this.oldscaleValue=this.scaleValue=100,this.filllist=JSON.parse(this.options.filllist));this.currentBoundingWidth=this.options.currentBoundingWidth;this.currentBoundingHeight=this.options.currentBoundingHeight;
this.currentWidth=this.options._w;this.currentHeight=this.options._h;this.top=parseInt(this.options._y+(this.currentBoundingHeight-this.currentHeight)/2);this.left=parseInt(this.options._x+(this.currentBoundingWidth-this.currentWidth)/2);_.has(this.stateChangeMap,"angle")||(this.angle=this.options.rotation);this.textPadding=this.options.textPadding;this.textVerticalAlign=this.options.textVerticalAlign;this.rootshapeId=_.uniqueId("rootshape_");this.rootshapeJQueryId="#"+this.rootshapeId;this.rootshapeGroupId=
this.rootshapeId+"_g";this.rootshapeShadowId=this.rootshapeId+"_shadow";this.element.addClass("notouch");this.attr={};this.options.underline&&(this.attr.textDecoration="underline");var a=this.left-this.getPosOffset(),c=this.top-this.getPosOffset(),g=this.options._w+this.getSizeOffset(),l=this.options._h+this.getSizeOffset();this.element.css("left",a+"px");this.element.css("top",c+"px");this.element.css("width",g+"px");this.element.css("height",l+"px");a="";null!=this.options.image&&0<this.options.image.length&&
(a=f.getWidgetAssetURI(this.options.image),a='\x3cpattern id\x3d"'+this.options._i+'simg" patternUnits\x3d"userSpaceOnUse"  width\x3d"'+this.options._w+'" height\x3d"'+this.options._h+"\"\x3e \x3cimage aria-hidden\x3d'true' width\x3d\""+this.options._w+'" height\x3d"'+this.options._h+'" preserveAspectRatio\x3d"none" xlink:href\x3d"'+a+'" \x3e\x3c/image\x3e\x3c/pattern\x3e');this.shadowValue=this._util.getShadowValue(this.options.shadow);this._createShape(a);this.shadowdiv=$("\x3cdiv\x3e").prependTo(this.element);
this.shadowdiv.css("position","absolute");this.shadowdiv.css("top","0px");this.shadowdiv.css("left","0px");this.shadowdiv.css("width","0px");this.shadowdiv.css("height","0px");this.shadowdiv.addClass("notouch");this.getShadowVisibility()&&this._createShadow();this.element.css("transform","rotate("+this.angle+"deg)");this.element.find(this.rootshapeJQueryId).attr("transform","translate("+this.getTranslateValue()+","+this.getTranslateValue()+")");100!=this.scaleValue&&this.refreshScale(this.scaleValue)},
_createShadow:function(){if(!this.shadowdiv.hasClass("shadow")){var a=this.options._w+this.getSizeOffset(),c=this.options._h+this.getSizeOffset();this.shadowdiv.addClass("shadow");this.shadowdiv.toggleClass("notVisible",!this.getShadowVisibility());this.shadowdiv.html(this._util.createShadowSvg(this.rootshapeShadowId,this.rootshapeGroupId,this.shadowValue,a,c));0<this.options.margin&&($("#"+this.rootshapeShadowId).attr("x",this.options.margin),$("#"+this.rootshapeShadowId).attr("y",this.options.margin));
this.shadowdiv.attr("style","position:absolute; text-align:center;");a=this.getShadowBounds();this.setTextStyleValue(this.shadowdiv,a[1],a[0],a[2],a[3]);this.element.find("#"+this.rootshapeId+"_shadow").css("opacity",this._util.getOpacityByTransparency(this.transparency))}},_createShape:function(a){var c=this.options.group.replace(/rootshape/g,this.rootshapeGroupId);this.div=$(q+"\x3cdefs\x3e"+a+c+"\x3c/defs\x3e"+this.options.group.replace(/rootshape/g,this.rootshapeId)+"\x3c/svg\x3e\x3c/div\x3e");
this.div.appendTo(this.element);$(this.rootshapeJQueryId).attr("style",this.options.styleValue.replace("simg",this.options._i+"simg"));this.options.hand&&$(this.rootshapeJQueryId).css("cursor","pointer");if(this.fillcolor)$(this.rootshapeJQueryId).css("fill",this.fillcolor);else if("none"!=this.filllist[0].typeValue){this.element.find(this.rootshapeJQueryId).css("pointer-events","painted");var g=this.filllist[0];if("gradient"==g.typeValue){var l='\x3clinearGradient x1\x3d"'+g.x1+'" y1\x3d"'+g.y1+
'" x2\x3d"'+g.x2+'" y2\x3d"'+g.y2+'"\x3e';_.each(g.stopList,function(n,w){l+='\x3cstop stop-color\x3d"rgb('+n.color.red+","+n.color.green+","+n.color.blue+')" offset\x3d"'+n.position+'%" stop-opacity\x3d"'+(1-n.opacity/100)+'"\x3e\x3c/stop\x3e';1==g.stopList.length&&(l+='\x3cstop stop-color\x3d"rgb('+n.color.red+","+n.color.green+","+n.color.blue+')" offset\x3d"100%" stop-opacity\x3d"'+(1-n.opacity/100)+'"\x3e\x3c/stop\x3e')});l+=" \x3c/linearGradient\x3e";a=this._util.cacheFillSvg(l,"fill_",this.div);
this.element.find(this.rootshapeJQueryId).css("fill","url("+a+")")}else if("solid"==g.typeValue||"white"==g.typeValue)a=g.solidColor,c=$.Color(a.red,a.green,a.blue,1),this.fillColor=this._util.getColorHexString(c),this.element.find(this.rootshapeJQueryId).css("fill","rgb("+a.red+","+a.green+","+a.blue+")")}else this.element.find(this.rootshapeJQueryId).css("fill","url(#sb4FillNone)");$(this.rootshapeJQueryId).css("stroke-width",this.lineWidth);$(this.rootshapeJQueryId).css("stroke",this.linecolor);
$(this.rootshapeJQueryId).css("opacity",this._util.getOpacityByTransparency(this.transparency));this.setTextStyleValue(this.div,-this.options.margin,-this.options.margin,this.options._w+this.getSizeOffset()+2*this.options.margin,this.options._h+this.getSizeOffset()+2*this.options.margin);this.textflow=$("\x3cdiv\x3e").appendTo(this.div);this.textflow.attr("class","notouch");this.textflow.css("opacity",1-this.transparency/100);this.setTextStyleValue(this.textflow,this.options.margin+this.getPosOffset(),
this.options.margin+this.getPosOffset(),this.options._w,this.options._h);this.replaceAttrValue(this.textflow,"overflow","hidden");this.text=$("\x3cdiv\x3e").appendTo(this.textflow);a=this.options._w-2*this.textPadding;0<a&&(this.drawText("shapetext",this.textValue,this.text,this.options.font,this.options.align,this.textColorValue,a,void 0,this.attr,void 0),this.text.attr("class","notouch"),this.setTextPosition(this.text.width(),this.text.height()))},getShadowBounds:function(){var a=1;void 0!=this.scaleValue&&
(a=this.scaleValue/100);var c=this.options,g=this.options.margin-this.getSizeOffset(),l=this.shadowValue.size/100,n=4*this.shadowValue.radius,w=this.shadowValue.angle,y=this.shadowValue.distance,h=(c._w+2*g)*l+2*n;g=(c._h+2*g)*l+2*n;return[(Math.cos(w*Math.PI/180)*y+(c._w-h)/2)*a,(Math.sin(w*Math.PI/180)*y+(c._h-g)/2)*a,h*a,g*a]},setFillColor:function(a){a=this._util.parseColor(a);this.fillcolor=this._util.getColorHexString(a);this._firePaintRequest({fillcolor:this.fillcolor})},getFillColor:function(){return this.fillcolor?
this.fillcolor:this._util.parseColor(this.element.find(this.rootshapeJQueryId).css("fill")).toHexString()},setLineColor:function(a){a=this._util.parseColor(a);this.linecolor=this._util.getColorHexString(a);this._firePaintRequest({linecolor:this.linecolor})},getLineColor:function(){return this.linecolor},setTextColor:function(a){a=this._util.parseColor(a);this.textColorValue=this._util.getColorHexString(a);this._firePaintRequest({textcolor:this.textColorValue})},getTextColor:function(){return this.textColorValue},
setLineWeight:function(a){this.lineWidth=this._util.parseInt(a);this._firePaintRequest({linewidth:this.lineWidth})},getLineWeight:function(){return this.lineWidth},setText:function(a){this.textValue=this._util.parseString(a);this._firePaintRequest({text:this.textValue})},getText:function(){return this.getTextByVar(this.textValue)},highlight:function(a){var c=this.element.find(this.rootshapeJQueryId),g=this.element.find("#highlightshape");a?0==g.length&&(g=c.clone().appendTo(c.parent()),g.attr("id",
"highlightshape"),g.css("fill","orange"),g.css("opacity","0.4"),g.attr("class","notouch"),g.css("pointer-events","")):0<g.length&&g.remove()},refreshScale:function(a,c){if(0<a){a/=100;var g=this.getNormalPos(),l=(this.options._w+this.getSizeOffset())*a;c=(this.options._h+this.getSizeOffset())*a;this.element.css("left",g.left+"px");this.element.css("top",g.top+"px");this.element.css("width",l+"px");this.element.css("height",c+"px");this.scaleValue=100*a;this.setTextStyleValue(this.div,-this.options.margin*
a,-this.options.margin*a,l+2*this.options.margin*a,c+2*this.options.margin*a);this.setTextStyleValue(this.textflow,(this.options.margin+this.getPosOffset())*a,(this.options.margin+this.getPosOffset())*a,this.options._w*a,this.options._h*a);g=this.options._w*a-2*this.textPadding;0<g&&(this.textValue==this.options.text?(this.drawText("shapetext",this.options.text,this.text,this.options.font,this.options.align,this.textColorValue,g,a,this.attr,void 0),c=this.text.width(),g=this.text.height(),this.setTextPosition(c,
g)):(this.setTextStyleValue(this.text,0,0,g,c),c=this.options.font.fontSize,this.options.font.fontSize=c*a,this.drawText("shapetext",this.textValue,this.text,this.options.font,this.options.align,this.textColorValue,-1*g),this.options.font.fontSize=c,c=this.text.width(),g=this.text.height(),this.setTextPosition(c,g),this.options.underline&&this.replaceAttrValue(this.text,"text-decoration","underline")));this.element.find(this.rootshapeJQueryId).attr("transform","translate("+this.getTranslateValue()*
a+","+this.getTranslateValue()*a+") scale("+a+") ");this.getShadowVisibility()&&(this.shadowdiv.attr("style","position:absolute; text-align:center;"),c=this.getShadowBounds(),this.setTextStyleValue(this.shadowdiv,c[1],c[0],c[2],c[3]),this.element.find("#"+this.rootshapeShadowId).attr("transform","scale("+a*this.shadowValue.size/100+") "))}},getScale:function(){return this.scaleValue},setScale:function(a){a=this._util.parseNumber(a);0<a&&(this.oldscaleValue=this.scaleValue,this.scaleValue=a,this._firePaintRequest({scale:this.scaleValue}))},
getTransparency:function(){return this.transparency},setTransparency:function(a){a=this._util.parseNumber(a);this._util.isValidTransparencyValue(a)&&(this.transparency=a,this._firePaintRequest({transparency:this.transparency}))},setAngle:function(a){a=this._util.parseNumber(a);a%=360;a!=this.angle&&(this.angle=a,this.addChangeState("angle",this.angle),this._firePaintRequest({angle:a}))},getAngle:function(){return this.angle},setShadowVisibility:function(a){a=this._util.parseBoolean(a);this.shadowValue.use!==
a&&(this.shadowValue.use=this._util.parseBoolean(a),this._firePaintRequest({shadowVisibility:this.shadowValue.use}))},getShadowVisibility:function(){return this.shadowValue.use},setTextStyleValue:function(a,c,g,l,n){var w="center";switch(this.options.align){case 0:w="left";break;case 1:w="center";break;case 2:w="right"}this.replaceAttrValue(a,"position","absolute");this.removeAttrValue(a,"text-align");null!=l&&this.replaceAttrValue(a,"width",l);null!=n&&this.replaceAttrValue(a,"height",n);null!=c&&
this.replaceAttrValue(a,"top",c);null!=g&&this.replaceAttrValue(a,"left",g);this.replaceAttrValue(a,"text-align",w)},replaceAttrValue:function(a,c,g){if(!(1>a.length)){g=this._util.parseString(g);var l=a.attr("style");void 0==l&&(a.attr("style","position:absolute;"),l=a.attr("style"));if(-1==l.search(c+":absolute"))if(-1==l.search(c))a.attr("style","top"==c||"left"==c||"width"==c||"height"==c?l+(c+":"+g+"px;"):l+(c+":"+g+";"));else{var n=l.substring(0,l.search(c));l=l.substring(l.indexOf(";",l.search(c))+
1,l.length+1);"top"==c||"left"==c||"width"==c||"height"==c?a.attr("style",n+c+":"+g+"px;"+l):a.attr("style",n+c+":"+g+";"+l)}}},removeAttrValue:function(a,c){var g=a.attr("style");if(!(1>a.length)&&(void 0==g&&(a.attr("style","position:absolute;"),g=a.attr("style")),-1!=g.search(c))){var l=g.substring(0,g.search(c));c=g.substring(g.indexOf(";",g.search(c))+1,g.length+1);a.attr("style",l+c)}},getXAPIResult:function(){var a=this._super();a.response=this.clkCnt+"";return a},_paintWidgetShow:function(a){_.has(a,
"text")&&(this.text.empty(),this.textValue=a.text,this.refreshScale(this.scaleValue));_.has(a,"updateTextByVar")&&(this.text.empty(),this.refreshScale(this.scaleValue));_.has(a,"fillcolor")&&(this.fillcolor=a.fillcolor,this.element.find(this.rootshapeJQueryId).css("fill",this.fillcolor));_.has(a,"linecolor")&&(this.linecolor=a.linecolor,this.element.find(this.rootshapeJQueryId).css("stroke",this.linecolor));_.has(a,"textcolor")&&(this.textColorValue=a.textcolor,this.refreshScale(this.scaleValue));
if(_.has(a,"linewidth")){this.lineWidth=a.linewidth;this.element.find(this.rootshapeJQueryId).css("stroke-width",this.lineWidth);var c=$(this.rootshapeJQueryId).find("rect");0!=c.length&&(c=c.eq(0),0==this.lineWidth?(c.attr("width",this.options._w),c.attr("height",this.options._h)):(c.attr("width",this.options._w-1),c.attr("height",this.options._h-1)));this.refreshScale(this.scaleValue)}_.has(a,"scale")&&0<a.scale&&(this.scaleValue=a.scale,this.refreshScale(this.scaleValue));_.has(a,"transparency")&&
(this.transparency=a.transparency,c=1-this.transparency/100,this.textflow.css("opacity",c),this.element.find(this.rootshapeJQueryId).css("opacity",c),this.element.find("#"+this.rootshapeId+"_shadow").css("opacity",c));_.has(a,"angle")&&(this.element.css("offset-path",""),this.element.css("offset-rotate",""),this.element.css("transform","rotate("+this.angle+"deg)"));_.has(a,"shadowVisibility")&&(this.getShadowVisibility()&&this._createShadow(),this.shadowdiv.toggleClass("notVisible",!this.getShadowVisibility()));
this.currentBoundingWidth=this.element.get(0).getBoundingClientRect().width;this.currentBoundingHeight=this.element.get(0).getBoundingClientRect().height;this._super(a)},getFxElement:function(){return this.element},_refreshFxElement:function(){this.getFxElement().find("use").attr("xlink:href",this.getFxElement().find("use").attr("xlink:href"))},getNormalPos:function(){var a={};a.left=parseFloat($(this.element).css("left"));a.top=parseFloat($(this.element).css("top"));var c=this.scaleValue/100,g=this.oldscaleValue/
100;this.scaleValue!=this.oldscaleValue&&(c=g-c,a.left+=c*(this.options._w/2+this.getPosOffset()),a.top+=c*(this.options._h/2+this.getPosOffset()));return a},getLogicalOffset:function(){var a={};if(0==this.angle)a.left=this.getPosOffset(),a.top=this.getPosOffset();else{var c=this.scaleValue/100;a.left=Math.round((this.currentWidth*c-this.currentBoundingWidth)/2)+this.getPosOffset();a.top=Math.round((this.currentHeight*c-this.currentBoundingHeight)/2)+this.getPosOffset()}return a},_init:function(){DEBUG&&
console.log("__init");this._debug("init called");var a=this;this.element.find(this.rootshapeJQueryId).click(function(){void 0!=a.options.link&&""!=a.options.link&&a.handleLinkData(a.options.link);a.clkCnt++;a.fireEvent("onClick")});this.element.find(this.rootshapeJQueryId).dblclick(function(){a.fireEvent("onDoubleClick")});this.element.find(this.rootshapeJQueryId).mouseover(function(){a.fireEvent("onRollover")});this.element.find(this.rootshapeJQueryId).mouseout(function(){a.fireEvent("onRollout")})},
_getRealBounds:function(){var a=this._super();0==this.angle&&(a[0]-=this.getPosOffset(),a[1]-=this.getPosOffset());return a},getPosOffset:function(){return Math.floor(this.lineWidth/2)},getSizeOffset:function(){return 2*this.getPosOffset()},getTranslateValue:function(){return this.options.margin+this.lineWidth/2},addChangeState:function(a,c){this.stateChangeMap[a]=c},setTextPosition:function(a,c){var g=this.textflow.width(),l=this.textflow.height(),n=(g-a)/2;switch(this.options.align){case 0:n=this.textPadding;
break;case 2:n=g-this.textPadding-a}a=c>l?0:0==this.textVerticalAlign?c+this.textPadding>l?l-c:this.textPadding:1==this.textVerticalAlign?(l-c)/2:c+this.textPadding>l?0:l-c-this.textPadding;this.text.css("position","absolute");this.text.css("left",n);this.text.css("top",a)},focus:function(){},drawText:function(a,c,g,l,n,w,y,h,r,v){!0===this.options.shrinkFontSize&&(l.h=this._util.parseInt(this.element.css("height").replace("px","")));this._super(a,c,g,l,n,w,y,h,r,v)}});return f.getShortUIKey()});
define("wgt/com.smartbuilder.axon.widget.text.text/s",["module","underscore","sb4core/sbobj"],function(m,u,q){m=m.config().widgetsvc;var p=m.getShortUIKey();$.widget(m.getFullUIKey(),$.sb4[q],{options:{text:"",underline:!1,align:0,color:"#000000",link:void 0,font:{fontSize:24,fontFamily:"Arial",fontWeight:"",fontStyle:""},canvasheight:0,fixedheight:!1,canvaswidth:0,outborderweight:0,bordercolor:"#000000",bgcolor:"#000000",transparent:!1},_create:function(){var b=this.options;this.textMargin=5;this.element.addClass(p);
this.element.attr("t");this._super();this.applyProfileFlag||(this.flag=null,this.text=b.text,this.scale=1,this.attr={},this.attr.color=this._util.parseColor(b.color));this.widgetWidth=b._w;this.h=this.widgetHeight=b._h;this.w=b._w;this.currentBoundingWidth=this.options.currentBoundingWidth;this.currentBoundingHeight=this.options.currentBoundingHeight;var d=parseInt(this.options._y+(this.currentBoundingHeight-this.widgetHeight)/2),f=parseInt(this.options._x+(this.currentBoundingWidth-this.widgetWidth)/
2);this.angle=this.options.rotation;this.outborderweight=b.outborderweight;this.element.css({left:f-this.outborderweight+"px",top:d-this.outborderweight+"px"});this.element.css("transform","rotate("+this.angle+"deg)");this.attr.textAlign=1==b.align?"center":2==b.align?"right":"left";b.underline&&(this.attr.textDecoration="underline");b.dir&&(this.attr.dir="rtl");this.div=$('\x3cdiv class\x3d"scroll-content"\x3e').appendTo(this.element);this.div.css("position","absolute");this.div.css("overflow","hidden");
this.styleName=b.styleName;u.str.startsWith(this.styleName,"Heading")&&(b=parseInt(this.styleName.substring(7)),NaN!=b&&(this.div.attr("role","heading"),this.div.attr("aria-level",b+"")));1!=this.scale&&(b=this.scale,this.h=b*this.widgetHeight,this.w=b*this.widgetWidth,this.element.css({left:f-(b*this.widgetWidth-this.widgetWidth)/2,top:d-(b*this.widgetHeight-this.widgetHeight)/2,width:b*this.widgetWidth,height:b*this.widgetHeight}))},setText:function(b){this.flag="text";this.text=b=this._util.parseString(b);
this._firePaintRequest()},refreshText:function(b){var d=this.options,f=this.element;if(d.fixedheight){this.div.css("width","auto");var e=this.div.get(0).offsetHeight;e>this.h?(this.div.css("width",this.w-16-this.textMargin+"px"),this.div.css("height","auto"),e=this.div.get(0).offsetHeight,this.div.css("overflow-x","hidden"),this.div.css("overflow-y","scroll"),this.div.data("height",e),this.div.css("height",this.h+"px"),this.element.css("overflow","hidden"),b&&null!==$(this.scrollbar)&&($(this.scrollbar).remove(),
this.scrollbar=null),null==this.scrollbar&&(this.scrollbar=document.createElement("div"),this.element.get(0).appendChild(this.scrollbar)),this.scrollbar.style.width="16px",this.scrollbar.style.height=this.h+"px",this.scrollbar.style.position="absolute",this.scrollbar.style.top="0px",this.scrollbar.style.left=this.w-16+"px",$(this.scrollbar).empty(),$(this.scrollbar).scrollbar(this.div.get(0)),this.div.removeClass("notouch")):(this.div.css("height","auto"),null!=this.scrollbar&&($(this.scrollbar).remove(),
this.scrollbar=null))}else this.div.get(0).scrollHeight>this.div.get(0).clientHeight&&this.div.removeClass("notouch");0<d.outborderweight&&(f.css("border-width",d.outborderweight*this.scale),f.css("border-color",d.bordercolor),f.css("border-style","solid"));d.transparent&&f.css("background-color",d.bgcolor)},getText:function(){return this.getTextByVar(this.text)},getTextColor:function(){return this._util.parseColor(this.attr.color).toHexString(!1)},setTextColor:function(b){this.flag="color";b=this._util.parseColor(b);
this.attr.color=b;this._firePaintRequest()},setScale:function(b){b=this._util.parseNumber(b);b/=100;0<b&&(this.flag="scale",this.scale=b,this._firePaintRequest({scale:b}))},appendText:function(b){b=this._util.parseString(b);this.text+=b;this.flag="appendText";this._firePaintRequest()},appendTextOnNewLine:function(b){b=this._util.parseString(b);this.text=this.text+"\n"+b;this.flag="appendTextOnNewLine";this._firePaintRequest()},setWidgetWidth:function(b){b=this._util.parseInt(b);0<b&&(this.widgetWidth=
b,this.flag="widgetWidth",this._firePaintRequest({widgetWidth:b}))},setWidgetHeight:function(b){b=this._util.parseInt(b);0<b&&(this.widgetHeight=b,this.flag="widgetHeight",this._firePaintRequest({widgetHeight:b}))},isBlank:function(b){return!b||""===$.trim(b)},getLogicalOffset:function(){var b={};b.left=this.outborderweight*this.scale;b.top=this.outborderweight*this.scale;return b},arrayRemove:function(b,d){var f=[];if(isNaN(d)||d>b.length)return!1;for(var e=0;e<b.length;e++)b[e]!=b[d]&&f.push(b[e]);
return f},_init:function(){this._super()},_paintWidgetShow:function(b){var d=this.options,f=!0;if(null===this.flag)1==this.scale?this.div.html()===this.text.replace(/(?:\r\n|\r|\n)/g,"\x3cbr\x3e")?f=!1:this.drawText("",this.text,this.div,d.font,null,this.attr.color,this.w,this.scale,this.attr,d.link):this.drawText("",this.text,this.div,d.font,null,this.attr.color,this.w,this.scale,this.attr,d.link);else{if(u.has(b,"scale")||u.has(b,"widgetWidth")||u.has(b,"widgetHeight")){var e=this.scale,a=parseFloat($(this.element).css("left")),
c=parseFloat($(this.element).css("top")),g=parseFloat($(this.element).css("width")),l=parseFloat($(this.element).css("height")),n=this._util.parseNumber($(this.element).css("border-width").replace("px"));this.h=e*this.widgetHeight;this.w=e*this.widgetWidth;1===e?(e=parseInt(this.options._y+(this.currentBoundingHeight-this.options._h)/2),a=parseInt(this.options._x+(this.currentBoundingWidth-this.options._w)/2),this.element.css({left:a-this.outborderweight,top:e-this.outborderweight,width:this.w,height:this.h})):
this.element.css({left:a-(this.w-g)/2-(this.outborderweight*e-n),top:c-(this.h-l)/2-(this.outborderweight*e-n),width:this.w,height:this.h})}this.drawText("",this.text,this.div,d.font,null,this.attr.color,-this.w,this.scale,this.attr,d.link)}d.dir&&this.div.attr("dir","rtl");f&&this.refreshText(!1);this.setScreenReaderElement(this.getTabElementMap());this.div.hasClass("notouch")&&!this.scrollbar?0==this.getDraggable()&&this.element.addClass("notouch"):this.element.removeClass("notouch");this.flag=
null;this._super(b)},getTabElementMap:function(){var b={};b.texts=this.getTabElementLabel();b.tabElements=this.createTabElement();return b},getTabElementLabel:function(){var b=[];b.push(this.getText());return b},createTabElement:function(){var b=this.options,d=this,f=[];if(b.link){this.div.attr("aria-hidden",!0);var e=this.getScreenReaderTabElement();if(e){var a=e[0];a.css("width",this.div.css("width"));a.css("height",this.div.css("height"));return e}this.tabDiv?this.tabDiv.empty():(this.tabDiv=$("\x3cdiv\x3e").appendTo(this.element),
this.tabDiv.addClass("notouch"));a=$("\x3ca\x3e").appendTo(this.tabDiv);a.css("display","block");a.css("width",this.div.css("width"));a.css("height",this.div.css("height"));a.attr("href",b.link.link);a.click(function(){event.preventDefault();SB4API.linkLib.handleLinkData(d,b.link)});f.push(a)}return f},doSetFocus:function(b){var d=this,f=this.options;f.showFocusRing||$(b).addClass("sb4-not-focus");f.link?this._super(b):(b=$(b),1==SB4API.tabOrder?(this._util.calculateTabindex(),b.attr("tabindex",this.getTabIndex())):
b.attr("tabindex","0"),b.one("blur",function(){b.removeAttr("tabindex");b.off("blur");1<=d.div.children("canvas").length&&b.remove()}),b.focus())},focus:function(){if(this.options.link){var b=this.getScreenReaderTabElement();b&&0!=b.length&&this.doSetFocus(b[0])}else 1<=this.div.children("canvas").length?(b=$("\x3cdiv\x3e"),b.text(this.text),b.css("width",this.div.css("width")),b.css("height",this.div.css("height")),b.css("color","rgba(255,255,255,0)"),b.appendTo(this.element),b.css("position","absolute"),
b.addClass("notouch"),this.doSetFocus(b)):this.doSetFocus(this.div)},setAccessibilityHidden:function(b){this.element.attr("aria-hidden",b);var d=this.getScreenReaderTabElement();if(d&&0!=d.length)for(var f=0;f<d.length;f++)d[f].attr("aria-hidden",b)},_destroy:function(b){this._super(b);this.scrollbar=null},getAngle:function(){return this.angle},getFxElement:function(){return this.element},_getLimitPos:function(){var b=this.getFxElement(),d=this._getRealBounds(),f=[];f.push(d[0]-parseInt(b.css("left")));
f.push(d[1]-parseInt(b.css("top")));return f},_getRealBounds:function(){var b=this.getFxElement(),d=[];if(this.options.fixedheight)d.push(parseInt(b.css("left"))),d.push(parseInt(b.css("top"))),d.push(parseInt(b.css("width"))+this.outborderweight*this.scale*2),d.push(parseInt(b.css("height"))+this.outborderweight*this.scale*2);else{var f=b.find(".scroll-content").eq(0);d.push(parseInt(b.css("left")));d.push(parseInt(b.css("top")));d.push(parseInt(b.css("width"))+this.outborderweight*this.scale*2);
d.push(f.height()+this.outborderweight*this.scale*2)}return this._util.getRotateRect(d,this.getAngle())}});return m.getShortUIKey()});define("lib/css!widgets/com.smartbuilder.axon.widget.text.richtext/style",[],function(){});
define("wgt/com.smartbuilder.axon.widget.text.richtext/s",["module","underscore","sb4core/sbobj","css!widgets/com.smartbuilder.axon.widget.text.richtext/style.css"],function(m,u,q){m=m.config().widgetsvc;var p=m.getShortUIKey();$.widget(m.getFullUIKey(),$.sb4[q],{options:{html:"",canvasheight:0,fixedheight:!1,canvaswidth:0,outborderweight:0,bordercolor:"#000000",bgcolor:"#000000",transparent:!1},_create:function(){var b=this.options;this.element.addClass(p);this._super();this.applyProfileFlag||(this.formathtml=
b.html,this.attr={},this.flag=null);this.widgetWidth=b._w;this.widgetHeight=b._h;this.outborderweight=b.outborderweight;this.element.css({left:b._x-this.outborderweight+"px",top:b._y-this.outborderweight+"px"});var d='\x3cdiv style\x3d"position:absolute"\x3e'+this.formathtml+"\x3c/div\x3e";this.text="";try{var f=$(d),e=f.find("a");u.each(e,function(c,g){g=$(c).children();1==g.length&&(g=g.eq(0).css("color"))&&$(c).css("color",g)});this.text=f.text();this.formathtml=f.html();var a=this.getFirstTextNode(f.get(0));
this.getFirstTextStyle(f.get(0),a,this.attr)}catch(c){}this.div=$('\x3cdiv  class\x3d"scroll-content"\x3e').appendTo(this.element);this.div.css("position","absolute");this.div.css("word-wrap","break-word");this.styleName=b.styleName;u.str.startsWith(this.styleName,"Heading")&&(b=parseInt(this.styleName.substring(7)),NaN!=b&&(this.div.attr("role","heading"),this.div.attr("aria-level",b+"")))},createNewHtml:function(b,d,f){d!=b?(b=this.createNewHtml(b,d.parentNode,f),d=d.cloneNode(!1),b.appendChild(d),
b=d):b=f;return b},deleteStyle:function(b){var d=this;b.css("color","");b.children().each(function(){var f=$(this);d.deleteStyle(f)})},delColorStyle:function(b){if(b.hasChildNodes()){b=b.childNodes;for(var d=0;d<b.length;d++){var f=b[d];1==f.nodeType&&($(f).css("color",""),this.delColorStyle(f))}}},setText:function(b){this.flag="text";this.text=b=this._util.parseString(b);var d=$("\x3cp\x3e");void 0!=this.attr&&u.each(this.attr,function(f,e){d.css(e,f)});d.text(b);this.formathtml=d.get(0).outerHTML;
this._firePaintRequest()},refreshText:function(b){var d=this.options,f=this.element;if(d.fixedheight)this.div.css("height",""),e=this.div.get(0).offsetHeight,e>this.widgetHeight?(this.div.css("width",this.widgetWidth-16-d.scrollerMargin+"px"),this.div.css("height","auto"),e=this.div.get(0).offsetHeight,this.div.data("height",e),this.div.css("overflow-x","hidden"),this.div.css("overflow-y","scroll"),this.div.css("height",this.widgetHeight+"px"),this.element.css("overflow","hidden"),b&&null!==$(this.scrollbar)&&
($(this.scrollbar).remove(),this.scrollbar=null),null==this.scrollbar&&(this.scrollbar=document.createElement("div"),this.scrollbar.style.width="16px",this.scrollbar.style.height=this.widgetHeight+"px",this.scrollbar.style.position="absolute",this.scrollbar.style.top="0px",this.scrollbar.style.left=this.widgetWidth-16+"px",this.element.get(0).appendChild(this.scrollbar)),$(this.scrollbar).empty(),$(this.scrollbar).scrollbar(this.div.get(0)),this.div.removeClass("notouch")):(this.div.css("height",
"auto"),null!=this.scrollbar&&($(this.scrollbar).remove(),this.scrollbar=null));else{var e=this.div.get(0).offsetHeight;e>this.widgetHeight?this.div.css("height",e+"px"):this.div.css("height",this.widgetHeight+"px");0!=this.div.height()&&(f=this.div);this.div.get(0).scrollHeight>this.div.get(0).clientHeight&&this.div.removeClass("notouch")}0<d.outborderweight&&(f.css("border-width",d.outborderweight),f.css("border-color",d.bordercolor),f.css("border-style","solid"));d.transparent&&f.css("background-color",
d.bgcolor)},getText:function(){return this.getTextByVar(this.text)},setTextColor:function(b){null==this.flag&&(this.flag="color");b=this._util.parseColor(b);this.attr.color=b;if(""!=this.div.html()){this.deleteStyle(this.div);for(var d=this.div.children().length,f=0;f<d;f++){var e=this.div.children().eq(f);"hr"!=e.prop("tagName").toLowerCase()&&e.css("color",b)}this.formathtml=this.div.html()}else{var a=$("\x3cdiv\x3e"+this.formathtml+"\x3c/div\x3e");this.deleteStyle(a);d=a.children().length;for(f=
0;f<d;f++)e=a.children().eq(f),"hr"!=e.prop("tagName").toLowerCase()&&e.css("color",b);this.formathtml=a.html();a.remove()}this._firePaintRequest()},appendTextOnNewLine:function(b){b=this._util.parseString(b);this.flag="append";var d=$("\x3cp\x3e");void 0!=this.attr&&u.each(this.attr,function(f,e){d.css(e,f)});null==b||""==b?d.append("\x26nbsp;"):d.text(b);b=$("\x3cdiv\x3e");this.formathtml=this.formathtml+"\n"+d.get(0).outerHTML;b.html(this.formathtml);this.text=b.text();this._firePaintRequest()},
setFormattedText:function(b){this.flag="format";this.formathtml=b=this._util.parseString(b);var d=$("\x3cp\x3e");void 0!=this.attr&&u.each(this.attr,function(f,e){d.css(e,f)});d.html(b);this.text=d.text();this._firePaintRequest()},getFirstTextStyle:function(b,d,f){d!=b?(this.getFirstTextStyle(b,d.parentNode,f),b=d.getAttribute("style"),d=d.getAttribute("dir"),this.getFontStyle(b,f,d)):(b=b.getAttribute("style"),d=d.getAttribute("dir"),this.getFontStyle(b,f,d),void 0==f.fontSize&&(f.fontSize="16px"),
void 0==f.fontFamily&&(f.fontFamily="Arial"),void 0==f.color&&(f.color="#000000"),void 0==f.bgcolor&&(f.bgcolor="#ffffff"))},getFirstTextNode:function(b){var d=null;if(b.hasChildNodes())for(var f=b.childNodes,e=0;e<f.length;e++)if(3!=f[e].nodeType){if(d=this.getFirstTextNode(f[e]),null!=d)break}else if(!this.isBlank(f[e].nodeValue)){d=b;break}return d},isBlank:function(b){return!b||""===$.trim(b)},scroll:function(b,d){if(null!=this.scrollbar){var f=$(this.scrollbar).data("hiddenParth");$(this.scrollbar).data("canDragH");
d=Math.abs(this._util.parseInt(d));var e=-this.div.get(0).scrollTop;e="up"===b?e<-d?e+d:0:e>-f+d?e-d:-f;this.div.get(0).scrollTop=Math.abs(e)}},canScroll:function(b){if(null==this.scrollbar)return!1;var d=this.div.css("top");d=parseInt(d.substring(0,d.length-2));if("up"===b)return 0!=d;b=$(this.scrollbar).data("hiddenParth");return d!=-b},setWidgetWidth:function(b){b=this._util.parseInt(b);0<b&&(this.widgetWidth=b,this.flag="widgetWidth",this._firePaintRequest())},setWidgetHeight:function(b){b=this._util.parseInt(b);
0<b&&(this.widgetHeight=b,this.flag="widgetHeight",this._firePaintRequest())},arrayRemove:function(b,d){var f=[];if(isNaN(d)||d>b.length)return!1;for(var e=0;e<b.length;e++)b[e]!=b[d]&&f.push(b[e]);return f},getLogicalOffset:function(){var b={};b.left=this.outborderweight;b.top=this.outborderweight;return b},getFontStyle:function(b,d,f){if(null!=b){b=b.split(";");for(var e=0;e<b.length;e++){var a=b[e].split(":");"font-size"==a[0].trim()?d.fontSize=a[1].trim():"color"==a[0].trim()?d.color=a[1].trim():
"font-weight"==a[0].trim()?d.fontWeight=a[1].trim():"font-style"==a[0].trim()?d.fontStyle=a[1].trim():"font-family"==a[0].trim()?d.fontFamily=a[1].trim():"margin-left"==a[0].trim()?d.marginLeft=a[1].trim():"margin-right"==a[0].trim()?d.marginRight=a[1].trim():"text-align"==a[0].trim()?d.textAlign=a[1].trim():"background-color"==a[0].trim()?d.bgcolor=a[1].trim():"text-decoration"==a[0].trim()?d.underline=a[1].trim():"isli"==a[0].trim()&&(d.isli=a[1].trim())}}null!=f&&(d.dir=f)},_init:function(){this._debug("init called")},
_paintWidgetShow:function(b){var d=!0,f=!1;null==this.flag?this.div.html()===this.formathtml?d=!1:this.drawRichText("",this.formathtml,this.div,null,this.widgetWidth):"color"==this.flag?this.drawRichText("",this.formathtml,this.div,null,this.widgetWidth,this.attr):"format"==this.flag?this.drawRichText("",this.formathtml,this.div,null,-this.widgetWidth,this.attr):"append"==this.flag?this.drawRichText("",this.formathtml,this.div,null,-this.widgetWidth,this.attr):"widgetWidth"==this.flag||"widgetHeight"==
this.flag?(this.element.css("width",this.widgetWidth+"px"),this.element.css("height",this.widgetHeight+"px"),f=!0,this.drawRichText("",this.formathtml,this.div,null,this.widgetWidth,this.attr)):this.drawText("",this.text,this.div,null,null,null,-this.widgetWidth,null,this.attr);d&&this.refreshText(f);this.setScreenReaderElement(this.getTabElementMap());this.div.hasClass("notouch")&&!this.scrollbar?0==this.getDraggable()&&this.element.addClass("notouch"):this.element.removeClass("notouch");this._super(b)},
getTabElementMap:function(){var b={};b.texts=this.getTabElementLabel();b.tabElements=this.createTabElement();return b},getTabElementLabel:function(){var b=[],d='\x3cdiv style\x3d"position:absolute"\x3e'+this.formathtml+"\x3c/div\x3e";try{var f=$(d),e=$("a",f);if(0<$("a",this.element).length)return b;if(0<e.length)for(d=0;d<e.length;d++)b.push(this.getTextByVar(e.eq(d).text()))}catch(a){}return b},createTabElement:function(){var b=[],d='\x3cdiv style\x3d"position:absolute"\x3e'+this.formathtml+"\x3c/div\x3e";
try{var f=$(d),e=$("a",f),a=$("a",this.element);if(0<a.length)for(var c=0;c<a.length;c++){var g=a.eq(c);b.push(g)}else if(0<e.length)for(c=0;c<e.length;c++){g=e.eq(c);g.text("");g.css("display","block");g.css("width",this.div.css("width"));g.css("height",this.div.css("height"));var l=g.attr("href");u.string.startsWith(l,"evt://")&&(g.removeAttr("onclick"),g.click(function(n){n.preventDefault();if(n=$(this).attr("href")){n=n.split("::");if(void 0!=n[2]&&""!=n[2]){var w=n[2].split(",");void 0==n[0]&&
(n[0]="");void 0==n[1]&&(n[1]="");n[1]=u.string.trim(w[0]," '");w=w.splice(1);n[2]=u.string.trim(w.join()," '")}SB4API.linkLib.openHyperLink(wgt,n[0],n[1],n[2])}}));b.push(g);g.appendTo(this.tabDiv)}}catch(n){}return b},doSetFocus:function(b){this.options.showFocusRing||$(b).addClass("sb4-not-focus");b=$(b);1==SB4API.tabOrder?(this._util.calculateTabindex(),b.attr("tabindex",this.getTabIndex())):b.attr("tabindex","0");b.one("blur",function(){b.removeAttr("tabindex");b.off("blur");b.remove()});b.focus()},
focus:function(){var b=$("\x3cdiv\x3e");b.text(this.text);b.css("color","rgba(255,255,255,0)");b.css("width",this.div.css("width"));b.css("height",this.div.css("height"));b.css("position","absolute");b.addClass("notouch");this.element.append(b);this.doSetFocus(b)},setAccessibilityHidden:function(b){this.element.attr("aria-hidden",b);var d=this.getScreenReaderTabElement();if(d&&0!=d.length)for(var f=0;f<d.length;f++)d[f].attr("aria-hidden",b)},_destroy:function(b){this._super(b);this.scrollbar=null},
getFxElement:function(){return this.element},_getLimitPos:function(){var b=this.getFxElement(),d=this._getRealBounds(),f=[];f.push(d[0]-parseInt(b.css("left")));f.push(d[1]-parseInt(b.css("top")));return f},_getRealBounds:function(){var b=this.getFxElement(),d=[];if(this.options.fixedheight)d.push(parseInt(b.css("left"))),d.push(parseInt(b.css("top"))),d.push(parseInt(b.css("width"))+2*this.outborderweight),d.push(parseInt(b.css("height"))+2*this.outborderweight);else{var f=b.find(".scroll-content").eq(0);
d.push(parseInt(b.css("left")));d.push(parseInt(b.css("top")));d.push(parseInt(b.css("width"))+2*this.outborderweight);d.push(f.height()+2*this.outborderweight)}return d}});return m.getShortUIKey()});define("text!widgets/com.smartbuilder.axon.widget.image/tpl.html",[],function(){return'\x3cimg alt\x3d"" src\x3d"\x3c%- rc.img %\x3e" /\x3e'});define("text!widgets/com.smartbuilder.axon.widget.image/texttpl.html",[],function(){return'\x3cdiv style\x3d"position:absolute;"\x3e\x3c%- rc.text %\x3e\x3c/div\x3e'});
define("lib/css!widgets/com.smartbuilder.axon.widget.image/style",[],function(){});
define("util/jquery-timer",["jquery"],function(m){$.timer=function(u,q,p){this.set=function(b,d,f){this.init=!0;if("object"==typeof b){var e=["autostart","time"],a;for(a in e)void 0!=b[e[a]]&&eval(e[a]+" \x3d func[paramList[arg]]");b=b.action}"function"==typeof b&&(this.action=b);isNaN(d)||(this.intervalTime=d);f&&!this.active&&(this.active=!0,this.setTimer());return this};this.once=function(b){var d=this;isNaN(b)&&(b=0);window.setTimeout(function(){d.action()},b);return this};this.play=function(b){this.active||
(b?this.setTimer():this.setTimer(this.remaining),this.active=!0);return this};this.pause=function(){this.active&&(this.active=!1,this.remaining-=new Date-this.last,this.clearTimer());return this};this.stop=function(){this.active=!1;this.remaining=this.intervalTime;this.clearTimer();return this};this.toggle=function(b){this.active?this.pause():b?this.play(!0):this.play();return this};this.reset=function(){this.active=!1;this.play(!0);return this};this.clearTimer=function(){window.clearTimeout(this.timeoutObject)};
this.setTimer=function(b){var d=this;"function"==typeof this.action&&(isNaN(b)&&(b=this.intervalTime),this.remaining=b,this.last=new Date,this.clearTimer(),this.timeoutObject=window.setTimeout(function(){d.go()},b))};this.go=function(){this.active&&(this.action(),this.setTimer())};if(this.init)return new $.timer(u,q,p);this.set(u,q,p);return this}});
define("wgt/com.smartbuilder.axon.widget.image/s","module sb4core/sbobj text!widgets/com.smartbuilder.axon.widget.image/tpl.html text!widgets/com.smartbuilder.axon.widget.image/texttpl.html css!widgets/com.smartbuilder.axon.widget.image/style.css util/jquery-timer".split(" "),function(m,u,q,p,b,d){var f=m.config().widgetsvc,e=f.getShortUIKey();$.widget(f.getFullUIKey(),$.sb4[u],{options:{textwidth:0,textheight:0,borderweight:0,outborderweight:0,bordercolor:"",captiontext:"",link:"",captionfont:{fontSize:16,
fontFamily:"Arial",fontWeight:"",fontStyle:""},captionlocation:2,source:"",transparency:50,preload:!1,imagewidth:0,imageheight:0,description:"",rotation:0},_create:function(){null==this.stateChangeMap&&(this.stateChangeMap={});DEBUG&&console.log("__create");this.captiontextwidth=-1;this.element.addClass(e);this._super();var a=this.options;(this.ignoreMouseEvents=a.ignoreMouseEvents)&&this.element.css("pointer-events","none");this.applyProfileFlag||(this.oldscaleValue=this.scale=1);this.imageLoad=
!1;this.shadowValue=this._util.getShadowValue(this.options.shadow);this.currentBoundingWidth=a.currentBoundingWidth;this.currentBoundingHeight=a.currentBoundingHeight;this.currentWidth=a._w;this.currentHeight=a._h;this.top=parseInt(this.options._y+this.currentBoundingHeight/2-this.currentHeight/2);this.left=parseInt(this.options._x+this.currentBoundingWidth/2-this.currentWidth/2);_.has(this.stateChangeMap,"angle")||(this.angle=this.options.rotation);_.has(this.stateChangeMap,"outborderweight")||(this.outborderweight=
a.outborderweight);_.has(this.stateChangeMap,"transparency")||(this.transparency=a.transparency);_.has(this.stateChangeMap,"captiontext")||(this.captiontext=a.captiontext);_.has(this.stateChangeMap,"bordercolor")||(this.bordercolor=this._util.parseColor(a.bordercolor));this.borderweight=a.borderweight;this._createContent()},_createShadow:function(){try{if(!this._shadowdiv.hasClass("shadow")){this._shadowdiv.addClass("shadow");var a=this.options,c=a.imagewidth,g=a.imageheight,l=this.normalWidth*this.shadowValue.size/
100,n=this.normalHeight*this.shadowValue.size/100,w=this.normalWidth*this.shadowValue.size/100+8*this.shadowValue.radius,y=this.normalHeight*this.shadowValue.size/100+8*this.shadowValue.radius,h=c*this.shadowValue.size/100+8*this.shadowValue.radius,r=g*this.shadowValue.size/100+8*this.shadowValue.radius;this._shadowdiv.css({width:h*this.scale,height:r*this.scale});var v=$("\x3cdiv\x3e\x3c/div\x3e").appendTo(this._shadowdiv);v.css("position","absolute");v.css("width","100%");v.css("height","100%");
v.css("transform","scale("+this.scale+")");v.css("transform-origin","top left");var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("aria-hidden","true");t.setAttribute("focusable","false");t.setAttribute("width",w);t.setAttribute("height",y);t.style.position="absolute";t.style.top=-(this.normalTop*this.shadowValue.size/100)+"px";t.style.left=-(this.normalLeft*this.shadowValue.size/100)+"px";v.get(0).appendChild(t);var C=document.createElementNS("http://www.w3.org/2000/svg",
"defs");t.appendChild(C);var B=document.createElementNS("http://www.w3.org/2000/svg","clipPath");B.setAttribute("id","clip-"+a._i);C.appendChild(B);var A=document.createElementNS("http://www.w3.org/2000/svg","rect");w={x1:0,x2:1,y1:0,y2:1};a.crop&&(w=JSON.parse(a.crop));if(1==a.flip){var E="scale(-1, 1)";var F=l*(1-w.x2);var G=n*w.y1}else 2==a.flip?(E="scale(1, -1)",F=l*w.x1,G=n*(1-w.y2)):3==a.flip?(E="scale(-1, -1)",F=l*(1-w.x2),G=n*(1-w.y2)):(F=l*w.x1,G=n*w.y1);E&&(this._shadowdiv.css("transform-origin",
"center"),this._shadowdiv.css("transform",E));A.setAttribute("width",c*this.shadowValue.size/100);A.setAttribute("height",g*this.shadowValue.size/100);A.setAttribute("x",F);A.setAttribute("y",G);B.appendChild(A);var z=document.createElementNS("http://www.w3.org/2000/svg","filter");z.setAttribute("id","filter-"+a._i);z.setAttribute("x","0");z.setAttribute("y","0");g=r/g;z.setAttribute("width",h/c*100+"%");z.setAttribute("height",100*g+"%");C.appendChild(z);var x=document.createElementNS("http://www.w3.org/2000/svg",
"feOffset");x.setAttribute("result","offOut");x.setAttribute("in","SourceAlpha");x.setAttribute("dx",4*this.shadowValue.radius);x.setAttribute("dy",4*this.shadowValue.radius);z.appendChild(x);var D=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");D.setAttribute("result","blurOut");D.setAttribute("in","offOut");D.setAttribute("stdDeviation",this.shadowValue.radius);z.appendChild(D);var H=this.shadowValue.color.split(","),J=$.Color(H[0],H[1],H[2],1).toHexString(),N=document.createElementNS("http://www.w3.org/2000/svg",
"feFlood");N.setAttribute("result","floodOut");N.setAttribute("flood-color",J);z.appendChild(N);var P=document.createElementNS("http://www.w3.org/2000/svg","feComposite");P.setAttribute("result","compositeOut");P.setAttribute("in","floodOut");P.setAttribute("in2","blurOut");P.setAttribute("operator","in");z.appendChild(P);var O=document.createElementNS("http://www.w3.org/2000/svg","image");O.setAttribute("width",l);O.setAttribute("height",n);O.setAttribute("href",f.getWidgetAssetURI(a.source));O.setAttribute("fill",
J);O.setAttribute("preserveAspectRatio","none");O.style.opacity=(100-this.shadowValue.alpha)/100;var L=document.createElementNS("http://www.w3.org/2000/svg","g");L.setAttribute("filter","url(#filter-"+a._i+")");var R=document.createElementNS("http://www.w3.org/2000/svg","g");R.setAttribute("clip-path","url(#clip-"+a._i+")");R.appendChild(O);L.appendChild(R);t.appendChild(L)}}catch(Q){}},getShadowLocation:function(){var a=this._util.toRadians(this.shadowValue.angle),c=this.options,g=c.imagewidth;c=
c.imageheight;return[(Math.floor(this.shadowValue.distance*Math.cos(a))+(g-(g*this.shadowValue.size/100+8*this.shadowValue.radius))/2)*this.scale,(Math.floor(this.shadowValue.distance*Math.sin(a))+(c-(c*this.shadowValue.size/100+8*this.shadowValue.radius))/2)*this.scale]},_createContent:function(){this.element.empty();var a=this,c=this.options;this.rotationdiv=$("\x3cdiv\x3e").appendTo(this.element);this.rotationdiv.css("position","absolute");this.rotationdiv.css({top:-this.outborderweight*this.scale,
left:-this.outborderweight*this.scale,width:(c.imagewidth+2*this.outborderweight)*this.scale,height:(c.imageheight+2*this.outborderweight)*this.scale});this.element.css("transform","rotate("+this.angle+"deg)");_.templateSettings.variable="rc";var g=_.template(q),l={img:f.getWidgetAssetURI(c.source)};this._shadowdiv=$("\x3cdiv\x3e").appendTo(this.rotationdiv);this._shadowdiv.css("position","absolute");this._shadowdiv.css("top","0px");this._shadowdiv.css("left","0px");this._shadowdiv.css("width","0px");
this._shadowdiv.css("height","0px");this._shadowdiv.addClass("notouch");this._borderdiv=$("\x3cdiv\x3e").appendTo(this.rotationdiv);this._borderdiv.css("position","absolute");this._borderdiv.attr("aria-hidden","true");this._inslideborderdiv=$("\x3cdiv\x3e").appendTo(this.rotationdiv);this._inslideborderdiv.css("position","absolute");this.element.css({width:c._w*this.scale,height:c._h*this.scale,left:this.left-(c._w*this.scale-c._w)/2,top:this.top-(c._h*this.scale-c._h)/2});""!=this.captiontext&&(this._textbox=
$("\x3cdiv\x3e").appendTo(this.element),this._textbox.css("position","absolute"),this.drawText("",this.captiontext,this._textbox,c.captionfont,0,"#000000",this.captiontextwidth,this.scale),this._textbox.css("transform","rotate(-"+this.angle+"deg)"));""!=c.description&&(this._descbox=$("\x3cdiv\x3e").appendTo(this.element),this._descbox.addClass("notouch"),this._descbox.addClass("sr-only"),this._descbox.text(c.description));g=g(l);this.img=$(g).appendTo(a._borderdiv).get(0);var n;1==c.flip?n="scaleX(-1)":
2==c.flip?n="scaleY(-1)":3==c.flip&&(n="scale(-1, -1)");n&&$(a._borderdiv).css("transform",n);n={x1:0,x2:1,y1:0,y2:1};c.crop&&(n=JSON.parse(c.crop));a.normalWidth=parseInt(Math.round(c.imagewidth/(n.x2-n.x1)));a.normalHeight=parseInt(Math.round(c.imageheight/(n.y2-n.y1)));1==c.flip?(a.normalLeft=parseInt(Math.round(a.normalWidth*(1-n.x2))),a.normalTop=parseInt(Math.round(a.normalHeight*n.y1))):2==c.flip?(a.normalLeft=parseInt(Math.round(a.normalWidth*n.x1)),a.normalTop=parseInt(Math.round(a.normalHeight*
(1-n.y2)))):3==c.flip?(a.normalLeft=parseInt(Math.round(a.normalWidth*(1-n.x2))),a.normalTop=parseInt(Math.round(a.normalHeight*(1-n.y2)))):(a.normalLeft=parseInt(Math.round(a.normalWidth*n.x1)),a.normalTop=parseInt(Math.round(a.normalHeight*n.y1)));$(a.img).attr("width",a.normalWidth*a.scale);$(a.img).attr("height",a.normalHeight*a.scale);$(a.img).css("position","absolute");$(a.img).css("top",0-a.normalTop);$(a.img).css("left",0-a.normalLeft);a.options.hand&&$(a.img).css("cursor","pointer");this.img.onload=
function(){a._borderdiv.css("line-height","");a.getShadowVisibility()&&a._createShadow();a.imageLoad=!0};this.img.onerror=function(){a._borderdiv.text(c.description);a._borderdiv.css("text-align","center")};a._borderdiv.css("overflow","hidden");n=c.imagewidth*this.scale;g=c.imageheight*this.scale;l=c.imageheight*this.scale;var w=(c.imagewidth-2*this.borderweight)*this.scale,y=(c.imageheight-2*this.borderweight)*this.scale;a._borderdiv.css({width:c.imagewidth*this.scale,height:l});a._borderdiv.css("line-height",
l+"px");a._inslideborderdiv.css({width:w,height:y});0!=this.outborderweight&&(a._borderdiv.css("border-width",this.outborderweight*this.scale+"px"),a._borderdiv.css("border-color",this.bordercolor),a._borderdiv.css("border-style","solid"));0!=this.borderweight&&(a._inslideborderdiv.css("border-width",this.borderweight*this.scale+"px"),a._inslideborderdiv.css("border-color",this.bordercolor),a._inslideborderdiv.css("border-style","solid"));l=[0,0];""!=this.captiontext&&(0==this.captiontextwidth?(l[0]=
c.textwidth*this.scale,l[1]=c.textheight*this.scale):(l=a.measureText(this.getCaptionText(),c.captionfont.fontWeight,c.captionfont.fontFamily,c.captionfont.fontSize),l[0]*=this.scale,l[1]*=this.scale,a._textbox.css("overflow","visible"),a._textbox.css("white-space","nowrap")));y=this.shadowy=w=this.shadowx=0;w=this.getShadowLocation();this.shadowx=w[0];this.shadowy=w[1];if(null!=this._textbox){y=this.element.get(0).getBoundingClientRect().top;w=this.outborderweight*this.scale+(n-l[0])/2;y=1==c.captionlocation?
this.outborderweight*this.scale+(g-l[1])/2:0==c.captionlocation?this.outborderweight*this.scale-l[1]+(this._inslideborderdiv.get(0).getBoundingClientRect().top-y):this.outborderweight*this.scale+this._inslideborderdiv.get(0).getBoundingClientRect().bottom-y;if(0!=this.angle){if(0==c.captionlocation||2==c.captionlocation)y-=(this.rotationdiv.get(0).getBoundingClientRect().height-(g+2*this.outborderweight*this.scale))/2;n=this._util.getRotatePoint([n/2,g/2],[w+l[0]/2,y+l[1]/2],360-this.angle);w=n[0]-
l[0]/2;y=n[1]-l[1]/2;this._textbox.css("transform","rotate(-"+this.angle+"deg)")}this._textbox.css("top",y+"px");this._textbox.css("left",w+"px")}this.shadowx+=this.outborderweight*this.scale;this.shadowy+=this.outborderweight*this.scale;a._borderdiv.css("top","0px");a._borderdiv.css("left","0px");a._inslideborderdiv.css("top",this.borderweight*this.scale+"px");a._inslideborderdiv.css("left",this.borderweight*this.scale+"px");this.getShadowVisibility()&&(a._shadowdiv.css("top",this.shadowy+"px"),
a._shadowdiv.css("left",this.shadowx+"px"));this._inslideborderdiv.addClass("notouch");this.element.css("opacity",(100-this.transparency)/100);this._borderdiv.mouseover($.proxy(function(){this.fireEvent("onRollover")},this));this._borderdiv.mouseout($.proxy(function(){this.fireEvent("onRollout")},this));this._borderdiv.click($.proxy(function(){this.fireEvent("onClick");void 0!=this.options.link&&""!=this.options.link&&this.handleLinkData(this.options.link)},this));this._borderdiv.dblclick($.proxy(function(){this.fireEvent("onDoubleClick")},
this));this.setScreenReaderElement(this.getTabElementMap())},_init:function(){DEBUG&&console.log("__init");this._debug("init called")},_changeContent:function(a){var c=this.options;this.rotationdiv.css({top:-this.outborderweight*this.scale,left:-this.outborderweight*this.scale,width:(c.imagewidth+2*this.outborderweight)*this.scale,height:(c.imageheight+2*this.outborderweight)*this.scale});var g=c.imagewidth*this.scale,l=c.imageheight*this.scale;this._inslideborderdiv.css({top:this.borderweight*this.scale,
left:this.borderweight*this.scale,width:(c.imagewidth-2*this.borderweight)*this.scale,height:(c.imageheight-2*this.borderweight)*this.scale});0!=this.borderweight?(this._inslideborderdiv.css("border-width",this.borderweight*this.scale+"px"),this._inslideborderdiv.css("border-color",this.bordercolor),this._inslideborderdiv.css("border-style","solid")):this._inslideborderdiv.css("border","");this._borderdiv.css({top:0,left:0,width:g,height:l});this._borderdiv.css("line-height",l+"px");0!=this.outborderweight?
(this._borderdiv.css("border-width",this.outborderweight*this.scale+"px"),this._borderdiv.css("border-color",this.bordercolor),this._borderdiv.css("border-style","solid")):this._borderdiv.css("border","");null!=this._textbox&&this._textbox.remove();this.imageLoad&&(this.getShadowVisibility()&&(this._shadowdiv.empty(),this._shadowdiv.removeClass("shadow"),this._createShadow(),this._shadowdiv.css("top",this.shadowy*this.scale+"px"),this._shadowdiv.css("left",this.shadowx*this.scale+"px")),$(this.img).attr("width",
this.normalWidth*this.scale),$(this.img).attr("height",this.normalHeight*this.scale),$(this.img).css("top",-(this.normalTop*this.scale)),$(this.img).css("left",-(this.normalLeft*this.scale)));a&&(a=this.getNormalPos(),this.element.css({width:c._w*this.scale,height:c._h*this.scale,left:a.left+"px",top:a.top+"px"}));if(""!=this.captiontext){l=c.imagewidth*this.scale;var n=c.imageheight*this.scale;this._textbox=$("\x3cdiv\x3e").appendTo(this.element);this._textbox.css("position","absolute");this.drawText("",
this.captiontext,this._textbox,c.captionfont,0,"#000000",this.captiontextwidth,this.scale);a=[0,0];0==this.captiontextwidth?(a[0]=c.textwidth*this.scale,a[1]=c.textheight*this.scale):(a=this.measureText(this.getCaptionText(),c.captionfont.fontWeight,c.captionfont.fontFamily,c.captionfont.fontSize),a[0]*=this.scale,a[1]*=this.scale,this._textbox.css("overflow","visible"),this._textbox.css("white-space","nowrap"));var w=this.element.get(0).getBoundingClientRect().top;g=this.outborderweight*this.scale+
(l-a[0])/2;w=1==c.captionlocation?this.outborderweight*this.scale+(n-a[1])/2:0==c.captionlocation?this.outborderweight*this.scale-a[1]+(this._inslideborderdiv.get(0).getBoundingClientRect().top-w):this.outborderweight*this.scale+this._inslideborderdiv.get(0).getBoundingClientRect().bottom-w;if(0!=this.angle){if(0==c.captionlocation||2==c.captionlocation)w-=(this.rotationdiv.get(0).getBoundingClientRect().height-(n+2*this.outborderweight*this.scale))/2;c=this._util.getRotatePoint([l/2,n/2],[g+a[0]/
2,w+a[1]/2],360-this.angle);g=c[0]-a[0]/2;w=c[1]-a[1]/2;this._textbox.css("transform","rotate(-"+this.angle+"deg)")}this._textbox.css("top",w+"px");this._textbox.css("left",g+"px")}},setTransparency:function(a){a=this._util.parseInt(a);100<a&&(a=100);0>a&&(a=0);this.transparency!=a&&(this.transparency=a,this.addChangeState("transparency",this.transparency),this._firePaintRequest({transparency:a}))},getTransparency:function(){return this.transparency},setBorderWeight:function(a){a=this._util.parseInt(a);
5<a&&(a=5);0>a&&(a=0);this.outborderweight=a;this.addChangeState("outborderweight",this.outborderweight);this._firePaintRequest({change:!0})},getBorderWeight:function(){return this.outborderweight},setBorderColor:function(a){a=this._util.parseColor(a);this.bordercolor.toHexString()!=a.toHexString()&&(this.bordercolor=a,this.addChangeState("bordercolor",this.bordercolor),this._firePaintRequest({borderColor:a}))},getBorderColor:function(){return this._util.parseColor(this.bordercolor).toHexString(!1)},
setScale:function(a){a=this._util.parseNumber(a);a/=100;0<a&&(this.oldscaleValue=this.scale,this.scale=a,this._firePaintRequest({scale:a}))},getScale:function(){return 100*this.scale},setCaptionText:function(a){this.captiontext=this._util.parseString(a);this.captiontextwidth=-1;this.addChangeState("captiontext",this.captiontext);this._firePaintRequest({change:!0})},getCaptionText:function(){return this.getTextByVar(this.captiontext)},setShadowVisibility:function(a){a=this._util.parseBoolean(a);this.shadowValue.use!==
a&&(this.shadowValue.use=this._util.parseBoolean(a),this._firePaintRequest({shadowVisibility:this.shadowValue.use}))},getShadowVisibility:function(){return this.shadowValue.use},setIgnoreMouseEvents:function(a){this.ignoreMouseEvents=this._util.parseBoolean(a);this._firePaintRequest({ignoreMouseEvents:this.ignoreMouseEvents})},getIgnoreMouseEvents:function(){return this.ignoreMouseEvents},getNormalPos:function(){var a={};a.left=parseFloat($(this.element).css("left"));a.top=parseFloat($(this.element).css("top"));
if(this.scale!=this.oldscaleValue){var c=this.oldscaleValue-this.scale;a.left+=c*this.options._w/2;a.top+=c*this.options._h/2}return a},getLogicalOffset:function(){var a={};this.currentBoundingWidth&&this.currentWidth?(a.left=Math.round((this.currentWidth-this.currentBoundingWidth)/2),a.top=Math.round((this.currentHeight-this.currentBoundingHeight)/2)):(a.left=0,a.top=0);return a},getFxElement:function(){return this.element},_paintWidgetShow:function(a){_.has(a,"borderColor")&&this._borderdiv.css("border-color",
a.borderColor);_.has(a,"transparency")&&this.element.css("opacity",(100-a.transparency)/100);_.has(a,"change")&&this._changeContent();_.has(a,"scale")&&this._changeContent(!0);_.has(a,"updateTextByVar")&&(this.captiontextwidth=-1,this._changeContent());_.has(a,"ignoreMouseEvents")&&(this.ignoreMouseEvents?this.element.css("pointer-events","none"):this.element.css("pointer-events",""));if(_.has(a,"angle")){this.element.css("offset-path","");this.element.css("offset-rotate","");this.intervalId&&(clearInterval(this.intervalId),
this.element.css("transform","rotate("+this.ratateParam[2]+"deg)"));var c=this,g=this.element[0].style.transform.split("(");g=g[1].substring(0,g[1].length-4);g=parseFloat(g);g=Math.round(10*g);g=(a.angle-g/10)%360;0!=g&&(this.ratateParam=[g%360/10,10,this.angle],this.intervalId=setInterval(function(){c.rotateImage()},40))}_.has(a,"shadowVisibility")&&(this.getShadowVisibility()&&(this._createShadow(),this._shadowdiv.css("top",this.shadowy*this.scale+"px"),this._shadowdiv.css("left",this.shadowx*this.scale+
"px")),this._shadowdiv.toggleClass("notVisible",!this.getShadowVisibility()));this.currentWidth=this._inslideborderdiv.get(0).offsetWidth;this.currentHeight=this._inslideborderdiv.get(0).offsetHeight;this.currentBoundingWidth=this._inslideborderdiv.get(0).getBoundingClientRect().width;this.currentBoundingHeight=this._inslideborderdiv.get(0).getBoundingClientRect().height;this._super(a)},getTabElementMap:function(){var a={};a.texts=this.getTabElementLabel();a.tabElements=this.createTabElement();return a},
getTabElementLabel:function(){return[]},createTabElement:function(){var a=this.options,c=this,g=[];if(a.link){var l=this.getScreenReaderTabElement();if(l){var n=l[0];n.css("width",this.element.css("width"));n.css("height",this.element.css("height"));return l}this.tabDiv?this.tabDiv.empty():(this.tabDiv=$("\x3cdiv\x3e").appendTo(this.element),this.tabDiv.addClass("notouch"));n=$("\x3ca\x3e").appendTo(this.tabDiv);n.css("display","block");n.css("width",this.element.css("width"));n.css("height",this.element.css("height"));
n.attr("href",a.link.link);n.click(function(){event.preventDefault();void 0!=c.options.link&&""!=c.options.link&&c.handleLinkData(c.options.link)});g.push(n)}return g},setAngle:function(a){var c=this._util.parseNumber(a);a=c%360;a!=this.angle&&(this.angle=a,this.addChangeState("angle",this.angle),this._firePaintRequest({angle:c}))},getAngle:function(){return this.angle},rotateImage:function(){var a=this.ratateParam[0],c=this.ratateParam[1],g=this.element[0].style.transform.split("(");g=g[1].substring(0,
g[1].length-4);g=parseFloat(g);g=Math.round(10*g);g/=10;1==c?(this.element.css("transform","rotate("+this.angle+"deg)"),clearInterval(this.intervalId),this.intervalId=this.ratateParam=void 0,this.currentWidth=this._inslideborderdiv.get(0).offsetWidth,this.currentHeight=this._inslideborderdiv.get(0).offsetHeight,this.currentBoundingWidth=this._inslideborderdiv.get(0).getBoundingClientRect().width,this.currentBoundingHeight=this._inslideborderdiv.get(0).getBoundingClientRect().height,this._changeContent()):
(this.ratateParam[1]=c-1,this.element.css("transform","rotate("+(g+a)%360+"deg)"))},focus:function(){if(this.options.link){var a=this.getScreenReaderTabElement();a&&0!=a.length&&this.doSetFocus(a[0])}},addChangeState:function(a,c){this.stateChangeMap[a]=c},_destroy:function(a){$(this.img).off();this._super(a)}});return e});define("text!widgets/com.smartbuilder.axon.widget.button/svg.html",[],function(){return'\x3cdiv\n\tstyle\x3d"position: relative; text-align: center; width: 100%; height: 100%;"\x3e\n\t\x3csvg aria-hidden\x3d"true" focusable\x3d"false" xmlns\x3d"http://www.w3.org/2000/svg"\n\t\txmlns:xlink\x3d"http://www.w3.org/1999/xlink"\n\t\txmlns:svg\x3d"http://www.w3.org/2000/svg"\n\t\tcontentScriptType\x3d"text/ecmascript" display\x3d"block" width\x3d"100%" zoomAndPan\x3d"magnify"\n\t\tcontentStyleType\x3d"text/css" height\x3d"100%" preserveAspectRatio\x3d"none"\n\t\tversion\x3d"1.0"\x3e\n\t\t'});
define("lib/css!widgets/com.smartbuilder.axon.widget.button/style",[],function(){});define("text!widgets/com.smartbuilder.axon.widget.button/text.html",[],function(){return'\x3c/svg\x3e\n\x3cdiv id\x3d"text"\x3e\x3c/div\x3e\n\x3c/div\x3e'});
define("wgt/com.smartbuilder.axon.widget.button/s","module sb4core/sbobj text!widgets/com.smartbuilder.axon.widget.button/svg.html css!widgets/com.smartbuilder.axon.widget.button/style.css text!widgets/com.smartbuilder.axon.widget.button/styles.xml text!widgets/com.smartbuilder.axon.widget.button/text.html".split(" "),function(m,u,q,p,b,d){var f=m.config().widgetsvc,e=f.getShortUIKey();$("#sb4Svg").append(b);$.widget(f.getFullUIKey(),$.sb4[u],{options:{},_create:function(){DEBUG&&console.log("__create");
this.element.addClass(e);this._super();this.applyProfileFlag||(this.clkCnt=0,this.lineColor=this.options.line,this.lineWidth=this.options.lineWidth,this.disabled=this.options.disabled,this.textValue=this.options.text,this.normalColorValue=this.textColorValue=this._util.parseColor(this.options.fontColor),this.transparency=this.options.transparency,this.state=this.options.state);this.rootshapeId=_.uniqueId("rootshape_");this.rootshapeJQueryId="#"+this.rootshapeId;this.rootshapeGroupId=this.rootshapeId+
"_g";this.rootshapeShadowId=this.rootshapeId+"_shadow";this.attr={};this.options.underline&&(this.attr.textDecoration="underline");this.scaleValue=1;var a=this.options._x-this.getPosOffset(),c=this.options._y-this.getPosOffset(),g=this.options._w+this.getSizeOffset(),l=this.options._h+this.getSizeOffset();this.element.css("left",a+"px");this.element.css("top",c+"px");this.element.css("width",g+"px");this.element.css("height",l+"px");this.shadowValue=this._util.getShadowValue(this.options.shadow);
this.shadowdiv=$("\x3cdiv\x3e").prependTo(this.element);this.shadowdiv.css("position","absolute");this.shadowdiv.css("top","0px");this.shadowdiv.css("left","0px");this.shadowdiv.css("width","0px");this.shadowdiv.css("height","0px");this.shadowdiv.addClass("notouch");this.getShadowVisibility()&&this._createShadow();this.filllist=JSON.parse(this.options.filllist);this.stateFillValue=this.options.statefillvalue;this.toggle=this.options.toggle;this.fillMap={};var n=this;_.map(this.filllist,function(h,
r){if("gradient"==h.typeValue){var v='\x3clinearGradient x1\x3d"'+h.x1+'" y1\x3d"'+h.y1+'" x2\x3d"'+h.x2+'" y2\x3d"'+h.y2+'"\x3e';_.each(h.stopList,function(C,B){v+='\x3cstop stop-color\x3d"rgb('+C.color.red+","+C.color.green+","+C.color.blue+')" offset\x3d"'+C.position+'%" stop-opacity\x3d"'+(1-C.opacity/100)+'"\x3e\x3c/stop\x3e';1==h.stopList.length&&(v+='\x3cstop stop-color\x3d"rgb('+C.color.red+","+C.color.green+","+C.color.blue+')" offset\x3d"100%" stop-opacity\x3d"'+(1-C.opacity/100)+'"\x3e\x3c/stop\x3e')});
v+=" \x3c/linearGradient\x3e";var t=n._util.cacheFillSvg(v,"fill_",n.element);n.fillMap[r]="url("+t+")"}else n.fillMap[r]=n.stateFillValue[r]});for(a=0;4>a;a++)c=a+"",_.has(this.fillMap,c)||(this.fillMap[c]=this.fillMap["0"]);c=a="";for(var w=0;4>w;w++){switch(w){case 0:c="normal";break;case 1:c="hover";break;case 2:c="down";break;case 3:c="disabled"}if(null!=this.options[c+"image"]&&0<this.options[c+"image"].length){var y=f.getWidgetAssetURI(this.options[c+"image"]);a+=' \x3cpattern id\x3d"'+this.options._i+
c+'img" patternUnits\x3d"userSpaceOnUse" width\x3d"'+this.options._w+'" height\x3d"'+this.options._h+'"\x3e \x3cimage width\x3d"'+this.options._w+'" height\x3d"'+this.options._h+'" preserveAspectRatio\x3d"none" xlink:href\x3d"'+y+'" \x3e\x3c/image\x3e\x3c/pattern\x3e'}}c=this.options.group.replace(/rootshape/g,this.rootshapeGroupId);this.div=$(q+"\x3cdefs\x3e"+a+c+"\x3c/defs\x3e"+this.options.group.replace(/rootshape/g,this.rootshapeId)+"\x3c/svg\x3e\x3c/div\x3e").appendTo(this.element);$(this.rootshapeJQueryId).attr("style",
this.options.styleValue.replace("simg",this.options._i+"simg"));this.options.hand&&!this.disabled&&$(this.rootshapeJQueryId).css("cursor","pointer");$(this.rootshapeJQueryId).css("stroke-width",this.lineWidth);this.setTextStyleValue(this.div,-this.options.margin,-this.options.margin,this.options._w+this.getSizeOffset()+2*this.options.margin,this.options._h+this.getSizeOffset()+2*this.options.margin);this.element.addClass("notouch");this.element.find(this.rootshapeJQueryId).css("pointer-events","painted");
if(void 0!=this.options.icon&&this.options.icon.isUseIcon){(a=this.options.iconSvg)&&this._util.cacheIconSvg(a,this.options.icon.imageName);a=this.options.icon;if(void 0==a.viewBox||0==a.viewBox.length)a.viewBox="0 0 32 32";this.icon=$('\x3csvg focusable\x3d"false"viewBox\x3d"'+a.viewBox+'"\x3e\x3cuse id\x3d"icon" xlink:href\x3d"#'+a.imageName+'" fill\x3d"'+this._util.parseColor(a.color)+'"\x3e\x3c/use\x3e\x3c/svg\x3e').appendTo(this.div);this.icon.attr("aria-hidden","true");this.icon.attr("class",
"notouch");c=0;switch(a.alignType){case 0:case 3:c=this.options.margin+this.getPosOffset()+a.offset;break;case 1:c=(this.options._w+2*this.options.margin+this.getPosOffset()-a.buttonSize)/2;break;case 2:case 4:c=this.options._w+this.options.margin+this.getPosOffset()-a.buttonSize-a.offset}this.icon.attr("style","position:absolute;top:"+(this.options._h+2*(this.options.margin+this.getPosOffset())-a.buttonSize)/2+"px;left:"+c+"px;width:"+a.buttonSize+"px;height:"+a.buttonSize+"px;");this.icon.css("opacity",
1-this.transparency/100)}this.textflow=$("\x3cdiv\x3e").appendTo(this.div);this.textflow.attr("class","notouch");this.textflow.css("opacity",1-this.transparency/100);this.setTextStyleValue(this.textflow,this.options.margin,this.options.margin,g,l);this.replaceAttrValue(this.textflow,"overflow","hidden");this.text=$("\x3cdiv\x3e").appendTo(this.textflow);g=g-2*this.options.textOffset-this.getIconWidthWithOffset();this.drawText("shapetext",this.textValue,this.text,this.options.font,this.options.align,
this.textColorValue,g,void 0,this.attr,void 0);this.options.showtext?this.text.removeClass("notVisible"):this.text.addClass("notVisible");g=this.text.width();a=this.text.height();c=this.getTextOffset(this.options._w,g);w=(l-a)/2;a>l&&(w=0);this.setTextStyleValue(this.text,w,c,g,a);this.disabled?this.changeState(3):this.changeState(this.state);3!=this.state&&(this.normalShapeStyleValue=this.element.find(this.rootshapeJQueryId).attr("style"),this.normalTransformValue=this.element.find(this.rootshapeJQueryId).attr("transform"),
this.normalClassValue=this.element.find(this.rootshapeJQueryId).attr("class"));this.element.find(this.rootshapeJQueryId).attr("transform","translate("+this.getTranslateValue()+","+this.getTranslateValue()+")");this.applyProfileFlag&&this.fillcolor&&this.setFillColor(this.fillcolor);this.setScreenReaderElement(this.getTabElementMap())},_createShadow:function(){if(!this.shadowdiv.hasClass("shadow")){var a=this.options._w+this.getSizeOffset(),c=this.options._h+this.getSizeOffset();this.shadowdiv.addClass("shadow");
this.shadowdiv.toggleClass("notVisible",!this.getShadowVisibility());this.shadowdiv.html(this._util.createShadowSvg(this.rootshapeShadowId,this.rootshapeGroupId,this.shadowValue,a,c));0<this.options.margin&&($("#"+this.rootshapeShadowId).attr("x",this.options.margin),$("#"+this.rootshapeShadowId).attr("y",this.options.margin));this.shadowdiv.attr("style","position:absolute; text-align:center;");a=this.getShadowBounds();this.setTextStyleValue(this.shadowdiv,a[1],a[0],a[2],a[3])}},getShadowBounds:function(){var a=
this.options,c=this.options.margin-this.getSizeOffset(),g=this.shadowValue.size/100,l=4*this.shadowValue.radius,n=this.shadowValue.angle,w=this.shadowValue.distance,y=(a._w+2*c)*g+2*l;c=(a._h+2*c)*g+2*l;return[Math.cos(n*Math.PI/180)*w+(a._w-y)/2,Math.sin(n*Math.PI/180)*w+(a._h-c)/2,1*y,1*c]},clearFillColor:function(){this.element.find("#rootshape").css("fill","")},setFillImage:function(a){var c="normal";if(void 0!=this.filllist[a])switch(a){case 0:c="normal";break;case 1:c="hover";break;case 2:c=
"down";break;case 3:c="disabled"}this.element.find(this.rootshapeJQueryId).css("fill","url(#"+this.options._i+c+"img)")},setSolidFillColor:function(a){a=this._util.parseColor(a);a=a.toHexString(255).substring(0,7);this.element.find(this.rootshapeJQueryId).css("fill",a)},setFillColor:function(a){this.setSolidFillColor(a);this.fillcolor=this._util.getColorHexString(a);this._firePaintRequest({fillcolor:a})},getFillColor:function(){return this.fillcolor?this.fillcolor:this._util.parseColor(this.element.find(this.rootshapeJQueryId).css("fill")).toHexString()},
setLineColor:function(a){this.lineColor=this._util.parseColor(a);this._firePaintRequest({linecolor:this.lineColor})},getLineColor:function(){return this.lineColor},setTextColor:function(a){a=this._util.parseColor(a);this._firePaintRequest({textcolor:a})},getTextColor:function(){return this.textColorValue},setLineWeight:function(a){this.lineWidth=this._util.parseInt(a);this._firePaintRequest({linewidth:this.lineWidth})},getLineWeight:function(){return this._util.parseInt(this.lineWidth)},setText:function(a){this.textValue=
a=this._util.parseString(a);this._firePaintRequest({text:a})},getText:function(){return this.getTextByVar(this.textValue)},setShadowVisibility:function(a){a=this._util.parseBoolean(a);this.shadowValue.use!==a&&(this.shadowValue.use=this._util.parseBoolean(a),this._firePaintRequest({shadowVisibility:this.shadowValue.use}))},getShadowVisibility:function(){return this.shadowValue.use},getScale:function(){return this.scaleValue},setScale:function(a){a=this._util.parseNumber(a);if(0<a){var c=(this.getPosOffset()+
this.options.margin)*a,g=this.getPos().left-this.getPosOffset()+Math.floor((1-a)*this.options._w/2),l=this.getPos().top-this.getPosOffset()+Math.floor((1-a)*this.options._h/2),n=(this.options._w+this.getSizeOffset())*a,w=(this.options._h+this.getSizeOffset())*a;this.element.css("left",g+"px");this.element.css("top",l+"px");this.element.css("width",n+"px");this.element.css("height",w+"px");this.scaleValue=a;this.setTextStyleValue(this.div,-this.options.margin*a,-this.options.margin*a,n+2*this.options.margin*
a,w+2*this.options.margin*a);this.setTextStyleValue(this.textflow,c-this.getPosOffset()*a,c-this.getPosOffset()*a,n,w);c=n-2*this.options.textOffset-this.getIconWidthWithOffset();this.textValue==this.options.text?(this.drawText("shapetext",this.options.text,this.text,this.options.font,this.options.align,this.textColorValue,c,a,this.attr,void 0),a=this.text.width(),c=this.text.height()):(this.setTextStyleValue(this.text,0,0,n-2*this.options.textOffset,w),g=this.options.font.fontSize,this.options.font.fontSize=
g*a,this.drawText("shapetext",this.textValue,this.text,this.options.font,this.options.align,this.textColorValue,-1*c),this.options.font.fontSize=g,a=this.text.css("width").replace("px",""),c=this.text.css("height").replace("px",""),this.options.underline&&this.replaceAttrValue(this.text,"text-decoration","underline"));a>n&&(a=n);c>w&&(c=w);n=this.getTextOffset(n,a);this.setTextStyleValue(this.text,(w-c)/2,n,a,c);this.element.find(this.rootshapeJQueryId).attr("transform","translate("+this.getTranslateValue()+
","+this.getTranslateValue()+")")}},getTransparency:function(){return this.transparency},setTransparency:function(a){a=this._util.parseNumber(a);this._firePaintRequest({transparency:a})},getEnabled:function(){return!this.disabled},setEnabled:function(a){a=this._util.parseBoolean(a);this.disabled=!a;this._firePaintRequest({enabled:a})},getSelected:function(){return this.toggle&&2==this.state?!0:!1},setSelected:function(a){3!=this.state&&(a=this._util.parseBoolean(a),this._firePaintRequest({selected:a}))},
changeState:function(a){this.state=a;this.removeAttrValue(this.element.find(this.rootshapeJQueryId),"filter");this.removeAttrValue(this.element.find("#icon"),"filter");this.element.find(this.rootshapeJQueryId).attr("transform",this.normalTransformValue);this.element.find(this.rootshapeJQueryId).attr("class",this.normalClassValue);this.options.hand&&3!=a?this.element.find(this.rootshapeJQueryId).css("cursor","pointer"):this.element.find(this.rootshapeJQueryId).css("cursor","");if(void 0!=this.filllist[a]){if(this.element.find(this.rootshapeJQueryId).attr("style",
this.normalShapeStyleValue),this.changeFillType(this.filllist[a].typeValue,this.stateFillValue[a],a),this.element.find(this.rootshapeJQueryId).css("fill-opacity",""),"solid"==this.filllist[a].typeValue){var c=this._util.parseInt(this.filllist[a].opacity);0<c&&this.element.find(this.rootshapeJQueryId).css("fill-opacity",this._util.getOpacityByTransparency(c))}}else{this.changeFillType(this.filllist[0].typeValue,this.stateFillValue[0],a);switch(a){case 1:c="";if("gradient"==this.filllist[0].typeValue&&
1<this.filllist[0].stopList.length)this.replaceAttrValue(this.element.find(this.rootshapeJQueryId),"filter","url(#buttondarksvg)");else{if("gradient"==this.filllist[0].typeValue&&1==this.filllist[0].stopList.length)c=this.checkWhite(this.filllist[0].stopList[0].color,a,!0);else if("solid"==this.filllist[0].typeValue)(c=this.filllist[0].solidColor)||(c=this.getFillColor()),c=this.checkWhite(c,a,!0);else if("white"==this.filllist[0].typeValue){var g=this.getLineWeight();c=this.getLineColor();0==g&&
(c=this.normalColorValue);c=this.checkWhite(c,a,!0)}else"none"==this.filllist[0].typeValue&&this.options.hoverDefaultColor&&(this.textColorValue=this.checkWhite(this.normalColorValue,a,!0));0!=c.length?this.element.find(this.rootshapeJQueryId).css("fill",c):this.element.find(this.rootshapeJQueryId).css("filter","url(#buttondarksvg)")}break;case 2:"gradient"==this.filllist[0].typeValue&&1<this.filllist[0].stopList.length||(c="","gradient"==this.filllist[0].typeValue&&1==this.filllist[0].stopList.length?
c=this.checkWhite(this.filllist[0].stopList[0].color,a,!0):"solid"==this.filllist[0].typeValue?((c=this.filllist[0].solidColor)||(c=this.getFillColor()),c=this.checkWhite(c,a,!0)):"white"==this.filllist[0].typeValue?(g=this.getLineWeight(),c=this.getLineColor(),0==g&&(c=this.normalColorValue),c=this.checkWhite(c,a,!0)):"none"==this.filllist[0].typeValue&&this.options.hoverDefaultColor&&(this.textColorValue=this.checkWhite(this.normalColorValue,a,!0)),0!=c.length?this.element.find(this.rootshapeJQueryId).css("fill",
c):this.element.find(this.rootshapeJQueryId).css("filter","url(#buttonlightsvg)"));break;case 3:this.replaceAttrValue(this.element.find(this.rootshapeJQueryId),"filter","url(#buttongarysvg)"),this.options.disabledDefaultColor&&(this.replaceAttrValue(this.element.find("#icon"),"filter","url(#buttongarysvg)"),this.textColorValue=this.colorLuminance(this.normalColorValue,-.05,!0))}this.element.find(this.rootshapeJQueryId).css("fill-opacity","");"solid"==this.filllist[0].typeValue&&(c=this._util.parseInt(this.filllist[0].opacity),
0<c&&this.element.find(this.rootshapeJQueryId).css("fill-opacity",this._util.getOpacityByTransparency(c)))}0==a?(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.icon.color)),this.textColorValue=this.normalColorValue,this.element.find(this.rootshapeJQueryId).css("stroke",this.lineColor)):1==a?this.options.hoverDefaultColor?(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.icon.color)),this.textColorValue=this.normalColorValue,this.element.find(this.rootshapeJQueryId).css("stroke",
this.lineColor)):(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.hoverIconColor)),this.textColorValue=this._util.parseColor(this.options.hoverFontColor),this.element.find(this.rootshapeJQueryId).css("stroke",this.options.hoverLineColor)):2==a?this.options.downDefaultColor?(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.icon.color)),this.textColorValue=this.normalColorValue,this.element.find(this.rootshapeJQueryId).css("stroke",this.lineColor)):
(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.downIconColor)),this.textColorValue=this._util.parseColor(this.options.downFontColor),this.element.find(this.rootshapeJQueryId).css("stroke",this.options.downLineColor)):3!=a||this.options.disabledDefaultColor||(this.element.find("#icon").attr("fill",this._util.parseColor(this.options.disabledIconColor)),this.textColorValue=this._util.parseColor(this.options.disabledFontColor),this.element.find(this.rootshapeJQueryId).css("stroke",
this.options.disabledLineColor));g=this.scaleValue;c=(this.options._w+this.getSizeOffset())*g;a=(this.options._h+this.getSizeOffset())*g;var l=c-2*this.options.textOffset-this.getIconWidthWithOffset();if(this.textValue==this.options.text)this.drawText("shapetext",this.options.text,this.text,this.options.font,this.options.align,this.textColorValue,l,g,this.attr,void 0),g=this.text.width(),l=this.text.height();else{this.setTextStyleValue(this.text,0,0,c-2*this.options.textOffset,a);var n=this.options.font.fontSize;
this.options.font.fontSize=n*g;this.drawText("shapetext",this.textValue,this.text,this.options.font,this.options.align,this.textColorValue,-1*l);this.options.font.fontSize=n;g=this.text.css("width").replace("px","");l=this.text.css("height").replace("px","");this.options.underline&&this.replaceAttrValue(this.text,"text-decoration","underline")}c=this.getTextOffset(c,g);n=(a-l)/2;l>a&&(n=0);this.setTextStyleValue(this.text,n,c,g,l);this.element.find(this.rootshapeJQueryId).attr("transform","translate("+
this.getTranslateValue()+","+this.getTranslateValue()+")");this.toggle&&this.setScreenReaderElement(this.getTabElementMap())},checkWhite:function(a,c,g){1==c?(c=jQuery.Color(a).lightness(),c+=.3*(1-c),1<c&&(c=1),a=jQuery.Color(a).lightness(c)):2==c&&(c=jQuery.Color(a).lightness(),c-=.3*c,0>c&&(c=0),a=jQuery.Color(a).lightness(c));return a},changeWhiteFillType:function(a,c){this.textColorValue=this.textColorValue;switch(c){case 0:this.setSolidFillColor(a);this.removeAttrValue(this.element.find(this.rootshapeJQueryId),
"filter");this.removeAttrValue(this.element.find("#icon"),"filter");break;case 1:this.setSolidFillColor(this.options.line);this.replaceAttrValue(this.element.find(this.rootshapeJQueryId),"filter","url(#buttonlightsvg)");this.removeAttrValue(this.element.find("#icon"),"filter");break;case 2:this.setSolidFillColor(this.options.line);this.replaceAttrValue(this.element.find(this.rootshapeJQueryId),"filter","url(#buttondarksvg)");this.removeAttrValue(this.element.find("#icon"),"filter");break;case 3:this.setSolidFillColor(a);
this.replaceAttrValue(this.element.find(this.rootshapeJQueryId),"filter","url(#buttongarysvg)");this.options.disabledDefaultColor&&(this.replaceAttrValue(this.element.find("#icon"),"filter","url(#buttongarysvg)"),this.textColorValue=this.colorLuminance(this.normalColorValue,-.05,!0));break;default:this.setSolidFillColor(a),this.removeAttrValue(this.element.find(this.rootshapeJQueryId),"filter"),this.removeAttrValue(this.element.find("#icon"),"filter")}},changeFillType:function(a,c,g){this.clearFillColor();
switch(a){case "gradient":this.element.find(this.rootshapeJQueryId).css("fill",this.fillMap[g]);break;case "white":1<c.split(" | ").length?(c.split(" | "),a=c.split(" | ")[1],this.setSolidFillColor(a)):this.setSolidFillColor(c);break;case "solid":1<c.split(" | ").length?(c.split(" | "),a=c.split(" | ")[1],this.setSolidFillColor(a)):this.setSolidFillColor(c);break;case "image":1<c.split(" | ").length&&(c.split(" | "),c.split(" | "));this.setFillImage(g);break;case "none":this.element.find(this.rootshapeJQueryId).css("fill",
"url(#sb4FillNone)")}},hexToRgb:function(a){a=this._util.parseColor(a);return[a._rgba[0],a._rgba[1],a._rgba[2]]},colorLuminance:function(a,c,g){a=this._util.parseColor(a);if(g&&(a=this.hexToRgb(a),g=(a[0]+a[1]+a[2])/3,a=this.rgbToHex(g,g,g),0==g))return"#808080";a=String(a).replace(/[^0-9a-f]/gi,"");6>a.length&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);c=c||0;g="#";var l;for(l=0;3>l;l++){var n=parseInt(a.substr(2*l,2),16);n=Math.round(Math.min(Math.max(0,n+n*c),255)).toString(16);g+=("00"+n).substr(n.length)}return g},
componentToHex:function(a){a=a.toString(16);return 1==a.length?"0"+a:a},rgbToHex:function(a,c,g){return"#"+this.componentToHex(a)+this.componentToHex(c)+this.componentToHex(g)},setTextStyleValue:function(a,c,g,l,n){var w="center";switch(this.options.align){case 0:w="left";break;case 1:w="center";break;case 2:w="right"}this.replaceAttrValue(a,"position","absolute");this.removeAttrValue(a,"text-align");null!=l&&this.replaceAttrValue(a,"width",l);null!=n&&this.replaceAttrValue(a,"height",n);null!=c&&
this.replaceAttrValue(a,"top",c);null!=g&&this.replaceAttrValue(a,"left",g);this.replaceAttrValue(a,"text-align",w)},replaceAttrValue:function(a,c,g){if(!(1>a.length)){g=this._util.parseString(g);var l=a.attr("style");void 0==l&&(a.attr("style","position:absolute;"),l=a.attr("style"));if(-1==l.search(c+":absolute"))if(-1==l.search(c))a.attr("style","top"==c||"left"==c||"width"==c||"height"==c?l+(c+":"+g+"px;"):l+(c+":"+g+";"));else{var n=l.substring(0,l.search(c));l=l.substring(l.indexOf(";",l.search(c))+
1,l.length+1);"top"==c||"left"==c||"width"==c||"height"==c?a.attr("style",n+c+":"+g+"px;"+l):a.attr("style",n+c+":"+g+";"+l)}}},removeAttrValue:function(a,c){var g=a.attr("style");if(!(1>a.length)&&(void 0==g&&(a.attr("style","position:absolute;"),g=a.attr("style")),-1!=g.search(c))){var l=g.substring(0,g.search(c));c=g.substring(g.indexOf(";",g.search(c))+1,g.length+1);a.attr("style",l+c)}},highlight:function(a){var c=this.element.find(this.rootshapeJQueryId),g=this.element.find("#highlightshape");
a?0==g.length&&(g=c.clone().appendTo(c.parent()),g.attr("id","highlightshape"),g.css("fill","#c77405"),g.css("opacity","0.5"),g.attr("class","notouch"),g.css("pointer-events","")):0<g.length&&g.remove()},getFxElement:function(){return this.element},_refreshFxElement:function(){for(var a=this.getFxElement().find("use"),c=0;c<a.length;c++){var g=a.eq(c);g.attr("xlink:href",g.attr("xlink:href"))}},_paintWidgetHide:function(a){this.disabled?this.changeState(3):this.changeState(0);this._super(a)},_paintWidgetShow:function(a){_.has(a,
"enabled")&&(a.enabled?(this.disabled=!1,this.changeState(0)):(this.disabled=!0,this.changeState(3)),this.setScreenReaderElement(this.getTabElementMap()));_.has(a,"selected")&&this.toggle&&(a.selected?this.changeState(2):this.changeState(0));_.has(a,"fillcolor")&&(this.filllist[0].typeValue="solid",-1!=this.stateFillValue[0].indexOf("style")?-1!=this.stateFillValue[0].indexOf("|")?this.stateFillValue[0]=this.stateFillValue[0].split("|")[0]+"| "+a.fillcolor:this.stateFillValue[0]=this.stateFillValue[0]+
" | "+a.fillcolor:this.stateFillValue[0]=a.fillcolor);_.has(a,"linecolor")&&this.element.find(this.rootshapeJQueryId).css("stroke",a.linecolor);if(_.has(a,"linewidth")){this.lineWidth=a.linewidth;this.element.find(this.rootshapeJQueryId).css("stroke-width",this.lineWidth);var c=$(this.rootshapeJQueryId).find("rect");0!=c.length&&(c=c.eq(0),0==this.lineWidth?(c.attr("width",this.options._w),c.attr("height",this.options._h)):(c.attr("width",this.options._w-1),c.attr("height",this.options._h-1)));this.setScale(this.scaleValue)}_.has(a,
"text")&&(this.text.empty(),this.textValue=a.text,this.setScale(this.scaleValue),this.setScreenReaderElement(this.getTabElementMap()));_.has(a,"updateTextByVar")&&(this.text.empty(),this.setScale(this.scaleValue),this.setScreenReaderElement(this.getTabElementMap()));_.has(a,"textcolor")&&(this.normalColorValue=this.textColorValue=a.textcolor.toHexString(255).substring(0,7),this.setScale(this.scaleValue));_.has(a,"transparency")&&(this.transparency=a.transparency,c=1-this.transparency/100,this.textflow.css("opacity",
c),this.setStyleTransparency(this.rootshapeId,c),this.setStyleTransparency("shadow",c),this.setStyleTransparency("icon",c));_.has(a,"shadowVisibility")&&(this.getShadowVisibility()&&this._createShadow(),this.shadowdiv.toggleClass("notVisible",!this.getShadowVisibility()));3!=this.state&&(this.normalShapeStyleValue=this.element.find(this.rootshapeJQueryId).attr("style"),this.normalTransformValue=this.element.find(this.rootshapeJQueryId).attr("transform"));this._super(a)},_init:function(){DEBUG&&console.log("__init");
this._debug("init called");var a=this;this.element.find(this.rootshapeJQueryId).click(function(){3!=a.state&&(void 0!=a.options.link&&""!=a.options.link&&a.handleLinkData(a.options.link),a.clkCnt++,a.fireEvent("onClick"))});this.element.find(this.rootshapeJQueryId).on("vmousedown",function(){3!=a.state&&(a.toggle?(2==a.state?a.changeState(1):a.changeState(2),a.setScreenReaderElement(a.getTabElementMap())):a.changeState(2))});this.element.find(this.rootshapeJQueryId).on("vmouseup",function(){3!=a.state&&
(a.toggle||a.changeState(1))});this.element.find(this.rootshapeJQueryId).dblclick(function(){3!=a.state&&a.fireEvent("onDoubleClick")});this.element.find(this.rootshapeJQueryId).on("vmouseover",function(){3!=a.state&&(a.toggle?2!=a.state&&a.changeState(1):a.changeState(1),a.fireEvent("onRollover"))});this.element.find(this.rootshapeJQueryId).on("vmouseout",function(){3!=a.state&&(a.toggle?2!=a.state&&a.changeState(0):a.changeState(0),a.fireEvent("onRollout"))})},getTabElementMap:function(){var a=
{};a.texts=this.getTabElementLabel();a.tabElements=this.createTabElement();return a},getTabElementLabel:function(){var a=[];_.isEmpty(this.textValue)?a.push(this.getTextByVar(this.options._n)):a.push(this.getTextByVar(this.textValue));return a},changeDeviceButtonToggle:function(){var a=$("button",this.element),c=a.eq(0).attr("aria-pressed");c="false"==c?!0:!1;a.eq(0).attr("aria-pressed",c)},createTabElement:function(){var a=this.getScreenReaderTabElement();if(a){var c=a[0];this.disabled?c.attr("disabled",
"disabled"):c.removeAttr("disabled");this.toggle&&(2==this.state?c.attr("aria-pressed",!0):c.attr("aria-pressed",!1));return a}a=[];this.tabDiv?this.tabDiv.empty():(this.tabDiv=$("\x3cdiv\x3e").prependTo(this.element),this.tabDiv.css("width","100%"),this.tabDiv.css("height","100%"),this.tabDiv.addClass("notouch"));c=$("\x3cbutton\x3e").appendTo(this.tabDiv);this.disabled&&c.attr("disabled","disabled");this.toggle&&(2==this.state?c.attr("aria-pressed",!0):c.attr("aria-pressed",!1));var g=this;c.click(function(){3!=
g.state&&(void 0!=g.options.link&&""!=g.options.link&&g.handleLinkData(g.options.link),g.toggle&&(2==g.state?g.changeState(1):g.changeState(2),g.setScreenReaderElement(g.getTabElementMap())),g.clkCnt++,g.fireEvent("onClick"))});c.dblclick(function(){3!=g.state&&g.fireEvent("onDoubleClick")});c.focus(function(l){g.fireEvent("onFocus")});a.push(c);return a},focus:function(){var a=this.getScreenReaderTabElement();a&&0!=a.length&&this.doSetFocus(a[0])},getXAPIResult:function(){var a=this._super();a.response=
this.clkCnt+"";return a},getLogicalOffset:function(){var a={};a.left=this.getPosOffset();a.top=this.getPosOffset();return a},setStyleTransparency:function(a,c){this.element.find("#"+a).css("opacity",c)},getPosOffset:function(){return Math.floor(this.lineWidth/2)},getSizeOffset:function(){return 2*this.getPosOffset()},getTranslateValue:function(){return this.options.margin+this.lineWidth/2},getIconWidthWithOffset:function(){var a=0,c=this.options.icon;void 0!=c&&c.isUseIcon&&(a=c.offset+c.buttonSize);
return a},getTextOffset:function(a,c){var g=0,l=this.options.icon;if(void 0!=l&&l.isUseIcon)switch(l.alignType){case 0:case 1:case 2:switch(this.options.align){case 0:g=this.options.textOffset;break;case 1:g=(a-c)/2;break;case 2:g=a-this.options.textOffset-c}break;case 3:switch(this.options.align){case 0:g=this.options.textOffset+this.getIconWidthWithOffset();break;case 1:g=(a-c)/2+this.getIconWidthWithOffset()/2;break;case 2:g=a-this.options.textOffset-c}break;case 4:switch(this.options.align){case 0:g=
this.options.textOffset;break;case 1:g=(a-c)/2-this.getIconWidthWithOffset()/2;break;case 2:g=a-this.options.textOffset-c-this.getIconWidthWithOffset()}}else switch(this.options.align){case 0:g=this.options.textOffset;break;case 1:g=(a-c)/2;break;case 2:g=a-this.options.textOffset-c}return g},drawText:function(a,c,g,l,n,w,y,h,r,v){!0===this.options.shrinkFontSize&&(l.h=this._util.parseInt(this.element.css("height").replace("px","")));this._super(a,c,g,l,n,w,y,h,r,v)}});return f.getShortUIKey()});
define("sb4core/init-post","sb4core/loplayer image sb4core/syscheck sb4core/DataUtil lib/FileSaver.min sb4core/linkhandler wgt/com.smartbuilder.axon.widget.frame/s wgt/com.smartbuilder.axon.widget.slideset/s wgt/com.smartbuilder.axon.widget.slide/s wgt/com.smartbuilder.axon.widget.shape/s wgt/com.smartbuilder.axon.widget.text.text/s wgt/com.smartbuilder.axon.widget.text.richtext/s wgt/com.smartbuilder.axon.widget.image/s wgt/com.smartbuilder.axon.widget.button/s".split(" "),function(m,u,q,p){function b(f,
e){if(!(f instanceof Date))return"";var a={M:f.getMonth()+1,d:f.getDate(),D:f.getDate(),h:f.getHours(),m:f.getMinutes(),s:f.getSeconds(),y:f.getFullYear(),Y:f.getFullYear()};f=function(c,g){var l=[];for(k in c)l.push(k);return l.join(g)}(a,"+|")+"+";return e=e.replace(new RegExp(f,"g"),function(c){var g=a[c.slice(-1)],l=c.length;0>c.indexOf("y")&&0>c.indexOf("Y")&&(l=Math.max(c.length,g.toString().length));return((g.toString().length<c.length?"0".repeat(l):"")+g).slice(-l)})}SB4API.stageLog("init-post finished");
var d;SB4API.showLoading=function(){SB4API.stageLog("showLoading 1");"none"==$("#fullscreen").css("display")&&(d||(d=setTimeout(function(){SB4API.stageLog("showLoading 2");$("#fullscreen").show();clearTimeout(d);d=void 0},500)))};SB4API.hideLoading=function(){SB4API.stageLog("hideLoading 1");d&&(clearTimeout(d),d=void 0);"none"!=$("#fullscreen").css("display")&&(SB4API.stageLog("hideLoading 2"),$("#fullscreen").hide())};SB4API.showLoadingWithOpacity=function(){SB4API.stageLog("showLoadingWithOpacity");
SB4API.showLoading();$("#fullscreen").css("background-color","rgba(218, 218, 218, 0)")};SB4API.hideLoadingWithOpacity=function(){SB4API.stageLog("hideLoadingWithOpacity");SB4API.hideLoading();$("#fullscreen").css("background-color","")};createjs.TagRequest.prototype._handleTimeout=function(){this._clean();this.dispatchEvent(new createjs.Event("error"))};null==SB4API.functions&&(SB4API.functions={});SB4API.functions.getTimeStamp=function(f){return(new Date).getTime()};SB4API.functions.getTime=function(f,
e){e+="";var a=parseInt(e);!isNaN(a)&&null!=e&&0<e.indexOf("Z")&&0<e.indexOf("T")&&(a=Date.parse(e));if(isNaN(a))if(_.str.startsWith(e,"UTC")){a=0;if(4<e.length){var c=!1;"-"==e.charAt(3)&&(c=!0);e=e.substring(4);_.str.contains(e,":")?(a=e.split(":"),e=parseInt(a[0]),isNaN(e)?e=0:(e=Math.max(0,e),e=Math.min(12,e)),a=parseInt(a[1]),isNaN(a)?a=0:(a=Math.max(0,a),a=Math.min(59,a)),a=60*e+a):(e=parseInt(e),isNaN(e)?e=0:(e=Math.max(0,e),e=Math.min(12,e)),a=60*e)}c&&(a=-a);e=a;c=new Date;a=-c.getTimezoneOffset();
e-=a;c=c.getTime();a=(new Date(c+6E4*e)).getTime()}else a=(new Date).getTime();c=new Date;c.setTime(a);return""==f||null==f?a:b(c,f)};SB4API.functions.saveToFile=function(f,e,a){f=_.isObject(f)?p.stringify(f):p.parseString(f);_.str.isBlank(a)&&(a="text/plain;charset\x3dutf-8");SB4API._EMBEDDED&&$.notify("saveToFile is not fully supported in authoring preview mode.","warn");saveAs(new Blob([f]),e,{type:a})};SB4API.globalEventListenerMap={};SB4API.fireGlobalEvent=function(f,e){if(SB4API.rootContext){var a=
SB4API.rootContext.get("[frame]");f="evt://"+f;var c={broadcast:!1};c["[evtval]"]=e;c["[evt_ext_lesson]"]=!0;for(e=0;e<a.engine.subEngines.length;e++)a.engine.subEngines[e].addEvent("flow",f,c)}};SB4API.getGlobalVariable=function(f){return SB4API.rootContext.get("[frame]").engine.objctx.get("global "+f)};SB4API.setGlobalVariable=function(f,e){return SB4API.rootContext.get("[frame]").engine.objctx.add("global "+f,e)};SB4API.addGlobalEventListener=function(f,e){f="flow.evt://"+f;var a=SB4API.globalEventListenerMap[f];
null==a?(a=[],a.push(e),SB4API.globalEventListenerMap[f]=a):a.push(e)};SB4API.removeGlobalEventListener=function(f,e){f="flow.evt://"+f;var a=SB4API.globalEventListenerMap[f];null!=a&&(SB4API.globalEventListenerMap[f]=_.without(a,e))};SB4API.onGlobalEventListener=function(f,e){(f=SB4API.globalEventListenerMap[f])&&$.each(f,function(a,c){_.isFunction(c)&&c(e)})};SB4API.setAudioCapable=function(){if(!1===SB4API.audioCapable){var f=$(".audio-unused");if(0<f.length){var e=$(f[0]);e.removeClass("audio-unused");
e.addClass("audio-used")}else e=$("\x3caudio\x3e\x3c/audio\x3e");e.attr("muted","true");var a=function(c){SB4API.audioCapable=c;e.hasClass("audio-used")?(e.removeClass("audio-used"),e.addClass("audio-unused"),e.removeAttr("muted"),e.attr("src",""),e.attr("id",""),e.appendTo("#media"),e.off(),e.find("*").off()):e.remove()};e.on("ended",function(){a(!0)});e.on("error",function(c){a(!1)});e.appendTo("body");e.attr("src",SB4API.emptyMP3);e[0].play()}};SB4API.capabilities={};SB4API.capabilities.isAudioCapable=
function(){return SB4API.audioCapable};return m});(function(m){var u=document,q=u.createElement("style");q.type="text/css";u.getElementsByTagName("head")[0].appendChild(q);q.styleSheet?q.styleSheet.cssText=m:q.appendChild(u.createTextNode(m))})("div.com_smartbuilder_axon_widget_shape{}div.com_smartbuilder_axon_widget_text_richtext div p{margin-top:0;margin-bottom:0;}div.com_smartbuilder_axon_widget_text_richtext div ul{margin-top:0;margin-bottom:0;list-style-type:disc;}div.com_smartbuilder_axon_widget_text_richtext div ol{margin-top:0;margin-bottom:0;}div.com_smartbuilder_axon_widget_text_richtext div hr{height:0;margin-top:20px;margin-bottom:20px;border:0;border-top:1px solid #000;box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;}div.com_smartbuilder_axon_widget_text_richtext .sb_underline span{text-decoration-line:underline;}div.com_smartbuilder_axon_widget_image{width:auto;height:auto;}div.com_smartbuilder_axon_widget_button{}div.com_smartbuilder_axon_widget_button button{width:100%;height:100%;border:none;background-color:rgba(255,255,255,0);}div.com_smartbuilder_axon_widget_button button:focus{width:100%;height:100%;outline:solid 2px blue;#outline-offset:1px;background-color:rgba(255,255,0,0);}");